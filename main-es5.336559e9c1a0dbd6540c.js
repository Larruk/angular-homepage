function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _construct(e,t,n){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&_setPrototypeOf(i,n.prototype),i}).apply(null,arguments)}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,n){e.exports=n("zUnb")},"6Joi":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r,o=n("mrSG"),a=n("q/0M"),s=n("zVF4"),u=n("x7I3"),c=i.SDK_VERSION,l=new a.Logger("@firebase/firestore"),h=function(e){return e[e.DEBUG=0]="DEBUG",e[e.ERROR=1]="ERROR",e[e.SILENT=2]="SILENT",e}({});function f(){return l.logLevel===a.LogLevel.DEBUG?h.DEBUG:l.logLevel===a.LogLevel.SILENT?h.SILENT:h.ERROR}function d(e){switch(e){case h.DEBUG:l.logLevel=a.LogLevel.DEBUG;break;case h.ERROR:l.logLevel=a.LogLevel.ERROR;break;case h.SILENT:l.logLevel=a.LogLevel.SILENT;break;default:l.error("Firestore ("+c+"): Invalid value passed to `setLogLevel`")}}function p(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(l.logLevel<=a.LogLevel.DEBUG){var i=n.map(v);l.debug.apply(l,o.__spreadArrays(["Firestore ("+c+") ["+e+"]: "+t],i))}}function y(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(l.logLevel<=a.LogLevel.ERROR){var r=t.map(v);l.error.apply(l,o.__spreadArrays(["Firestore ("+c+"): "+e],r))}}function v(e){if("string"==typeof e)return e;var t=_.getPlatform();try{return t.formatJSON(e)}catch(n){return e}}function m(e){var t="FIRESTORE ("+c+") INTERNAL ASSERTION FAILED: "+e;throw y(t),new Error(t)}function g(e,t){e||m(t)}var _=function(){function e(){}return e.setPlatform=function(t){e.platform&&m("Platform already defined"),e.platform=t},e.getPlatform=function(){return e.platform||m("Platform not set"),e.platform},e}();function b(){return _.getPlatform().emptyByteString}var w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},C=function(e){function t(t,n){var r=e.call(this,n)||this;return r.code=t,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return o.__extends(t,e),t}(Error);function k(e,t){function n(){var e="This constructor is private.";throw t&&(e+=" ",e+=t),new C(w.INVALID_ARGUMENT,e)}for(var r in n.prototype=e.prototype,e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}function S(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function E(e,t){return void 0!==e?e:t}function T(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Number(n);isNaN(r)||t(r,e[n])}}function I(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function A(e){for(var t in g(null!=e&&"object"==typeof e,"isEmpty() expects object parameter."),e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function D(e,t){if(0!==t.length)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() does not support arguments, but was called with "+W(t.length,"argument")+".")}function N(e,t,n){if(t.length!==n)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires "+W(n,"argument")+", but was called with "+W(t.length,"argument")+".")}function R(e,t,n){if(t.length<n)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires at least "+W(n,"argument")+", but was called with "+W(t.length,"argument")+".")}function x(e,t,n,r){if(t.length<n||t.length>r)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires between "+n+" and "+r+" arguments, but was called with "+W(t.length,"argument")+".")}function O(e,t,n,r){U(e,t,H(n)+" argument",r)}function P(e,t,n,r){void 0!==r&&O(e,t,n,r)}function M(e,t,n,r){U(e,t,n+" option",r)}function L(e,t,n,r){void 0!==r&&M(e,t,n,r)}function V(e,t,n,r,i){void 0!==r&&function(e,t,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(B(u))}var c=B(r);throw new C(w.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+e+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(e,0,n,r,i)}function F(e,t,n,r){if(!t.some(function(e){return e===r}))throw new C(w.INVALID_ARGUMENT,"Invalid value "+B(r)+" provided to function "+e+"() for its "+H(n)+" argument. Acceptable values: "+t.join(", "))}function U(e,t,n,r){if(!("object"===t?q(r):"non-empty string"===t?"string"==typeof r&&""!==r:typeof r===t)){var i=B(r);throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires its "+n+" to be of type "+t+", but it was: "+i)}}function q(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function B(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?"a custom "+t+" object":"an object"}return"function"==typeof e?"a function":m("Unknown wrong type: "+typeof e)}function j(e,t,n){if(void 0===n)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires a valid "+H(t)+" argument, but it was undefined.")}function z(e,t,n){I(t,function(t,r){if(n.indexOf(t)<0)throw new C(w.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+e+"(). Available options: "+n.join(", "))})}function Q(e,t,n,r){var i=B(r);return new C(w.INVALID_ARGUMENT,"Function "+e+"() requires its "+H(n)+" argument to be a "+t+", but it was: "+i)}function H(e){switch(e){case 1:return"first";case 2:return"second";case 3:return"third";default:return e+"th"}}function W(e,t){return e+" "+t+(1===e?"":"s")}var G=function(){function e(){}return e.newId=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",n=0;n<20;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return g(20===t.length,"Invalid auto ID: "+t),t},e}();function K(e,t){return e<t?-1:e>t?1:0}function Y(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].isEqual(t[n]))return!1;return!0}function Z(e){return e+"\0"}function J(){if("undefined"==typeof Uint8Array)throw new C(w.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function X(){if(!_.getPlatform().base64Available)throw new C(w.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var $=function(){function e(e){X(),this._binaryString=e}return e.fromBase64String=function(t){N("Blob.fromBase64String",arguments,1),O("Blob.fromBase64String","string",1,t),X();try{var n=_.getPlatform().atob(t);return new e(n)}catch(r){throw new C(w.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+r)}},e.fromUint8Array=function(t){if(N("Blob.fromUint8Array",arguments,1),J(),!(t instanceof Uint8Array))throw Q("Blob.fromUint8Array","Uint8Array",1,t);var n=Array.prototype.map.call(t,function(e){return String.fromCharCode(e)}).join("");return new e(n)},e.prototype.toBase64=function(){return N("Blob.toBase64",arguments,0),X(),_.getPlatform().btoa(this._binaryString)},e.prototype.toUint8Array=function(){N("Blob.toUint8Array",arguments,0),J();for(var e=new Uint8Array(this._binaryString.length),t=0;t<this._binaryString.length;t++)e[t]=this._binaryString.charCodeAt(t);return e},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(e){return this._binaryString===e._binaryString},e.prototype._compareTo=function(e){return K(this._binaryString,e._binaryString)},e}(),ee=k($,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),te=function(e,t,n,r,i){this.databaseId=e,this.persistenceKey=t,this.host=n,this.ssl=r,this.forceLongPolling=i},ne="(default)",re=function(){function e(e,t){this.projectId=e,this.database=t||ne}return Object.defineProperty(e.prototype,"isDefaultDatabase",{get:function(){return this.database===ne},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e.prototype.compareTo=function(e){return K(this.projectId,e.projectId)||K(this.database,e.database)},e}(),ie=function(){function e(e,t){var n=this;this.previousValue=e,t&&(t.sequenceNumberHandler=function(e){return n.setPreviousValue(e)},this.writeNewSequenceNumber=function(e){return t.writeSequenceNumber(e)})}return e.prototype.setPreviousValue=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},e.prototype.next=function(){var e=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(e),e},e.INVALID=-1,e}(),oe=function(){function e(e,t,n){void 0===t?t=0:t>e.length&&m("offset "+t+" out of range "+e.length),void 0===n?n=e.length-t:n>e.length-t&&m("length "+n+" out of range "+(e.length-t)),this.segments=e,this.offset=t,this.len=n}return Object.defineProperty(e.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return 0===e.comparator(this,t)},e.prototype.child=function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.popFirst=function(e){return g(this.length>=(e=void 0===e?1:e),"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+e,this.length-e)},e.prototype.popLast=function(){return g(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},e.prototype.firstSegment=function(){return g(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},e.prototype.lastSegment=function(){return this.get(this.length-1)},e.prototype.get=function(e){return g(e<this.length,"Index out of range"),this.segments[this.offset+e]},e.prototype.isEmpty=function(){return 0===this.length},e.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},e.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},e.comparator=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),o=t.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0},e}(),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.prototype.canonicalString=function(){return this.toArray().join("/")},t.prototype.toString=function(){return this.canonicalString()},t.fromString=function(e){if(e.indexOf("//")>=0)throw new C(w.INVALID_ARGUMENT,"Invalid path ("+e+"). Paths must not contain // in them.");return new t(e.split("/").filter(function(e){return e.length>0}))},t.EMPTY_PATH=new t([]),t}(oe),se=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.isValidIdentifier=function(e){return se.test(e)},t.prototype.canonicalString=function(){return this.toArray().map(function(e){return e=e.replace("\\","\\\\").replace("`","\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")},t.prototype.toString=function(){return this.canonicalString()},t.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},t.keyField=function(){return new t(["__name__"])},t.fromServerFormat=function(e){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new C(w.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new C(w.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new C(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new C(w.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)},t.EMPTY_PATH=new t([]),t}(oe),ce=function(){function e(t){this.path=t,g(e.isDocumentKey(t),"Invalid DocumentKey with an odd number of segments: "+t.toArray().join("/"))}return e.prototype.hasCollectionId=function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e},e.prototype.isEqual=function(e){return null!==e&&0===ae.comparator(this.path,e.path)},e.prototype.toString=function(){return this.path.toString()},e.comparator=function(e,t){return ae.comparator(e.path,t.path)},e.isDocumentKey=function(e){return e.length%2==0},e.fromSegments=function(t){return new e(new ae(t.slice()))},e.fromPathString=function(t){return new e(ae.fromString(t))},e.EMPTY=new e(new ae([])),e}(),le=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})},he=function(e){return e.All="all",e.ListenStreamIdle="listen_stream_idle",e.ListenStreamConnectionBackoff="listen_stream_connection_backoff",e.WriteStreamIdle="write_stream_idle",e.WriteStreamConnectionBackoff="write_stream_connection_backoff",e.OnlineStateTimeout="online_state_timeout",e.ClientMetadataRefresh="client_metadata_refresh",e.LruGarbageCollection="lru_garbage_collection",e.RetryTransaction="retry_transaction",e}({}),fe=function(){function e(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new le,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return e.createAndSchedule=function(t,n,r,i,o){var a=new e(t,n,Date.now()+r,i,o);return a.start(r),a},e.prototype.start=function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)},e.prototype.skipDelay=function(){return this.handleDelayElapsed()},e.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new C(w.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},e.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})},e.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},e}(),de=function(){function e(){this.tail=Promise.resolve(),this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.timerIdsToSkip=[]}return Object.defineProperty(e.prototype,"isShuttingDown",{get:function(){return this._isShuttingDown},enumerable:!0,configurable:!0}),e.prototype.enqueueAndForget=function(e){this.enqueue(e)},e.prototype.enqueueAndForgetEvenAfterShutdown=function(e){this.verifyNotFailed(),this.enqueueInternal(e)},e.prototype.enqueueEvenAfterShutdown=function(e){return this.verifyNotFailed(),this.enqueueInternal(e)},e.prototype.enqueueAndInitiateShutdown=function(e){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return this.verifyNotFailed(),this._isShuttingDown?[3,2]:(this._isShuttingDown=!0,[4,this.enqueueEvenAfterShutdown(e)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},e.prototype.enqueue=function(e){return this.verifyNotFailed(),this._isShuttingDown?new Promise(function(e){}):this.enqueueInternal(e)},e.prototype.enqueueInternal=function(e){var t=this,n=this.tail.then(function(){return t.operationInProgress=!0,e().catch(function(e){t.failure=e,t.operationInProgress=!1;var n=e.stack||e.message||"";throw y("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw e},0),e}).then(function(e){return t.operationInProgress=!1,e})});return this.tail=n,n},e.prototype.enqueueAfterDelay=function(e,t,n){var r=this;this.verifyNotFailed(),g(t>=0,"Attempted to schedule an operation with a negative delay of "+t),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);var i=fe.createAndSchedule(this,e,t,n,function(e){return r.removeDelayedOperation(e)});return this.delayedOperations.push(i),i},e.prototype.verifyNotFailed=function(){this.failure&&m("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},e.prototype.verifyOperationInProgress=function(){g(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},e.prototype.drain=function(){return this.enqueueEvenAfterShutdown(function(){return Promise.resolve()})},e.prototype.containsDelayedOperation=function(e){for(var t=0,n=this.delayedOperations;t<n.length;t++)if(n[t].timerId===e)return!0;return!1},e.prototype.runDelayedOperationsEarly=function(e){var t=this;return this.drain().then(function(){g(e===he.All||t.containsDelayedOperation(e),"Attempted to drain to missing operation "+e),t.delayedOperations.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});for(var n=0,r=t.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),e!==he.All&&i.timerId===e)break}return t.drain()})},e.prototype.skipDelaysForTimerId=function(e){this.timerIdsToSkip.push(e)},e.prototype.removeDelayedOperation=function(e){var t=this.delayedOperations.indexOf(e);g(t>=0,"Delayed operation not found."),this.delayedOperations.splice(t,1)},e}(),pe="\x01",ye="\x01",ve="\x10",me="\x11";function ge(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=be(t)),t=_e(e.get(n),t);return be(t)}function _e(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+=pe+ve;break;case pe:n+=pe+me;break;default:n+=o}}return n}function be(e){return e+pe+ye}function we(e){var t=e.length;if(g(t>=2,"Invalid path "+e),2===t)return g(e.charAt(0)===pe&&e.charAt(1)===ye,"Non-empty path "+e+" had length 2"),ae.EMPTY_PATH;for(var n=t-2,r=[],i="",o=0;o<t;){var a=e.indexOf(pe,o);switch((a<0||a>n)&&m('Invalid encoded resource path: "'+e+'"'),e.charAt(a+1)){case ye:var s=e.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case ve:i+=e.substring(o,a),i+="\0";break;case me:i+=e.substring(o,a+1);break;default:m('Invalid encoded resource path: "'+e+'"')}o=a+2}return new ae(r)}var Ce=function(){function e(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new C(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new C(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new C(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new C(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var n=Math.floor(t/1e3);return new e(n,1e6*(t-1e3*n))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype._compareTo=function(e){return this.seconds===e.seconds?K(this.nanoseconds,e.nanoseconds):K(this.seconds,e.seconds)},e.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e}(),ke=function(){function e(e){this.timestamp=e}return e.fromMicroseconds=function(t){var n=Math.floor(t/1e6);return new e(new Ce(n,t%1e6*1e3))},e.fromTimestamp=function(t){return new e(t)},e.forDeletedDoc=function(){return e.MIN},e.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},e.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},e.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.toTimestamp=function(){return this.timestamp},e.MIN=new e(new Ce(0,0)),e}(),Se=function(){function e(e,t){this.comparator=e,this.root=t||Te.EMPTY}return e.prototype.insert=function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Te.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Te.BLACK,null,null))},e.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null},e.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1},e.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),e.prototype.minKey=function(){return this.root.minKey()},e.prototype.maxKey=function(){return this.root.maxKey()},e.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},e.prototype.forEach=function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})},e.prototype.toString=function(){var e=[];return this.inorderTraversal(function(t,n){return e.push(t+":"+n),!1}),"{"+e.join(", ")+"}"},e.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},e.prototype.getIterator=function(){return new Ee(this.root,null,this.comparator,!1)},e.prototype.getIteratorFrom=function(e){return new Ee(this.root,e,this.comparator,!1)},e.prototype.getReverseIterator=function(){return new Ee(this.root,null,this.comparator,!0)},e.prototype.getReverseIteratorFrom=function(e){return new Ee(this.root,e,this.comparator,!0)},e}(),Ee=function(){function e(e,t,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return e.prototype.getNext=function(){g(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},e.prototype.hasNext=function(){return this.nodeStack.length>0},e.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},e}(),Te=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=o?o:e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},e.prototype.minKey=function(){return this.min().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()},e.prototype.removeMin=function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()},e.prototype.remove=function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()},e.prototype.isRed=function(){return this.color},e.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},e.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},e.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},e.prototype.rotateLeft=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},e.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw m("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw m("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check();if(e!==this.right.check())throw m("Black depths differ");return e+(this.isRed()?0:1)},e.EMPTY=null,e.RED=!0,e.BLACK=!1,e}(),Ie=function(){function e(){this.size=0}return Object.defineProperty(e.prototype,"key",{get:function(){throw m("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw m("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){throw m("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){throw m("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){throw m("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new Te(e,t)},e.prototype.remove=function(e,t){return this},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.isRed=function(){return!1},e.prototype.checkMaxDepth=function(){return!0},e.prototype.check=function(){return 0},e}();Te.EMPTY=new Ie;var Ae=function(){function e(e){this.comparator=e,this.data=new Se(this.comparator)}return e.fromMapKeys=function(t){var n=new e(t.comparator);return t.forEach(function(e){n=n.add(e)}),n},e.prototype.has=function(e){return null!==this.data.get(e)},e.prototype.first=function(){return this.data.minKey()},e.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),e.prototype.indexOf=function(e){return this.data.indexOf(e)},e.prototype.forEach=function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})},e.prototype.forEachInRange=function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}},e.prototype.forEachWhile=function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return},e.prototype.firstAfterOrEqual=function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null},e.prototype.getIterator=function(){return new De(this.data.getIterator())},e.prototype.getIteratorFrom=function(e){return new De(this.data.getIteratorFrom(e))},e.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},e.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},e.prototype.isEmpty=function(){return this.data.isEmpty()},e.prototype.unionWith=function(e){var t=this;return e.forEach(function(e){t=t.add(e)}),t},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},e.prototype.toArray=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},e.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},e.prototype.copy=function(t){var n=new e(this.comparator);return n.data=t,n},e}(),De=function(){function e(e){this.iter=e}return e.prototype.getNext=function(){return this.iter.getNext().key},e.prototype.hasNext=function(){return this.iter.hasNext()},e}(),Ne=new Se(ce.comparator);function Re(){return Ne}function xe(){return Re()}var Oe=new Se(ce.comparator);function Pe(){return Oe}var Me=new Se(ce.comparator);function Le(){return Me}var Ve=new Ae(ce.comparator);function Fe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=Ve,r=0,i=e;r<i.length;r++)n=n.add(i[r]);return n}var Ue=new Ae(K);function qe(){return Ue}var Be=function(){function e(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r,g(r.length>0,"Cannot create an empty mutation batch")}return e.prototype.applyToRemoteDocument=function(e,t,n){t&&g(t.key.isEqual(e),"applyToRemoteDocument: key "+e+" should match maybeDoc key\n        "+t.key);var r=n.mutationResults;g(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(e)&&(t=o.applyToRemoteDocument(t,r[i]))}return t},e.prototype.applyToLocalView=function(e,t){t&&g(t.key.isEqual(e),"applyToLocalDocument: key "+e+" should match maybeDoc key\n        "+t.key);for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(e)&&(t=s.applyToLocalView(t,t,this.localWriteTime));for(var i=t,o=0,a=this.mutations;o<a.length;o++){var s;(s=a[o]).key.isEqual(e)&&(t=s.applyToLocalView(t,i,this.localWriteTime))}return t},e.prototype.applyToLocalDocumentSet=function(e){var t=this,n=e;return this.mutations.forEach(function(r){var i=t.applyToLocalView(r.key,e.get(r.key));i&&(n=n.insert(r.key,i))}),n},e.prototype.keys=function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},Fe())},e.prototype.isEqual=function(e){return this.batchId===e.batchId&&Y(this.mutations,e.mutations)&&Y(this.baseMutations,e.baseMutations)},e}(),je=function(){function e(e,t,n,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return e.from=function(t,n,r,i){g(t.mutations.length===r.length,"Mutations sent "+t.mutations.length+" must equal results received "+r.length);for(var o=Le(),a=t.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,r[s].version);return new e(t,n,r,i,o)},e}(),ze=function(){function e(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)},function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)})}return e.prototype.catch=function(e){return this.next(void 0,e)},e.prototype.next=function(t,n){var r=this;return this.callbackAttached&&m("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})},e.prototype.toPromise=function(){var e=this;return new Promise(function(t,n){e.next(t,n)})},e.prototype.wrapUserFunction=function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(r){return e.reject(r)}},e.prototype.wrapSuccess=function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)},e.prototype.wrapFailure=function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)},e.resolve=function(t){return new e(function(e,n){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.waitFor=function(t){return new e(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(e){return n(e)})}),o=!0,i===r&&e()})},e.or=function(t){for(var n=e.resolve(!1),r=function(t){n=n.next(function(n){return n?e.resolve(n):t()})},i=0,o=t;i<o.length;i++)r(o[i]);return n},e.forEach=function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)},e}(),Qe=function(){function e(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}return e.forUser=function(t,n,r,i){return g(""!==t.uid,"UserID must not be an empty string."),new e(t.isAuthenticated()?t.uid:"",n,r,i)},e.prototype.checkEmpty=function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ke(e).iterate({index:an.userMutationsIndex,range:n},function(e,n,r){t=!1,r.done()}).next(function(){return t})},e.prototype.acknowledgeBatch=function(e,t,n){return this.getMutationQueueMetadata(e).next(function(t){return t.lastStreamToken=Ge(n),Ze(e).put(t)})},e.prototype.getLastStreamToken=function(e){return this.getMutationQueueMetadata(e).next(function(e){return e.lastStreamToken})},e.prototype.setLastStreamToken=function(e,t){return this.getMutationQueueMetadata(e).next(function(n){return n.lastStreamToken=Ge(t),Ze(e).put(n)})},e.prototype.addMutationBatch=function(e,t,n,r){var i=this,o=Ye(e),a=Ke(e);return a.add({}).next(function(s){g("number"==typeof s,"Auto-generated key is not a number");for(var u=new Be(s,t,n,r),c=i.serializer.toDbMutationBatch(i.userId,u),l=[],h=new Ae(function(e,t){return K(e.canonicalString(),t.canonicalString())}),f=0,d=r;f<d.length;f++){var p=d[f],y=sn.key(i.userId,p.key.path,s);h=h.add(p.key.path.popLast()),l.push(a.put(c)),l.push(o.put(y,sn.PLACEHOLDER))}return h.forEach(function(t){l.push(i.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(function(){i.documentKeysByBatchId[s]=u.keys()}),ze.waitFor(l).next(function(){return u})})},e.prototype.lookupMutationBatch=function(e,t){var n=this;return Ke(e).get(t).next(function(e){return e?(g(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),n.serializer.fromDbMutationBatch(e)):null})},e.prototype.lookupMutationKeys=function(e,t){var n=this;return this.documentKeysByBatchId[t]?ze.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next(function(e){if(e){var r=e.keys();return n.documentKeysByBatchId[t]=r,r}return null})},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ke(e).iterate({index:an.userMutationsIndex,range:i},function(e,t,i){t.userId===n.userId&&(g(t.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(t)),i.done()}).next(function(){return o})},e.prototype.getHighestUnacknowledgedBatchId=function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ke(e).iterate({index:an.userMutationsIndex,range:t,reverse:!0},function(e,t,r){n=t.batchId,r.done()}).next(function(){return n})},e.prototype.getAllMutationBatches=function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ke(e).loadAll(an.userMutationsIndex,n).next(function(e){return e.map(function(e){return t.serializer.fromDbMutationBatch(e)})})},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=sn.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Ye(e).iterate({range:i},function(r,i,a){var s=r[0],u=r[2],c=we(r[1]);if(s===n.userId&&t.path.isEqual(c))return Ke(e).get(u).next(function(e){if(!e)throw m("Dangling document-mutation reference found: "+r+" which points to "+u);g(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+u),o.push(n.serializer.fromDbMutationBatch(e))});a.done()}).next(function(){return o})},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new Ae(K),i=[];return t.forEach(function(t){var o=sn.prefixForPath(n.userId,t.path),a=IDBKeyRange.lowerBound(o),s=Ye(e).iterate({range:a},function(e,i,o){var a=e[0],s=e[2],u=we(e[1]);a===n.userId&&t.path.isEqual(u)?r=r.add(s):o.done()});i.push(s)}),ze.waitFor(i).next(function(){return n.lookupMutationBatches(e,r)})},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=this;g(!t.isDocumentQuery(),"Document queries shouldn't go down this path"),g(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=t.path,i=r.length+1,o=sn.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Ae(K);return Ye(e).iterate({range:a},function(e,t,o){var a=e[0],u=e[2],c=we(e[1]);a===n.userId&&r.isPrefixOf(c)?c.length===i&&(s=s.add(u)):o.done()}).next(function(){return n.lookupMutationBatches(e,s)})},e.prototype.lookupMutationBatches=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Ke(e).get(t).next(function(e){if(null===e)throw m("Dangling document-mutation reference found, which points to "+t);g(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),r.push(n.serializer.fromDbMutationBatch(e))}))}),ze.waitFor(i).next(function(){return r})},e.prototype.removeMutationBatch=function(e,t){var n=this;return We(e.simpleDbTransaction,this.userId,t).next(function(r){return e.addOnCommittedListener(function(){n.removeCachedMutationKeys(t.batchId)}),ze.forEach(r,function(t){return n.referenceDelegate.removeMutationReference(e,t)})})},e.prototype.removeCachedMutationKeys=function(e){delete this.documentKeysByBatchId[e]},e.prototype.performConsistencyCheck=function(e){var t=this;return this.checkEmpty(e).next(function(n){if(!n)return ze.resolve();var r=IDBKeyRange.lowerBound(sn.prefixForUser(t.userId)),i=[];return Ye(e).iterate({range:r},function(e,n,r){if(e[0]===t.userId){var o=we(e[1]);i.push(o)}else r.done()}).next(function(){g(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(e){return e.canonicalString()}))})})},e.prototype.containsKey=function(e,t){return He(e,this.userId,t)},e.prototype.getMutationQueueMetadata=function(e){var t=this;return Ze(e).get(this.userId).next(function(e){return e||new on(t.userId,-1,"")})},e}();function He(e,t,n){var r=sn.prefixForPath(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return Ye(e).iterate({range:o,keysOnly:!0},function(e,n,r){e[0]===t&&e[1]===i&&(a=!0),r.done()}).next(function(){return a})}function We(e,t,n){var r=e.store(an.store),i=e.store(sn.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},function(e,t,n){return s++,n.delete()});o.push(u.next(function(){g(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=sn.key(t,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return ze.waitFor(o).next(function(){return c})}function Ge(e){return e instanceof Uint8Array?(g("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence."),e.toString()):e}function Ke(e){return Vn.getStore(e,an.store)}function Ye(e){return Vn.getStore(e,sn.store)}function Ze(e){return Vn.getStore(e,on.store)}var Je=1,Xe=function(e){return e[e.QueryCache=0]="QueryCache",e[e.SyncEngine=1]="SyncEngine",e}({}),$e=function(){function e(e,t){this.generatorId=e,g((e&Je)===e,"Generator ID "+e+" contains more than "+Je+" reserved bits"),this.seek(void 0!==t?t:this.generatorId)}return e.prototype.next=function(){var e=this.nextId;return this.nextId+=1<<Je,e},e.prototype.after=function(e){return this.seek(e+(1<<Je)),this.next()},e.prototype.seek=function(e){g((e&Je)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=e},e.forQueryCache=function(){return new e(Xe.QueryCache,2)},e.forSyncEngine=function(){return new e(Xe.SyncEngine)},e}(),et="SimpleDb",tt=function(){function e(t){this.db=t,12.2===e.getIOSVersion(s.getUA())&&y("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.openOrCreate=function(t,n,r){return g(e.isAvailable(),"IndexedDB not supported in current environment."),p(et,"Opening database:",t),new ze(function(i,o){var a=window.indexedDB.open(t,n);a.onsuccess=function(t){i(new e(t.target.result))},a.onblocked=function(){o(new C(w.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(e){var t=e.target.error;o("VersionError"===t.name?new C(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):t)},a.onupgradeneeded=function(e){p(et,'Database "'+t+'" requires upgrade from version:',e.oldVersion),r.createOrUpgrade(e.target.result,a.transaction,e.oldVersion,en).next(function(){p(et,"Database upgrade to version "+en+" complete")})}}).toPromise()},e.delete=function(e){return p(et,"Removing database:",e),ot(window.indexedDB.deleteDatabase(e)).toPromise()},e.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return"YES"===process.env.USE_MOCK_PERSISTENCE;var t=s.getUA(),n=e.getIOSVersion(t),r=0<n&&n<10,i=e.getAndroidVersion(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.getStore=function(e,t){return e.store(t)},e.getIOSVersion=function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.getAndroidVersion=function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.setVersionChangeListener=function(e){this.db.onversionchange=function(t){return e(t)}},e.prototype.runTransaction=function(e,t,n){return o.__awaiter(this,void 0,void 0,function(){var r,i,a,s,u,c;return o.__generator(this,function(l){switch(l.label){case 0:r=e.startsWith("readonly"),i=e.endsWith("idempotent"),a=0,s=function(){var e,s,c,l;return o.__generator(this,function(o){switch(o.label){case 0:++a,e=rt.open(u.db,r?"readonly":"readwrite",t),o.label=1;case 1:return o.trys.push([1,3,,4]),(s=n(e).catch(function(t){return e.abort(t),ze.reject(t)}).toPromise()).catch(function(){}),[4,e.completionPromise];case 2:return o.sent(),[2,{value:s}];case 3:return c=o.sent(),l=i&&("undefined"!=typeof DOMException&&c instanceof DOMException||"DOMException"===c.constructor.name)&&a<3,p("Transaction failed with error: %s. Retrying: %s.",c.message,l),l?[3,4]:[2,{value:Promise.reject(c)}];case 4:return[2]}})},u=this,l.label=1;case 1:return[5,s()];case 2:return"object"==typeof(c=l.sent())?[2,c.value]:[3,1];case 3:return[2]}})})},e.prototype.close=function(){this.db.close()},e}(),nt=function(){function e(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(e.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(e){this.dbCursor=e},enumerable:!0,configurable:!0}),e.prototype.done=function(){this.shouldStop=!0},e.prototype.skip=function(e){this.nextKey=e},e.prototype.delete=function(){return ot(this.dbCursor.delete())},e}(),rt=function(){function e(e){var t=this;this.transaction=e,this.aborted=!1,this.completionDeferred=new le,this.transaction.oncomplete=function(){t.completionDeferred.resolve()},this.transaction.onabort=function(){e.error?t.completionDeferred.reject(e.error):t.completionDeferred.resolve()},this.transaction.onerror=function(e){var n=st(e.target.error);t.completionDeferred.reject(n)}}return e.open=function(t,n,r){return new e(t.transaction(r,n))},Object.defineProperty(e.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),e.prototype.abort=function(e){e&&this.completionDeferred.reject(e),this.aborted||(p(et,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(e){var t=this.transaction.objectStore(e);return g(!!t,"Object store not part of transaction: "+e),new it(t)},e}(),it=function(){function e(e){this.store=e}return e.prototype.put=function(e,t){var n;return void 0!==t?(p(et,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(p(et,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),ot(n)},e.prototype.add=function(e){return p(et,"ADD",this.store.name,e,e),ot(this.store.add(e))},e.prototype.get=function(e){var t=this;return ot(this.store.get(e)).next(function(n){return void 0===n&&(n=null),p(et,"GET",t.store.name,e,n),n})},e.prototype.delete=function(e){return p(et,"DELETE",this.store.name,e),ot(this.store.delete(e))},e.prototype.count=function(){return p(et,"COUNT",this.store.name),ot(this.store.count())},e.prototype.loadAll=function(e,t){var n=this.cursor(this.options(e,t)),r=[];return this.iterateCursor(n,function(e,t){r.push(t)}).next(function(){return r})},e.prototype.deleteAll=function(e,t){p(et,"DELETE ALL",this.store.name);var n=this.options(e,t);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(e,t,n){return n.delete()})},e.prototype.iterate=function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.iterateCursor(r,t)},e.prototype.iterateSerial=function(e){var t=this.cursor({});return new ze(function(n,r){t.onerror=function(e){var t=st(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next(function(e){e?r.continue():n()}):n()}})},e.prototype.iterateCursor=function(e,t){var n=[];return new ze(function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var o=new nt(i),a=t(i.primaryKey,i.value,o);if(a instanceof ze){var s=a.catch(function(e){return o.done(),ze.reject(e)});n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}}).next(function(){return ze.waitFor(n)})},e.prototype.options=function(e,t){var n=void 0;return void 0!==e&&("string"==typeof e?n=e:(g(void 0===t,"3rd argument must not be defined if 2nd is a range."),t=e)),{index:n,range:t}},e.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.keysOnly?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},e}();function ot(e){return new ze(function(t,n){e.onsuccess=function(e){t(e.target.result)},e.onerror=function(e){var t=st(e.target.error);n(t)}})}var at=!1;function st(e){var t=tt.getIOSVersion(s.getUA());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new C("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return at||(at=!0,setTimeout(function(){throw r},0)),r}}return e}var ut=function(){function e(e,t){this.referenceDelegate=e,this.serializer=t,this.targetIdGenerator=$e.forQueryCache()}return e.prototype.allocateTargetId=function(e){var t=this;return this.retrieveMetadata(e).next(function(n){return n.highestTargetId=t.targetIdGenerator.after(n.highestTargetId),t.saveMetadata(e,n).next(function(){return n.highestTargetId})})},e.prototype.getLastRemoteSnapshotVersion=function(e){return this.retrieveMetadata(e).next(function(e){return ke.fromTimestamp(new Ce(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))})},e.prototype.getHighestSequenceNumber=function(e){return ht(e.simpleDbTransaction)},e.prototype.setTargetsMetadata=function(e,t,n){var r=this;return this.retrieveMetadata(e).next(function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.saveMetadata(e,i)})},e.prototype.addQueryData=function(e,t){var n=this;return this.saveQueryData(e,t).next(function(){return n.retrieveMetadata(e).next(function(r){return r.targetCount+=1,n.updateMetadataFromQueryData(t,r),n.saveMetadata(e,r)})})},e.prototype.updateQueryData=function(e,t){return this.saveQueryData(e,t)},e.prototype.removeQueryData=function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next(function(){return ct(e).delete(t.targetId)}).next(function(){return n.retrieveMetadata(e)}).next(function(t){return g(t.targetCount>0,"Removing from an empty query cache"),t.targetCount-=1,n.saveMetadata(e,t)})},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return ct(e).iterate(function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=t&&null===n.get(u.targetId)&&(i++,o.push(r.removeQueryData(e,u)))}).next(function(){return ze.waitFor(o)}).next(function(){return i})},e.prototype.forEachTarget=function(e,t){var n=this;return ct(e).iterate(function(e,r){var i=n.serializer.fromDbTarget(r);t(i)})},e.prototype.retrieveMetadata=function(e){return lt(e.simpleDbTransaction)},e.prototype.saveMetadata=function(e,t){return(n=e,Vn.getStore(n,pn.store)).put(pn.key,t);var n},e.prototype.saveQueryData=function(e,t){return ct(e).put(this.serializer.toDbTarget(t))},e.prototype.updateMetadataFromQueryData=function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n},e.prototype.getQueryCount=function(e){return this.retrieveMetadata(e).next(function(e){return e.targetCount})},e.prototype.getQueryData=function(e,t){var n=this,r=t.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return ct(e).iterate({range:i,index:fn.queryTargetsIndexName},function(e,r,i){var a=n.serializer.fromDbTarget(r);t.isEqual(a.query)&&(o=a,i.done())}).next(function(){return o})},e.prototype.addMatchingKeys=function(e,t,n){var r=this,i=[],o=ft(e);return t.forEach(function(t){var a=ge(t.path);i.push(o.put(new dn(n,a))),i.push(r.referenceDelegate.addReference(e,t))}),ze.waitFor(i)},e.prototype.removeMatchingKeys=function(e,t,n){var r=this,i=ft(e);return ze.forEach(t,function(t){var o=ge(t.path);return ze.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(e,t)])})},e.prototype.removeMatchingKeysForTargetId=function(e,t){var n=ft(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=ft(e),i=Fe();return r.iterate({range:n,keysOnly:!0},function(e,t,n){var r=we(e[1]),o=new ce(r);i=i.add(o)}).next(function(){return i})},e.prototype.containsKey=function(e,t){var n=ge(t.path),r=IDBKeyRange.bound([n],[Z(n)],!1,!0),i=0;return ft(e).iterate({index:dn.documentTargetsIndex,keysOnly:!0,range:r},function(e,t,n){0!==e[0]&&(i++,n.done())}).next(function(){return i>0})},e.prototype.getQueryDataForTarget=function(e,t){var n=this;return ct(e).get(t).next(function(e){return e?n.serializer.fromDbTarget(e):null})},e}();function ct(e){return Vn.getStore(e,fn.store)}function lt(e){return tt.getStore(e,pn.store).get(pn.key).next(function(e){return g(null!==e,"Missing metadata row."),e})}function ht(e){return lt(e).next(function(e){return e.highestListenSequenceNumber})}function ft(e){return Vn.getStore(e,dn.store)}var dt=function(){function e(e){this.fields=e}return e.fromSet=function(t){return new e(t)},e.fromArray=function(t){var n=new Ae(ue.comparator);return t.forEach(function(e){return n=n.add(e)}),new e(n)},e.prototype.covers=function(e){var t=!1;return this.fields.forEach(function(n){n.isPrefixOf(e)&&(t=!0)}),t},e.prototype.isEqual=function(e){return this.fields.isEqual(e.fields)},e}(),pt=function(){function e(e,t){this.field=e,this.transform=t}return e.prototype.isEqual=function(e){return this.field.isEqual(e.field)&&this.transform.isEqual(e.transform)},e}(),yt=function(e,t){this.version=e,this.transformResults=t},vt=function(e){return e[e.Set=0]="Set",e[e.Patch=1]="Patch",e[e.Transform=2]="Transform",e[e.Delete=3]="Delete",e}({}),mt=function(){function e(e,t){this.updateTime=e,this.exists=t,g(void 0===e||void 0===t,'Precondition can specify "exists" or "updateTime" but not both')}return e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),e.prototype.isValidFor=function(e){return void 0!==this.updateTime?e instanceof jt&&e.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===e instanceof jt:(g(this.isNone,"Precondition should be empty"),!0)},e.prototype.isEqual=function(e){return n=e.updateTime,(null!=(t=this.updateTime)?!(!n||!t.isEqual(n)):t===n)&&this.exists===e.exists;var t,n},e.NONE=new e,e}(),gt=function(){function e(){}return e.prototype.verifyKeyMatches=function(e){null!=e&&g(e.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},e.getPostMutationVersion=function(e){return e instanceof jt?e.version:ke.MIN},e}(),_t=function(e){function t(t,n,r){var i=e.call(this)||this;return i.key=t,i.value=n,i.precondition=r,i.type=vt.Set,i}return o.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){return this.verifyKeyMatches(e),g(null==t.transformResults,"Transform results received by SetMutation."),new jt(this.key,t.version,{hasCommittedMutations:!0},this.value)},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=gt.getPostMutationVersion(e);return new jt(this.key,r,{hasLocalMutations:!0},this.value)},t.prototype.extractBaseValue=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.value.isEqual(e.value)&&this.precondition.isEqual(e.precondition)},t}(gt),bt=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o.key=t,o.data=n,o.fieldMask=r,o.precondition=i,o.type=vt.Patch,o}return o.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),g(null==t.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(e))return new Qt(this.key,t.version);var n=this.patchDocument(e);return new jt(this.key,t.version,{hasCommittedMutations:!0},n)},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=gt.getPostMutationVersion(e),i=this.patchDocument(e);return new jt(this.key,r,{hasLocalMutations:!0},i)},t.prototype.extractBaseValue=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.fieldMask.isEqual(e.fieldMask)&&this.precondition.isEqual(e.precondition)},t.prototype.patchDocument=function(e){var t;return t=e instanceof jt?e.data():Ut.EMPTY,this.patchObject(t)},t.prototype.patchObject=function(e){var t=this;return this.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=t.data.field(n);e=null!==r?e.set(n,r):e.delete(n)}}),e},t}(gt),wt=function(e){function t(t,n){var r=e.call(this)||this;return r.key=t,r.fieldTransforms=n,r.type=vt.Transform,r.precondition=mt.exists(!0),r}return o.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),g(null!=t.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(e))return new Qt(this.key,t.version);var n=this.requireDocument(e),r=this.serverTransformResults(e,t.transformResults),i=t.version,o=this.transformObject(n.data(),r);return new jt(this.key,i,{hasCommittedMutations:!0},o)},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=this.requireDocument(e),i=this.localTransformResults(n,e,t),o=this.transformObject(r.data(),i);return new jt(this.key,r.version,{hasLocalMutations:!0},o)},t.prototype.extractBaseValue=function(e){for(var t=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=e instanceof jt?e.field(i.field):void 0,a=i.transform.computeBaseValue(o||null);null!=a&&(t=null==t?Ut.EMPTY.set(i.field,a):t.set(i.field,a))}return t},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&Y(this.fieldTransforms,e.fieldTransforms)&&this.precondition.isEqual(e.precondition)},t.prototype.requireDocument=function(e){g(e instanceof jt,"Unknown MaybeDocument type "+e);var t=e;return g(t.key.isEqual(this.key),"Can only transform a document with the same key"),t},t.prototype.serverTransformResults=function(e,t){var n=[];g(this.fieldTransforms.length===t.length,"server transform result count ("+t.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<t.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;e instanceof jt&&(a=e.field(i.field)),n.push(o.applyToRemoteDocument(a,t[r]))}return n},t.prototype.localTransformResults=function(e,t,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var a=o[i],s=a.transform,u=null;t instanceof jt&&(u=t.field(a.field)),null===u&&n instanceof jt&&(u=n.field(a.field)),r.push(s.applyToLocalView(u,e))}return r},t.prototype.transformObject=function(e,t){g(t.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++)e=e.set(this.fieldTransforms[n].field,t[n]);return e},t}(gt),Ct=function(e){function t(t,n){var r=e.call(this)||this;return r.key=t,r.precondition=n,r.type=vt.Delete,r}return o.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){return this.verifyKeyMatches(e),g(null==t.transformResults,"Transform results received by DeleteMutation."),new zt(this.key,t.version,{hasCommittedMutations:!0})},t.prototype.applyToLocalView=function(e,t,n){return this.verifyKeyMatches(e),this.precondition.isValidFor(e)?(e&&g(e.key.isEqual(this.key),"Can only apply mutation to document with same key"),new zt(this.key,ke.forDeletedDoc())):e},t.prototype.extractBaseValue=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.precondition.isEqual(e.precondition)},t}(gt),kt=function(e){return e[e.NullValue=0]="NullValue",e[e.BooleanValue=1]="BooleanValue",e[e.NumberValue=2]="NumberValue",e[e.TimestampValue=3]="TimestampValue",e[e.StringValue=4]="StringValue",e[e.BlobValue=5]="BlobValue",e[e.RefValue=6]="RefValue",e[e.GeoPointValue=7]="GeoPointValue",e[e.ArrayValue=8]="ArrayValue",e[e.ObjectValue=9]="ObjectValue",e}({}),St=function(e){return e[e.Default=0]="Default",e[e.Estimate=1]="Estimate",e[e.Previous=2]="Previous",e}({}),Et=function(){function e(e,t){this.serverTimestampBehavior=e,this.timestampsInSnapshots=t}return e.fromSnapshotOptions=function(t,n){switch(t.serverTimestamps){case"estimate":return new e(St.Estimate,n);case"previous":return new e(St.Previous,n);case"none":case void 0:return new e(St.Default,n);default:return m("fromSnapshotOptions() called with invalid options.")}},e}(),Tt=function(){function e(){}return e.prototype.toString=function(){var e=this.value();return null===e?"null":e.toString()},e.prototype.defaultCompareTo=function(e){return g(this.typeOrder!==e.typeOrder,"Default compareTo should not be used for values of same type."),K(this.typeOrder,e.typeOrder)},e}(),It=function(e){function t(){var t=e.call(this)||this;return t.typeOrder=kt.NullValue,t.internalValue=null,t}return o.__extends(t,e),t.prototype.value=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t},t.prototype.compareTo=function(e){return e instanceof t?0:this.defaultCompareTo(e)},t.INSTANCE=new t,t}(Tt),At=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=kt.BooleanValue,n}return o.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue===e.internalValue},t.prototype.compareTo=function(e){return e instanceof t?K(this,e):this.defaultCompareTo(e)},t.of=function(e){return e?t.TRUE:t.FALSE},t.TRUE=new t(!0),t.FALSE=new t(!1),t}(Tt),Dt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=kt.NumberValue,n}return o.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.compareTo=function(e){return e instanceof t?(n=this.internalValue)<(r=e.internalValue)?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1:this.defaultCompareTo(e);var n,r},t}(Tt);function Nt(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var Rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.isEqual=function(e){return e instanceof t&&Nt(this.internalValue,e.internalValue)},t}(Dt),xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.isEqual=function(e){return e instanceof t&&Nt(this.internalValue,e.internalValue)},t.NAN=new t(NaN),t.POSITIVE_INFINITY=new t(1/0),t.NEGATIVE_INFINITY=new t(-1/0),t}(Dt),Ot=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=kt.StringValue,n}return o.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue===e.internalValue},t.prototype.compareTo=function(e){return e instanceof t?K(this.internalValue,e.internalValue):this.defaultCompareTo(e)},t}(Tt),Pt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=kt.TimestampValue,n}return o.__extends(t,e),t.prototype.value=function(e){return!e||e.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):e instanceof Mt?-1:this.defaultCompareTo(e)},t}(Tt),Mt=function(e){function t(t,n){var r=e.call(this)||this;return r.localWriteTime=t,r.previousValue=n,r.typeOrder=kt.TimestampValue,r}return o.__extends(t,e),t.prototype.value=function(e){return e&&e.serverTimestampBehavior===St.Estimate?new Pt(this.localWriteTime).value(e):e&&e.serverTimestampBehavior===St.Previous&&this.previousValue?this.previousValue.value(e):null},t.prototype.isEqual=function(e){return e instanceof t&&this.localWriteTime.isEqual(e.localWriteTime)},t.prototype.compareTo=function(e){return e instanceof t?this.localWriteTime._compareTo(e.localWriteTime):e instanceof Pt?1:this.defaultCompareTo(e)},t.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},t}(Tt),Lt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=kt.BlobValue,n}return o.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},t}(Tt),Vt=function(e){function t(t,n){var r=e.call(this)||this;return r.databaseId=t,r.key=n,r.typeOrder=kt.RefValue,r}return o.__extends(t,e),t.prototype.value=function(e){return this.key},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.databaseId.isEqual(e.databaseId)},t.prototype.compareTo=function(e){if(e instanceof t){var n=this.databaseId.compareTo(e.databaseId);return 0!==n?n:ce.comparator(this.key,e.key)}return this.defaultCompareTo(e)},t}(Tt),Ft=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=kt.GeoPointValue,n}return o.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},t}(Tt),Ut=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=kt.ObjectValue,n}return o.__extends(t,e),t.prototype.value=function(e){var t={};return this.internalValue.inorderTraversal(function(n,r){t[n]=r.value(e)}),t},t.prototype.forEach=function(e){this.internalValue.inorderTraversal(e)},t.prototype.isEqual=function(e){if(e instanceof t){for(var n=this.internalValue.getIterator(),r=e.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},t.prototype.compareTo=function(e){if(e instanceof t){for(var n=this.internalValue.getIterator(),r=e.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=K(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return K(n.hasNext(),r.hasNext())}return this.defaultCompareTo(e)},t.prototype.set=function(e,n){if(g(!e.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===e.length)return this.setChild(e.firstSegment(),n);var r=this.child(e.firstSegment());r instanceof t||(r=t.EMPTY);var i=r.set(e.popFirst(),n);return this.setChild(e.firstSegment(),i)},t.prototype.delete=function(e){if(g(!e.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===e.length)return new t(this.internalValue.remove(e.firstSegment()));var n=this.child(e.firstSegment());if(n instanceof t){var r=n.delete(e.popFirst());return new t(this.internalValue.insert(e.firstSegment(),r))}return this},t.prototype.contains=function(e){return null!==this.field(e)},t.prototype.field=function(e){g(!e.isEmpty(),"Can't get field of empty path");var n=this;return e.forEach(function(e){n=n instanceof t?n.internalValue.get(e):null}),n},t.prototype.fieldMask=function(){var e=new Ae(ue.comparator);return this.internalValue.forEach(function(n,r){var i=new ue([n]);if(r instanceof t){var o=r.fieldMask().fields;o.isEmpty()?e=e.add(i):o.forEach(function(t){e=e.add(i.child(t))})}else e=e.add(i)}),dt.fromSet(e)},t.prototype.toString=function(){return this.internalValue.toString()},t.prototype.child=function(e){return this.internalValue.get(e)||void 0},t.prototype.setChild=function(e,n){return new t(this.internalValue.insert(e,n))},t.EMPTY=new t(new Se(K)),t}(Tt),qt=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=kt.ArrayValue,n}return o.__extends(t,e),t.prototype.value=function(e){return this.internalValue.map(function(t){return t.value(e)})},t.prototype.contains=function(e){for(var t=0,n=this.internalValue;t<n.length;t++)if(n[t].isEqual(e))return!0;return!1},t.prototype.forEach=function(e){this.internalValue.forEach(e)},t.prototype.isEqual=function(e){if(e instanceof t){if(this.internalValue.length!==e.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(e.internalValue[n]))return!1;return!0}return!1},t.prototype.compareTo=function(e){if(e instanceof t){for(var n=Math.min(this.internalValue.length,e.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(e.internalValue[r]);if(i)return i}return K(this.internalValue.length,e.internalValue.length)}return this.defaultCompareTo(e)},t.prototype.toString=function(){return"["+this.internalValue.map(function(e){return e.toString()}).join(",")+"]"},t}(Tt),Bt=function(){function e(e,t){this.key=e,this.version=t}return e.compareByKey=function(e,t){return ce.comparator(e.key,t.key)},e}(),jt=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n)||this;return s.objectValue=i,s.proto=o,s.converter=a,g(void 0!==s.objectValue||void 0!==s.proto&&void 0!==s.converter,"If objectValue is not defined, proto and converter need to be set."),s.hasLocalMutations=!!r.hasLocalMutations,s.hasCommittedMutations=!!r.hasCommittedMutations,s}return o.__extends(t,e),t.prototype.field=function(e){if(this.objectValue)return this.objectValue.field(e);this.fieldValueCache||(this.fieldValueCache=new Map);var t=e.canonicalString(),n=this.fieldValueCache.get(t);if(void 0===n){var r=this.getProtoField(e);n=void 0===r?null:this.converter(r),this.fieldValueCache.set(t,n)}return n},t.prototype.data=function(){var e=this;if(!this.objectValue){var t=Ut.EMPTY;I(this.proto.fields||{},function(n,r){t=t.set(new ue([n]),e.converter(r))}),this.objectValue=t,this.fieldValueCache=void 0}return this.objectValue},t.prototype.value=function(){return this.data().value()},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.hasLocalMutations===e.hasLocalMutations&&this.hasCommittedMutations===e.hasCommittedMutations&&this.data().isEqual(e.data())},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),t.prototype.getProtoField=function(e){g(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var t=this.proto.fields?this.proto.fields[e.firstSegment()]:void 0,n=1;n<e.length;++n){if(!t||!t.mapValue||!t.mapValue.fields)return;t=t.mapValue.fields[e.get(n)]}return t},t.compareByField=function(e,t,n){var r=t.field(e),i=n.field(e);return null!==r&&null!==i?r.compareTo(i):m("Trying to compare documents on fields that don't exist")},t}(Bt),zt=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return o.__extends(t,e),t.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.hasCommittedMutations===this.hasCommittedMutations&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},t}(Bt),Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},t}(Bt),Ht=function(){function e(e){this.mapKeyFn=e,this.inner={}}return e.prototype.get=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[1];if(o[0].isEqual(e))return a}},e.prototype.has=function(e){return void 0!==this.get(e)},e.prototype.set=function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]},e.prototype.delete=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1},e.prototype.forEach=function(e){I(this.inner,function(t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];e(o[0],o[1])}})},e.prototype.isEmpty=function(){return A(this.inner)},e}(),Wt=function(){function e(){this.changes=new Ht(function(e){return e.toString()}),this.changesApplied=!1}return Object.defineProperty(e.prototype,"readTime",{get:function(){return g(void 0!==this._readTime,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this._readTime},set:function(e){g(void 0===this._readTime||this._readTime.isEqual(e),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this._readTime=e},enumerable:!0,configurable:!0}),e.prototype.addEntry=function(e,t){this.assertNotApplied(),this.readTime=t,this.changes.set(e.key,e)},e.prototype.removeEntry=function(e,t){this.assertNotApplied(),t&&(this.readTime=t),this.changes.set(e,null)},e.prototype.getEntry=function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?ze.resolve(n):this.getFromCache(e,t)},e.prototype.getEntries=function(e,t){return this.getAllFromCache(e,t)},e.prototype.apply=function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)},e.prototype.assertNotApplied=function(){g(!this.changesApplied,"Changes have already been applied.")},e}(),Gt=function(){function e(e,t){this.serializer=e,this.indexManager=t}return e.prototype.addEntry=function(e,t,n){return Yt(e).put(Zt(t),n)},e.prototype.removeEntry=function(e,t){var n=Yt(e),r=Zt(t);return n.delete(r)},e.prototype.updateMetadata=function(e,t){var n=this;return this.getMetadata(e).next(function(r){return r.byteSize+=t,n.setMetadata(e,r)})},e.prototype.getEntry=function(e,t){var n=this;return Yt(e).get(Zt(t)).next(function(e){return n.maybeDecodeDocument(e)})},e.prototype.getSizedEntry=function(e,t){var n=this;return Yt(e).get(Zt(t)).next(function(e){var t=n.maybeDecodeDocument(e);return t?{maybeDocument:t,size:Jt(e)}:null})},e.prototype.getEntries=function(e,t){var n=this,r=xe();return this.forEachDbEntry(e,t,function(e,t){var i=n.maybeDecodeDocument(t);r=r.insert(e,i)}).next(function(){return r})},e.prototype.getSizedEntries=function(e,t){var n=this,r=xe(),i=new Se(ce.comparator);return this.forEachDbEntry(e,t,function(e,t){var o=n.maybeDecodeDocument(t);o?(r=r.insert(e,o),i=i.insert(e,Jt(t))):(r=r.insert(e,null),i=i.insert(e,0))}).next(function(){return{maybeDocuments:r,sizeMap:i}})},e.prototype.forEachDbEntry=function(e,t,n){if(t.isEmpty())return ze.resolve();var r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator(),o=i.getNext();return Yt(e).iterate({range:r},function(e,t,r){for(var a=ce.fromSegments(e);o&&ce.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,t),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},e.prototype.getDocumentsMatchingQuery=function(e,t,n){var r=this;g(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var i=Pe(),o=t.path.length+1,a={};if(n.isEqual(ke.MIN)){var s=t.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=t.path.toArray(),c=this.serializer.toDbTimestampKey(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=ln.collectionReadTimeIndex}return Yt(e).iterate(a,function(e,n,a){if(e.length===o){var s=r.serializer.fromDbRemoteDocument(n);t.path.isPrefixOf(s.key.path)?s instanceof jt&&t.matches(s)&&(i=i.insert(s.key,s)):a.done()}}).next(function(){return i})},e.prototype.getNewDocumentChanges=function(e,t){var n=this,r=Re(),i=this.serializer.toDbTimestampKey(t),o=Yt(e),a=IDBKeyRange.lowerBound(i,!0);return o.iterate({index:ln.readTimeIndex,range:a},function(e,t){var o=n.serializer.fromDbRemoteDocument(t);r=r.insert(o.key,o),i=t.readTime}).next(function(){return{changedDocs:r,readTime:n.serializer.fromDbTimestampKey(i)}})},e.prototype.getLastDocumentChange=function(e){var t,n=this,r=Yt(e),i=ke.MIN;return r.iterate({index:ln.readTimeIndex,reverse:!0},function(e,r,o){t=n.serializer.fromDbRemoteDocument(r),r.readTime&&(i=n.serializer.fromDbTimestampKey(r.readTime)),o.done()}).next(function(){return{changedDoc:t,readTime:i}})},e.prototype.newChangeBuffer=function(t){return new e.RemoteDocumentChangeBuffer(this,!!t&&t.trackRemovals)},e.prototype.getSize=function(e){return this.getMetadata(e).next(function(e){return e.byteSize})},e.prototype.getMetadata=function(e){return Kt(e).get(hn.key).next(function(e){return g(!!e,"Missing document cache metadata"),e})},e.prototype.setMetadata=function(e,t){return Kt(e).put(hn.key,t)},e.prototype.maybeDecodeDocument=function(e){if(e){var t=this.serializer.fromDbRemoteDocument(e);return t instanceof zt&&t.version.isEqual(ke.forDeletedDoc())?null:t}return null},e.RemoteDocumentChangeBuffer=function(e){function t(t,n){var r=e.call(this)||this;return r.documentCache=t,r.trackRemovals=n,r.documentSizes=new Ht(function(e){return e.toString()}),r}return o.__extends(t,e),t.prototype.applyChanges=function(e){var t=this,n=[],r=0,i=new Ae(function(e,t){return K(e.canonicalString(),t.canonicalString())});return this.changes.forEach(function(o,a){var s=t.documentSizes.get(o);if(g(void 0!==s,"Cannot modify a document that wasn't read (for "+o+")"),a){g(!t.readTime.isEqual(ke.MIN),"Cannot add a document with a read time of zero");var u=t.documentCache.serializer.toDbRemoteDocument(a,t.readTime);i=i.add(o.path.popLast());var c=Jt(u);r+=c-s,n.push(t.documentCache.addEntry(e,o,u))}else if(r-=s,t.trackRemovals){var l=t.documentCache.serializer.toDbRemoteDocument(new zt(o,ke.forDeletedDoc()),t.readTime);n.push(t.documentCache.addEntry(e,o,l))}else n.push(t.documentCache.removeEntry(e,o))}),i.forEach(function(r){n.push(t.documentCache.indexManager.addToCollectionParentIndex(e,r))}),n.push(this.documentCache.updateMetadata(e,r)),ze.waitFor(n)},t.prototype.getFromCache=function(e,t){var n=this;return this.documentCache.getSizedEntry(e,t).next(function(e){return null===e?(n.documentSizes.set(t,0),null):(n.documentSizes.set(t,e.size),e.maybeDocument)})},t.prototype.getAllFromCache=function(e,t){var n=this;return this.documentCache.getSizedEntries(e,t).next(function(e){var t=e.maybeDocuments;return e.sizeMap.forEach(function(e,t){n.documentSizes.set(e,t)}),t})},t}(Wt),e}();function Kt(e){return Vn.getStore(e,hn.store)}function Yt(e){return Vn.getStore(e,ln.store)}function Zt(e){return e.path.toArray()}function Jt(e){var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw m("Unknown remote document type");t=e.noDocument}return JSON.stringify(t).length}var Xt=function(){function e(){this.collectionParentIndex=new $t}return e.prototype.addToCollectionParentIndex=function(e,t){return this.collectionParentIndex.add(t),ze.resolve()},e.prototype.getCollectionParents=function(e,t){return ze.resolve(this.collectionParentIndex.getEntries(t))},e}(),$t=function(){function e(){this.index={}}return e.prototype.add=function(e){g(e.length%2==1,"Expected a collection path.");var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ae(ae.comparator),i=!r.has(n);return this.index[t]=r.add(n),i},e.prototype.has=function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)},e.prototype.getEntries=function(e){return(this.index[e]||new Ae(ae.comparator)).toArray()},e}(),en=9,tn=function(){function e(e){this.serializer=e}return e.prototype.createOrUpgrade=function(e,t,n,r){var i=this;g(n<r&&n>=0&&r<=en,"Unexpected schema upgrade from v"+n+" to v{toVersion}.");var o=new rt(t);n<1&&r>=1&&(function(e){e.createObjectStore(rn.store)}(e),function(e){e.createObjectStore(on.store,{keyPath:on.keyPath}),e.createObjectStore(an.store,{keyPath:an.keyPath,autoIncrement:!0}).createIndex(an.userMutationsIndex,an.userMutationsKeyPath,{unique:!0}),e.createObjectStore(sn.store)}(e),vn(e),function(e){e.createObjectStore(ln.store)}(e));var a=ze.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(dn.store),e.deleteObjectStore(fn.store),e.deleteObjectStore(pn.store)}(e),vn(e)),a=a.next(function(){return e=o.store(pn.store),t=new pn(0,0,ke.MIN.toTimestamp(),0),e.put(pn.key,t);var e,t})),n<4&&r>=4&&(0!==n&&(a=a.next(function(){return function(e,t){return t.store(an.store).loadAll().next(function(n){e.deleteObjectStore(an.store),e.createObjectStore(an.store,{keyPath:an.keyPath,autoIncrement:!0}).createIndex(an.userMutationsIndex,an.userMutationsKeyPath,{unique:!0});var r=t.store(an.store),i=n.map(function(e){return r.put(e)});return ze.waitFor(i)})}(e,o)})),a=a.next(function(){!function(e){e.createObjectStore(mn.store,{keyPath:mn.keyPath})}(e)})),n<5&&r>=5&&(a=a.next(function(){return i.removeAcknowledgedMutations(o)})),n<6&&r>=6&&(a=a.next(function(){return function(e){e.createObjectStore(hn.store)}(e),i.addDocumentGlobal(o)})),n<7&&r>=7&&(a=a.next(function(){return i.ensureSequenceNumbers(o)})),n<8&&r>=8&&(a=a.next(function(){return i.createCollectionParentIndex(e,o)})),n<9&&r>=9&&(a=a.next(function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){var t=e.objectStore(ln.store);t.createIndex(ln.readTimeIndex,ln.readTimeIndexPath,{unique:!1}),t.createIndex(ln.collectionReadTimeIndex,ln.collectionReadTimeIndexPath,{unique:!1})}(t)})),a},e.prototype.addDocumentGlobal=function(e){var t=0;return e.store(ln.store).iterate(function(e,n){t+=Jt(n)}).next(function(){var n=new hn(t);return e.store(hn.store).put(hn.key,n)})},e.prototype.removeAcknowledgedMutations=function(e){var t=this,n=e.store(on.store),r=e.store(an.store);return n.loadAll().next(function(n){return ze.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(an.userMutationsIndex,i).next(function(r){return ze.forEach(r,function(r){g(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=t.serializer.fromDbMutationBatch(r);return We(e,n.userId,i).next(function(){})})})})})},e.prototype.ensureSequenceNumbers=function(e){var t=e.store(dn.store),n=e.store(ln.store);return ht(e).next(function(e){var r=[];return n.iterate(function(n,i){var o=new ae(n),a=function(e){return[0,ge(e)]}(o);r.push(t.get(a).next(function(n){return n?ze.resolve():function(n){return t.put(new dn(0,ge(n),e))}(o)}))}).next(function(){return ze.waitFor(r)})})},e.prototype.createCollectionParentIndex=function(e,t){e.createObjectStore(yn.store,{keyPath:yn.keyPath});var n=t.store(yn.store),r=new $t,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:ge(i)})}};return t.store(ln.store).iterate({keysOnly:!0},function(e,t){var n=new ae(e);return i(n.popLast())}).next(function(){return t.store(sn.store).iterate({keysOnly:!0},function(e,t){var n=we(e[1]);return i(n.popLast())})})},e}(),nn=function(e,t){this.seconds=e,this.nanoseconds=t},rn=function(){function e(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n}return e.store="owner",e.key="owner",e}(),on=function(){function e(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}return e.store="mutationQueues",e.keyPath="userId",e}(),an=function(){function e(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return e.store="mutations",e.keyPath="batchId",e.userMutationsIndex="userMutationsIndex",e.userMutationsKeyPath=["userId","batchId"],e}(),sn=function(){function e(){}return e.prefixForUser=function(e){return[e]},e.prefixForPath=function(e,t){return[e,ge(t)]},e.key=function(e,t,n){return[e,ge(t),n]},e.store="documentMutations",e.PLACEHOLDER=new e,e}(),un=function(e,t){this.path=e,this.readTime=t},cn=function(e,t){this.path=e,this.version=t},ln=function(){function e(e,t,n,r,i,o){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o}return e.store="remoteDocuments",e.readTimeIndex="readTimeIndex",e.readTimeIndexPath="readTime",e.collectionReadTimeIndex="collectionReadTimeIndex",e.collectionReadTimeIndexPath=["parentPath","readTime"],e}(),hn=function(){function e(e){this.byteSize=e}return e.store="remoteDocumentGlobal",e.key="remoteDocumentGlobalKey",e}(),fn=function(){function e(e,t,n,r,i,o,a){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a}return e.store="targets",e.keyPath="targetId",e.queryTargetsIndexName="queryTargetsIndex",e.queryTargetsKeyPath=["canonicalId","targetId"],e}(),dn=function(){function e(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n,g(0===e==(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return e.store="targetDocuments",e.keyPath=["targetId","path"],e.documentTargetsIndex="documentTargetsIndex",e.documentTargetsKeyPath=["path","targetId"],e}(),pn=function(){function e(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return e.key="targetGlobalKey",e.store="targetGlobal",e}(),yn=function(){function e(e,t){this.collectionId=e,this.parent=t}return e.store="collectionParents",e.keyPath=["collectionId","parent"],e}();function vn(e){e.createObjectStore(dn.store,{keyPath:dn.keyPath}).createIndex(dn.documentTargetsIndex,dn.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(fn.store,{keyPath:fn.keyPath}).createIndex(fn.queryTargetsIndexName,fn.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(pn.store)}var mn=function(){function e(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r}return e.store="clientMetadata",e.keyPath="clientId",e}(),gn=o.__spreadArrays([on.store,an.store,sn.store,ln.store,fn.store,rn.store,pn.store,dn.store],[mn.store]),_n=o.__spreadArrays(gn,[hn.store]),bn=o.__spreadArrays(_n,[yn.store]),wn=function(){function e(){this.collectionParentsCache=new $t}return e.prototype.addToCollectionParentIndex=function(e,t){var n=this;if(g(t.length%2==1,"Expected a collection path."),!this.collectionParentsCache.has(t)){var r=t.lastSegment(),i=t.popLast();return e.addOnCommittedListener(function(){n.collectionParentsCache.add(t)}),Cn(e).put({collectionId:r,parent:ge(i)})}return ze.resolve()},e.prototype.getCollectionParents=function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[Z(t),""],!1,!0);return Cn(e).loadAll(r).next(function(e){for(var r=0,i=e;r<i.length;r++){var o=i[r];if(o.collectionId!==t)break;n.push(we(o.parent))}return n})},e}();function Cn(e){return Vn.getStore(e,yn.store)}var kn=function(e){return e[e.Listen=0]="Listen",e[e.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",e[e.LimboResolution=2]="LimboResolution",e}({}),Sn=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=ke.MIN),void 0===o&&(o=ke.MIN),void 0===a&&(a=b()),this.query=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return e.prototype.withSequenceNumber=function(t){return new e(this.query,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},e.prototype.withResumeToken=function(t,n){return new e(this.query,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)},e.prototype.withLastLimboFreeSnapshotVersion=function(t){return new e(this.query,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},e.prototype.isEqual=function(e){return this.targetId===e.targetId&&this.purpose===e.purpose&&this.sequenceNumber===e.sequenceNumber&&this.snapshotVersion.isEqual(e.snapshotVersion)&&this.lastLimboFreeSnapshotVersion.isEqual(e.lastLimboFreeSnapshotVersion)&&this.resumeToken===e.resumeToken&&this.query.isEqual(e.query)},e}(),En=function(){function e(e){this.remoteSerializer=e}return e.prototype.fromDbRemoteDocument=function(e){if(e.document)return this.remoteSerializer.fromDocument(e.document,!!e.hasCommittedMutations);if(e.noDocument){var t=ce.fromSegments(e.noDocument.path),n=this.fromDbTimestamp(e.noDocument.readTime);return new zt(t,n,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(t=ce.fromSegments(e.unknownDocument.path),n=this.fromDbTimestamp(e.unknownDocument.version),new Qt(t,n)):m("Unexpected DbRemoteDocument")},e.prototype.toDbRemoteDocument=function(e,t){var n=this.toDbTimestampKey(t),r=e.key.path.popLast().toArray();if(e instanceof jt){var i=e.proto?e.proto:this.remoteSerializer.toDocument(e);return new ln(null,null,i,s=e.hasCommittedMutations,n,r)}if(e instanceof zt){var o=e.key.path.toArray(),a=this.toDbTimestamp(e.version),s=e.hasCommittedMutations;return new ln(null,new un(o,a),null,s,n,r)}if(e instanceof Qt){o=e.key.path.toArray();var u=this.toDbTimestamp(e.version);return new ln(new cn(o,u),null,null,!0,n,r)}return m("Unexpected MaybeDocument")},e.prototype.toDbTimestampKey=function(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]},e.prototype.fromDbTimestampKey=function(e){var t=new Ce(e[0],e[1]);return ke.fromTimestamp(t)},e.prototype.toDbTimestamp=function(e){var t=e.toTimestamp();return new nn(t.seconds,t.nanoseconds)},e.prototype.fromDbTimestamp=function(e){var t=new Ce(e.seconds,e.nanoseconds);return ke.fromTimestamp(t)},e.prototype.toDbMutationBatch=function(e,t){var n=this,r=t.baseMutations.map(function(e){return n.remoteSerializer.toMutation(e)}),i=t.mutations.map(function(e){return n.remoteSerializer.toMutation(e)});return new an(e,t.batchId,t.localWriteTime.toMillis(),r,i)},e.prototype.fromDbMutationBatch=function(e){var t=this,n=(e.baseMutations||[]).map(function(e){return t.remoteSerializer.fromMutation(e)}),r=e.mutations.map(function(e){return t.remoteSerializer.fromMutation(e)}),i=Ce.fromMillis(e.localWriteTimeMs);return new Be(e.batchId,i,n,r)},e.prototype.toDbResourcePaths=function(e){var t=[];return e.forEach(function(e){t.push(ge(e.path))}),t},e.prototype.fromDbResourcePaths=function(e){for(var t=Fe(),n=0,r=e;n<r.length;n++)t=t.add(new ce(we(r[n])));return t},e.prototype.fromDbTarget=function(e){var t,n=this.fromDbTimestamp(e.readTime),r=void 0!==e.lastLimboFreeSnapshotVersion?this.fromDbTimestamp(e.lastLimboFreeSnapshotVersion):ke.MIN,i=e.resumeToken;return t=void 0!==e.query.documents?this.remoteSerializer.fromDocumentsTarget(e.query):this.remoteSerializer.fromQueryTarget(e.query),new Sn(t,e.targetId,kn.Listen,e.lastListenSequenceNumber,n,r,i)},e.prototype.toDbTarget=function(e){g(kn.Listen===e.purpose,"Only queries with purpose "+kn.Listen+" may be stored, got "+e.purpose);var t,n,r=this.toDbTimestamp(e.snapshotVersion),i=this.toDbTimestamp(e.lastLimboFreeSnapshotVersion);return t=e.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(e.query):this.remoteSerializer.toQueryTarget(e.query),e.resumeToken instanceof Uint8Array?(g("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence ."),n=e.resumeToken.toString()):n=e.resumeToken,new fn(e.targetId,e.query.canonicalId(),r,n,e.sequenceNumber,i,t)},e}();function Tn(e,t){var n=e[1],r=t[1],i=K(e[0],t[0]);return 0===i?K(n,r):i}var In=function(){function e(e){this.maxElements=e,this.buffer=new Ae(Tn),this.previousIndex=0}return e.prototype.nextIndex=function(){return++this.previousIndex},e.prototype.addElement=function(e){var t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();Tn(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),e}(),An={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Dn=function(){function e(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}return e.withCacheSize=function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},e.COLLECTION_DISABLED=-1,e.MINIMUM_CACHE_SIZE_BYTES=1048576,e.DEFAULT=new e(e.DEFAULT_CACHE_SIZE_BYTES=41943040,e.DEFAULT_COLLECTION_PERCENTILE=10,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3),e.DISABLED=new e(e.COLLECTION_DISABLED,0,0),e}(),Nn=function(){function e(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.hasRun=!1,this.gcTask=null}return e.prototype.start=function(){g(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==Dn.COLLECTION_DISABLED&&this.scheduleGC()},e.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(e.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),e.prototype.scheduleGC=function(){var e=this;g(null===this.gcTask,"Cannot schedule GC while a task is pending");var t=this.hasRun?3e5:6e4;p("LruGarbageCollector","Garbage collection scheduled in "+t+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(he.LruGarbageCollection,t,function(){return e.gcTask=null,e.hasRun=!0,e.localStore.collectGarbage(e.garbageCollector).then(function(){return e.scheduleGC()}).catch(Fn)})},e}(),Rn=function(){function e(e,t){this.delegate=e,this.params=t}return e.prototype.calculateTargetCount=function(e,t){return this.delegate.getSequenceNumberCount(e).next(function(e){return Math.floor(t/100*e)})},e.prototype.nthSequenceNumber=function(e,t){var n=this;if(0===t)return ze.resolve(ie.INVALID);var r=new In(t);return this.delegate.forEachTarget(e,function(e){return r.addElement(e.sequenceNumber)}).next(function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(e,function(e){return r.addElement(e)})}).next(function(){return r.maxValue})},e.prototype.removeTargets=function(e,t,n){return this.delegate.removeTargets(e,t,n)},e.prototype.removeOrphanedDocuments=function(e,t){return this.delegate.removeOrphanedDocuments(e,t)},e.prototype.collect=function(e,t){var n=this;return this.params.cacheSizeCollectionThreshold===Dn.COLLECTION_DISABLED?(p("LruGarbageCollector","Garbage collection skipped; disabled"),ze.resolve(An)):this.getCacheSize(e).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(p("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),An):n.runGarbageCollection(e,t)})},e.prototype.getCacheSize=function(e){return this.delegate.getCacheSize(e)},e.prototype.runGarbageCollection=function(e,t){var n,r,i,o,a,s,u,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(function(t){return t>c.params.maximumSequenceNumbersToCollect?(p("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+t),r=c.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),c.nthSequenceNumber(e,r)}).next(function(r){return n=r,a=Date.now(),c.removeTargets(e,n,t)}).next(function(t){return i=t,s=Date.now(),c.removeOrphanedDocuments(e,n)}).next(function(e){return u=Date.now(),f()<=h.DEBUG&&p("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+e+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-l)+"ms"),ze.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})})},e}(),xn=function(){function e(){this.onCommittedListeners=[]}return e.prototype.addOnCommittedListener=function(e){this.onCommittedListeners.push(e)},e.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(e){return e()})},e}(),On="IndexedDbPersistence",Pn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Mn="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",Ln=function(e){function t(t,n){var r=e.call(this)||this;return r.simpleDbTransaction=t,r.currentSequenceNumber=n,r}return o.__extends(t,e),t}(xn),Vn=function(){function e(t,n,r,i,o,a,s,u){if(this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.queue=a,this.sequenceNumberSyncer=u,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(e){return Promise.resolve()},this.referenceDelegate=new Bn(this,o),this.dbName=n+e.MAIN_DATABASE,this.serializer=new En(s),this.document=i.document,this.queryCache=new ut(this.referenceDelegate,this.serializer),this.indexManager=new wn,this.remoteDocumentCache=new Gt(this.serializer,this.indexManager),!i.window||!i.window.localStorage)throw new C(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.webStorage=this.window.localStorage}return e.getStore=function(e,t){if(e instanceof Ln)return tt.getStore(e.simpleDbTransaction,t);throw m("IndexedDbPersistence must use instances of IndexedDbTransaction")},e.createIndexedDbPersistence=function(t){return o.__awaiter(this,void 0,void 0,function(){var n;return o.__generator(this,function(r){switch(r.label){case 0:if(!e.isAvailable())throw new C(w.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");return[4,(n=new e(t.allowTabSynchronization,t.persistenceKey,t.clientId,t.platform,t.lruParams,t.queue,t.serializer,t.sequenceNumberSyncer)).start()];case 1:return r.sent(),[2,n]}})})},e.prototype.start=function(){var e=this;return g(!this.started,"IndexedDbPersistence double-started!"),g(null!==this.window,"Expected 'window' to be defined"),tt.openOrCreate(this.dbName,en,new tn(this.serializer)).then(function(t){return e.simpleDb=t,e.updateClientMetadataAndTryBecomePrimary()}).then(function(){return e.attachVisibilityHandler(),e.attachWindowUnloadHook(),e.scheduleClientMetadataAndPrimaryLeaseRefreshes(),e.simpleDb.runTransaction("readonly-idempotent",[pn.store],function(e){return ht(e)})}).then(function(t){e.listenSequence=new ie(t,e.sequenceNumberSyncer)}).then(function(){e._started=!0}).catch(function(t){return e.simpleDb&&e.simpleDb.close(),Promise.reject(t)})},e.prototype.setPrimaryStateListener=function(e){var t=this;return this.primaryStateListener=function(n){return o.__awaiter(t,void 0,void 0,function(){return o.__generator(this,function(t){return this.started?[2,e(n)]:[2]})})},e(this.isPrimary)},e.prototype.setDatabaseDeletedListener=function(e){var t=this;this.simpleDb.setVersionChangeListener(function(n){return o.__awaiter(t,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return null!==n.newVersion?[3,2]:[4,e()];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},e.prototype.setNetworkEnabled=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget(function(){return o.__awaiter(t,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}))},e.prototype.updateClientMetadataAndTryBecomePrimary=function(){var e=this;return this.simpleDb.runTransaction("readwrite",bn,function(t){return qn(t).put(new mn(e.clientId,Date.now(),e.networkEnabled,e.inForeground)).next(function(){if(e.isPrimary)return e.verifyPrimaryLease(t).next(function(t){t||(e.isPrimary=!1,e.queue.enqueueAndForget(function(){return e.primaryStateListener(!1)}))})}).next(function(){return e.canActAsPrimary(t)}).next(function(n){var r=e.isPrimary;return e.isPrimary=n,r!==e.isPrimary&&e.queue.enqueueAndForget(function(){return e.primaryStateListener(e.isPrimary)}),r&&!e.isPrimary?e.releasePrimaryLeaseIfHeld(t):e.isPrimary?e.acquireOrExtendPrimaryLease(t):void 0})})},e.prototype.verifyPrimaryLease=function(e){var t=this;return Un(e).get(rn.key).next(function(e){return ze.resolve(t.isLocalClient(e))})},e.prototype.removeClientMetadata=function(e){return qn(e).delete(this.clientId)},e.prototype.maybeGarbageCollectMultiClientState=function(){return o.__awaiter(this,void 0,void 0,function(){var t,n,r=this;return o.__generator(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),n=[],[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(i){var o=e.getStore(i,mn.store);return o.loadAll().next(function(e){return t=r.filterActiveClients(e,18e5),n=e.filter(function(e){return-1===t.indexOf(e)}),ze.forEach(n,function(e){return o.delete(e.clientId)})})})]);case 1:i.sent(),n.forEach(function(e){r.window.localStorage.removeItem(r.zombiedClientLocalStorageKey(e.clientId))}),i.label=2;case 2:return[2]}})})},e.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var e=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(he.ClientMetadataRefresh,4e3,function(){return e.updateClientMetadataAndTryBecomePrimary().then(function(){return e.maybeGarbageCollectMultiClientState()}).then(function(){return e.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},e.prototype.isLocalClient=function(e){return!!e&&e.ownerId===this.clientId},e.prototype.canActAsPrimary=function(e){var t=this;return Un(e).get(rn.key).next(function(n){if(null!==n&&t.isWithinAge(n.leaseTimestampMs,5e3)&&!t.isClientZombied(n.ownerId)){if(t.isLocalClient(n)&&t.networkEnabled)return!0;if(!t.isLocalClient(n)){if(!n.allowTabSynchronization)throw new C(w.FAILED_PRECONDITION,Mn);return!1}}return!(!t.networkEnabled||!t.inForeground)||qn(e).loadAll().next(function(e){return void 0===t.filterActiveClients(e,5e3).find(function(e){return!(t.clientId===e.clientId||!(!t.networkEnabled&&e.networkEnabled||!t.inForeground&&e.inForeground&&t.networkEnabled===e.networkEnabled))})})}).next(function(e){return t.isPrimary!==e&&p(On,"Client "+(e?"is":"is not")+" eligible for a primary lease."),e})},e.prototype.shutdown=function(){return o.__awaiter(this,void 0,void 0,function(){var e=this;return o.__generator(this,function(t){switch(t.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite-idempotent",[rn.store,mn.store],function(t){return e.releasePrimaryLeaseIfHeld(t).next(function(){return e.removeClientMetadata(t)})})];case 1:return t.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}})})},e.prototype.filterActiveClients=function(e,t){var n=this;return e.filter(function(e){return n.isWithinAge(e.updateTimeMs,t)&&!n.isClientZombied(e.clientId)})},e.prototype.getActiveClients=function(){var e=this;return this.simpleDb.runTransaction("readonly-idempotent",[mn.store],function(t){return qn(t).loadAll().next(function(t){return e.filterActiveClients(t,18e5).map(function(e){return e.clientId})})})},e.clearPersistence=function(t){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(n){switch(n.label){case 0:return e.isAvailable()?[4,tt.delete(t+e.MAIN_DATABASE)]:[2,Promise.resolve()];case 1:return n.sent(),[2]}})})},Object.defineProperty(e.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),e.prototype.getMutationQueue=function(e){return g(this.started,"Cannot initialize MutationQueue before persistence is started."),Qe.forUser(e,this.serializer,this.indexManager,this.referenceDelegate)},e.prototype.getQueryCache=function(){return g(this.started,"Cannot initialize QueryCache before persistence is started."),this.queryCache},e.prototype.getRemoteDocumentCache=function(){return g(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},e.prototype.getIndexManager=function(){return g(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},e.prototype.runTransaction=function(e,t,n){var r=this;p(On,"Starting transaction:",e);var i,o=t.endsWith("idempotent"),a=t.startsWith("readonly");return this.simpleDb.runTransaction(a?o?"readonly-idempotent":"readonly":o?"readwrite-idempotent":"readwrite",bn,function(o){return i=new Ln(o,r.listenSequence.next()),"readwrite-primary"===t||"readwrite-primary-idempotent"===t?r.verifyPrimaryLease(o).next(function(t){if(!t)throw y("Failed to obtain primary lease for action '"+e+"'."),r.isPrimary=!1,r.queue.enqueueAndForget(function(){return r.primaryStateListener(!1)}),new C(w.FAILED_PRECONDITION,Pn);return n(i)}).next(function(e){return r.acquireOrExtendPrimaryLease(o).next(function(){return e})}):r.verifyAllowTabSynchronization(o).next(function(){return n(i)})}).then(function(e){return i.raiseOnCommittedEvent(),e})},e.prototype.verifyAllowTabSynchronization=function(e){var t=this;return Un(e).get(rn.key).next(function(e){if(null!==e&&t.isWithinAge(e.leaseTimestampMs,5e3)&&!t.isClientZombied(e.ownerId)&&!t.isLocalClient(e)&&!e.allowTabSynchronization)throw new C(w.FAILED_PRECONDITION,Mn)})},e.prototype.acquireOrExtendPrimaryLease=function(e){var t=new rn(this.clientId,this.allowTabSynchronization,Date.now());return Un(e).put(rn.key,t)},e.isAvailable=function(){return tt.isAvailable()},e.buildStoragePrefix=function(e){var t=e.databaseId.projectId;return e.databaseId.isDefaultDatabase||(t+="."+e.databaseId.database),"firestore/"+e.persistenceKey+"/"+t+"/"},e.prototype.releasePrimaryLeaseIfHeld=function(e){var t=this,n=Un(e);return n.get(rn.key).next(function(e){return t.isLocalClient(e)?(p(On,"Releasing primary lease."),n.delete(rn.key)):ze.resolve()})},e.prototype.isWithinAge=function(e,t){var n=Date.now();return!(e<n-t||e>n&&(y("Detected an update time that is in the future: "+e+" > "+n),1))},e.prototype.attachVisibilityHandler=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){e.queue.enqueueAndForget(function(){return e.inForeground="visible"===e.document.visibilityState,e.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},e.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(g(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},e.prototype.attachWindowUnloadHook=function(){var e=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){e.markClientZombied(),e.queue.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("unload",this.windowUnloadHandler))},e.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(g("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},e.prototype.isClientZombied=function(e){try{var t=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(e));return p(On,"Client '"+e+"' "+(t?"is":"is not")+" zombied in LocalStorage"),t}catch(n){return y(On,"Failed to get zombied client id.",n),!1}},e.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){y("Failed to set zombie client id.",e)}},e.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}},e.prototype.zombiedClientLocalStorageKey=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},e.MAIN_DATABASE="main",e}();function Fn(e){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(t){if(!function(e){return e.code===w.FAILED_PRECONDITION&&e.message===Pn}(e))throw e;return p(On,"Unexpectedly lost primary lease"),[2]})})}function Un(e){return e.store(rn.store)}function qn(e){return e.store(mn.store)}var Bn=function(){function e(e,t){this.db=e,this.inMemoryPins=null,this.garbageCollector=new Rn(this,t)}return e.prototype.getSequenceNumberCount=function(e){var t=this.orphanedDocmentCount(e);return this.db.getQueryCache().getQueryCount(e).next(function(e){return t.next(function(t){return e+t})})},e.prototype.orphanedDocmentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,function(e){t++}).next(function(){return t})},e.prototype.forEachTarget=function(e,t){return this.db.getQueryCache().forEachTarget(e,t)},e.prototype.forEachOrphanedDocumentSequenceNumber=function(e,t){return this.forEachOrphanedDocument(e,function(e,n){return t(n)})},e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.addReference=function(e,t){return jn(e,t)},e.prototype.removeReference=function(e,t){return jn(e,t)},e.prototype.removeTargets=function(e,t,n){return this.db.getQueryCache().removeTargets(e,t,n)},e.prototype.removeMutationReference=function(e,t){return jn(e,t)},e.prototype.isPinned=function(e,t){return this.inMemoryPins.containsKey(t)?ze.resolve(!0):function(e,t){var n=!1;return Ze(e).iterateSerial(function(r){return He(e,r,t).next(function(e){return e&&(n=!0),ze.resolve(!e)})}).next(function(){return n})}(e,t)},e.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.forEachOrphanedDocument(e,function(a,s){if(s<=t){var u=n.isPinned(e,a).next(function(t){if(!t)return o++,r.getEntry(e,a).next(function(){return r.removeEntry(a),ft(e).delete([0,ge(a.path)])})});i.push(u)}}).next(function(){return ze.waitFor(i)}).next(function(){return r.apply(e)}).next(function(){return o})},e.prototype.removeTarget=function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getQueryCache().updateQueryData(e,n)},e.prototype.updateLimboDocument=function(e,t){return jn(e,t)},e.prototype.forEachOrphanedDocument=function(e,t){var n,r=ft(e),i=ie.INVALID;return r.iterate({index:dn.documentTargetsIndex},function(e,r){var o=r.path,a=r.sequenceNumber;0===e[0]?(i!==ie.INVALID&&t(new ce(we(n)),i),i=a,n=o):i=ie.INVALID}).next(function(){i!==ie.INVALID&&t(new ce(we(n)),i)})},e.prototype.getCacheSize=function(e){return this.db.getRemoteDocumentCache().getSize(e)},e}();function jn(e,t){return ft(e).put(function(e,t){return new dn(0,ge(e.path),t)}(t,e.currentSequenceNumber))}var zn=function(){function e(e,t,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.indexManager=n}return e.prototype.getDocument=function(e,t){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(e,t).next(function(r){return n.getDocumentInternal(e,t,r)})},e.prototype.getDocumentInternal=function(e,t,n){return this.remoteDocumentCache.getEntry(e,t).next(function(e){for(var r=0,i=n;r<i.length;r++)e=i[r].applyToLocalView(t,e);return e})},e.prototype.applyLocalMutationsToDocuments=function(e,t,n){var r=xe();return t.forEach(function(e,t){for(var i=0,o=n;i<o.length;i++)t=o[i].applyToLocalView(e,t);r=r.insert(e,t)}),r},e.prototype.getDocuments=function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.getLocalViewOfDocuments(e,t)})},e.prototype.getLocalViewOfDocuments=function(e,t){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(r){var i=n.applyLocalMutationsToDocuments(e,t,r),o=Re();return i.forEach(function(e,t){t||(t=new zt(e,ke.forDeletedDoc())),o=o.insert(e,t)}),o})},e.prototype.getDocumentsMatchingQuery=function(e,t,n){return t.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(e,t.path):t.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)},e.prototype.getDocumentsMatchingDocumentQuery=function(e,t){return this.getDocument(e,new ce(t)).next(function(e){var t=Pe();return e instanceof jt&&(t=t.insert(e.key,e)),t})},e.prototype.getDocumentsMatchingCollectionGroupQuery=function(e,t,n){var r=this;g(t.path.isEmpty(),"Currently we only support collection group queries at the root.");var i=t.collectionGroup,o=Pe();return this.indexManager.getCollectionParents(e,i).next(function(a){return ze.forEach(a,function(a){var s=t.asCollectionQueryAtPath(a.child(i));return r.getDocumentsMatchingCollectionQuery(e,s,n).next(function(e){e.forEach(function(e,t){o=o.insert(e,t)})})}).next(function(){return o})})},e.prototype.getDocumentsMatchingCollectionQuery=function(e,t,n){var r,i,o=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n).next(function(n){return r=n,o.mutationQueue.getAllMutationBatchesAffectingQuery(e,t)}).next(function(t){return o.addMissingBaseDocuments(e,i=t,r).next(function(e){r=e;for(var t=0,n=i;t<n.length;t++)for(var o=n[t],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,l=r.get(c),h=u.applyToLocalView(l,l,o.localWriteTime);r=h instanceof jt?r.insert(c,h):r.remove(c)}})}).next(function(){return r.forEach(function(e,n){t.matches(n)||(r=r.remove(e))}),r})},e.prototype.addMissingBaseDocuments=function(e,t,n){for(var r=Fe(),i=0,o=t;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof bt&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.remoteDocumentCache.getEntries(e,r).next(function(e){return e.forEach(function(e,t){null!==t&&t instanceof jt&&(c=c.insert(e,t))}),c})},e}(),Qn=function(){function e(){this.refsByKey=new Ae(Hn.compareByKey),this.refsByTarget=new Ae(Hn.compareByTargetId)}return e.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},e.prototype.addReference=function(e,t){var n=new Hn(e,t);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},e.prototype.addReferences=function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})},e.prototype.removeReference=function(e,t){this.removeRef(new Hn(e,t))},e.prototype.removeReferences=function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})},e.prototype.removeReferencesForId=function(e){var t=this,n=ce.EMPTY,r=new Hn(n,e),i=new Hn(n,e+1),o=[];return this.refsByTarget.forEachInRange([r,i],function(e){t.removeRef(e),o.push(e.key)}),o},e.prototype.removeAllReferences=function(){var e=this;this.refsByKey.forEach(function(t){return e.removeRef(t)})},e.prototype.removeRef=function(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)},e.prototype.referencesForId=function(e){var t=ce.EMPTY,n=new Hn(t,e),r=new Hn(t,e+1),i=Fe();return this.refsByTarget.forEachInRange([n,r],function(e){i=i.add(e.key)}),i},e.prototype.containsKey=function(e){var t=new Hn(e,0),n=this.refsByKey.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)},e}(),Hn=function(){function e(e,t){this.key=e,this.targetOrBatchId=t}return e.compareByKey=function(e,t){return ce.comparator(e.key,t.key)||K(e.targetOrBatchId,t.targetOrBatchId)},e.compareByTargetId=function(e,t){return K(e.targetOrBatchId,t.targetOrBatchId)||ce.comparator(e.key,t.key)},e}(),Wn=function(){function e(e,t,n){this.persistence=e,this.queryEngine=t,this.localViewReferences=new Qn,this.queryDataByTarget=new Se(K),this.targetIdByQuery=new Ht(function(e){return e.canonicalId()}),this.lastDocumentChangeReadTime=ke.MIN,g(e.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=e.getMutationQueue(n),this.remoteDocuments=e.getRemoteDocumentCache(),this.queryCache=e.getQueryCache(),this.localDocuments=new zn(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager()),this.queryEngine.setLocalDocumentsView(this.localDocuments)}return e.prototype.start=function(){return this.synchronizeLastDocumentChangeReadTime()},e.prototype.handleUserChange=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n,r,i=this;return o.__generator(this,function(o){switch(o.label){case 0:return t=this.mutationQueue,n=this.localDocuments,[4,this.persistence.runTransaction("Handle user change","readonly-idempotent",function(r){var o;return i.mutationQueue.getAllMutationBatches(r).next(function(a){return o=a,t=i.persistence.getMutationQueue(e),n=new zn(i.remoteDocuments,t,i.persistence.getIndexManager()),t.getAllMutationBatches(r)}).next(function(e){for(var t=[],i=[],a=Fe(),s=0,u=o;s<u.length;s++){t.push((d=u[s]).batchId);for(var c=0,l=d.mutations;c<l.length;c++)a=a.add(l[c].key)}for(var h=0,f=e;h<f.length;h++){var d;i.push((d=f[h]).batchId);for(var p=0,y=d.mutations;p<y.length;p++)a=a.add(y[p].key)}return n.getDocuments(r,a).next(function(e){return{affectedDocuments:e,removedBatchIds:t,addedBatchIds:i}})})})];case 1:return r=o.sent(),this.mutationQueue=t,this.localDocuments=n,this.queryEngine.setLocalDocumentsView(this.localDocuments),[2,r]}})})},e.prototype.localWrite=function(e){var t,n=this,r=Ce.now(),i=e.reduce(function(e,t){return e.add(t.key)},Fe());return this.persistence.runTransaction("Locally write mutations","readwrite-idempotent",function(o){return n.localDocuments.getDocuments(o,i).next(function(i){t=i;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],l=c.extractBaseValue(t.get(c.key));null!=l&&a.push(new bt(c.key,l,l.fieldMask(),mt.exists(!0)))}return n.mutationQueue.addMutationBatch(o,r,a,e)})}).then(function(e){var n=e.applyToLocalDocumentSet(t);return{batchId:e.batchId,changes:n}})},e.prototype.lookupMutationDocuments=function(e){var t=this;return this.persistence.runTransaction("Lookup mutation documents","readonly-idempotent",function(n){return t.mutationQueue.lookupMutationKeys(n,e).next(function(e){return e?t.localDocuments.getDocuments(n,e):ze.resolve(null)})})},e.prototype.acknowledgeBatch=function(e){var t=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary-idempotent",function(n){var r=e.batch.keys(),i=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});return t.mutationQueue.acknowledgeBatch(n,e.batch,e.streamToken).next(function(){return t.applyWriteToRemoteDocuments(n,e,i)}).next(function(){return i.apply(n)}).next(function(){return t.mutationQueue.performConsistencyCheck(n)}).next(function(){return t.localDocuments.getDocuments(n,r)})})},e.prototype.rejectBatch=function(e){var t=this;return this.persistence.runTransaction("Reject batch","readwrite-primary-idempotent",function(n){var r;return t.mutationQueue.lookupMutationBatch(n,e).next(function(e){return g(null!==e,"Attempt to reject nonexistent batch!"),r=e.keys(),t.mutationQueue.removeMutationBatch(n,e)}).next(function(){return t.mutationQueue.performConsistencyCheck(n)}).next(function(){return t.localDocuments.getDocuments(n,r)})})},e.prototype.getHighestUnacknowledgedBatchId=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly-idempotent",function(t){return e.mutationQueue.getHighestUnacknowledgedBatchId(t)})},e.prototype.getLastStreamToken=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly-idempotent",function(t){return e.mutationQueue.getLastStreamToken(t)})},e.prototype.setLastStreamToken=function(e){var t=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary-idempotent",function(n){return t.mutationQueue.setLastStreamToken(n,e)})},e.prototype.getLastRemoteSnapshotVersion=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly-idempotent",function(t){return e.queryCache.getLastRemoteSnapshotVersion(t)})},e.prototype.applyRemoteEvent=function(t){var n=this,r=t.snapshotVersion,i=this.queryDataByTarget;return this.persistence.runTransaction("Apply remote event","readwrite-primary-idempotent",function(o){var a=n.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=n.queryDataByTarget;var s=[];T(t.targetChanges,function(t,a){var u=i.get(t);if(u){s.push(n.queryCache.removeMatchingKeys(o,a.removedDocuments,t).next(function(){return n.queryCache.addMatchingKeys(o,a.addedDocuments,t)}));var c=a.resumeToken;if(c.length>0){var l=u.withResumeToken(c,r).withSequenceNumber(o.currentSequenceNumber);i=i.insert(t,l),e.shouldPersistQueryData(u,l,a)&&s.push(n.queryCache.updateQueryData(o,l))}}});var u=Re(),c=Fe();if(t.documentUpdates.forEach(function(e,t){c=c.add(e)}),s.push(a.getEntries(o,c).next(function(e){t.documentUpdates.forEach(function(i,c){var l=e.get(i);c instanceof zt&&c.version.isEqual(ke.MIN)?(a.removeEntry(i,r),u=u.insert(i,c)):null==l||c.version.compareTo(l.version)>0||0===c.version.compareTo(l.version)&&l.hasPendingWrites?(ke.MIN.isEqual(r)&&y("LocalStore","Cannot add a document when the remote version is zero"),a.addEntry(c,r),u=u.insert(i,c)):p("LocalStore","Ignoring outdated watch update for ",i,". Current version:",l.version," Watch version:",c.version),t.resolvedLimboDocuments.has(i)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(o,i))})})),!r.isEqual(ke.MIN)){var l=n.queryCache.getLastRemoteSnapshotVersion(o).next(function(e){return g(r.compareTo(e)>=0,"Watch stream reverted to previous snapshot?? "+r+" < "+e),n.queryCache.setTargetsMetadata(o,o.currentSequenceNumber,r)});s.push(l)}return ze.waitFor(s).next(function(){return a.apply(o)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(o,u)})}).then(function(e){return n.queryDataByTarget=i,e})},e.shouldPersistQueryData=function(e,t,n){return g(t.resumeToken.length>0,"Attempted to persist query data with no resume token"),0===e.resumeToken.length||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0},e.prototype.notifyLocalViewChanges=function(e){for(var t=this,n=0,r=e;n<r.length;n++){var i=r[n],o=i.targetId;if(this.localViewReferences.addReferences(i.addedKeys,o),this.localViewReferences.removeReferences(i.removedKeys,o),!i.fromCache){var a=this.queryDataByTarget.get(o);g(null!==a,"Can't set limbo-free snapshot version for unknown target: "+o);var s=a.withLastLimboFreeSnapshotVersion(a.snapshotVersion);this.queryDataByTarget=this.queryDataByTarget.insert(o,s)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite-idempotent",function(n){return ze.forEach(e,function(e){return ze.forEach(e.removedKeys,function(e){return t.persistence.referenceDelegate.removeReference(n,e)})})})},e.prototype.nextMutationBatch=function(e){var t=this;return this.persistence.runTransaction("Get next mutation batch","readonly-idempotent",function(n){return void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)})},e.prototype.readDocument=function(e){var t=this;return this.persistence.runTransaction("read document","readonly-idempotent",function(n){return t.localDocuments.getDocument(n,e)})},e.prototype.allocateQuery=function(e){var t=this;return this.persistence.runTransaction("Allocate query","readwrite-idempotent",function(n){var r;return t.queryCache.getQueryData(n,e).next(function(i){return i?ze.resolve(r=i):t.queryCache.allocateTargetId(n).next(function(i){return r=new Sn(e,i,kn.Listen,n.currentSequenceNumber),t.queryCache.addQueryData(n,r).next(function(){return r})})})}).then(function(n){return g(null===t.queryDataByTarget.get(n.targetId),"Tried to allocate an already allocated query: "+e),t.queryDataByTarget=t.queryDataByTarget.insert(n.targetId,n),t.targetIdByQuery.set(e,n.targetId),n})},e.prototype.getQueryData=function(e,t){var n=this.targetIdByQuery.get(t);return void 0!==n?ze.resolve(this.queryDataByTarget.get(n)):this.queryCache.getQueryData(e,t)},e.prototype.releaseQuery=function(e,t){var n,r=this;return this.persistence.runTransaction("Release query",t?"readwrite-idempotent":"readwrite-primary-idempotent",function(i){var o=r.targetIdByQuery.get(e);g(void 0!==o,"Tried to release nonexistent query: "+e);var a=r.queryDataByTarget.get(n=o),s=r.localViewReferences.removeReferencesForId(n);return t?ze.resolve():ze.forEach(s,function(e){return r.persistence.referenceDelegate.removeReference(i,e)}).next(function(){r.persistence.referenceDelegate.removeTarget(i,a)})}).then(function(){r.queryDataByTarget=r.queryDataByTarget.remove(n),r.targetIdByQuery.delete(e)})},e.prototype.executeQuery=function(e,t){var n=this,r=ke.MIN,i=Fe();return this.persistence.runTransaction("Execute query","readonly-idempotent",function(o){return n.getQueryData(o,e).next(function(e){if(e)return r=e.lastLimboFreeSnapshotVersion,n.queryCache.getMatchingKeysForTargetId(o,e.targetId).next(function(e){i=e})}).next(function(){return n.queryEngine.getDocumentsMatchingQuery(o,e,t?r:ke.MIN,t?i:Fe())}).next(function(e){return{documents:e,remoteKeys:i}})})},e.prototype.remoteDocumentKeys=function(e){var t=this;return this.persistence.runTransaction("Remote document keys","readonly-idempotent",function(n){return t.queryCache.getMatchingKeysForTargetId(n,e)})},e.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},e.prototype.removeCachedMutationBatchMetadata=function(e){this.mutationQueue.removeCachedMutationKeys(e)},e.prototype.setNetworkEnabled=function(e){this.persistence.setNetworkEnabled(e)},e.prototype.applyWriteToRemoteDocuments=function(e,t,n){var r=this,i=t.batch,o=i.keys(),a=ze.resolve();return o.forEach(function(r){a=a.next(function(){return n.getEntry(e,r)}).next(function(e){var o=e,a=t.docVersions.get(r);g(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(r,o,t))?n.addEntry(o,t.commitVersion):g(!e,"Mutation batch "+i+" applied to document "+e+" resulted in null"))})}),a.next(function(){return r.mutationQueue.removeMutationBatch(e,i)})},e.prototype.collectGarbage=function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary-idempotent",function(n){return e.collect(n,t.queryDataByTarget)})},e.prototype.getQueryForTarget=function(e){var t=this,n=this.queryDataByTarget.get(e);return n?Promise.resolve(n.query):this.persistence.runTransaction("Get query data","readonly-idempotent",function(n){return t.queryCache.getQueryDataForTarget(n,e).next(function(e){return e?e.query:null})})},e.prototype.getNewDocumentChanges=function(){var e=this;return this.persistence.runTransaction("Get new document changes","readonly-idempotent",function(t){return e.remoteDocuments.getNewDocumentChanges(t,e.lastDocumentChangeReadTime)}).then(function(t){var n=t.changedDocs;return e.lastDocumentChangeReadTime=t.readTime,n})},e.prototype.synchronizeLastDocumentChangeReadTime=function(){return o.__awaiter(this,void 0,void 0,function(){var e,t=this;return o.__generator(this,function(n){return this.remoteDocuments instanceof Gt?(e=this.remoteDocuments,[2,this.persistence.runTransaction("Synchronize last document change read time","readonly-idempotent",function(t){return e.getLastDocumentChange(t)}).then(function(e){t.lastDocumentChangeReadTime=e.readTime})]):[2]})})},e.RESUME_TOKEN_MAX_AGE_MICROS=3e8,e}(),Gn=function(){function e(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=b(),this.batchesByDocumentKey=new Ae(Hn.compareByKey)}return e.prototype.checkEmpty=function(e){return ze.resolve(0===this.mutationQueue.length)},e.prototype.acknowledgeBatch=function(e,t,n){var r=t.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");g(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return g(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,ze.resolve()},e.prototype.getLastStreamToken=function(e){return ze.resolve(this.lastStreamToken)},e.prototype.setLastStreamToken=function(e,t){return this.lastStreamToken=t,ze.resolve()},e.prototype.addMutationBatch=function(e,t,n,r){g(0!==r.length,"Mutation batches should not be empty");var i=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&g(this.mutationQueue[this.mutationQueue.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new Be(i,t,n,r);this.mutationQueue.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Hn(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}return ze.resolve(o)},e.prototype.lookupMutationBatch=function(e,t){return ze.resolve(this.findMutationBatch(t))},e.prototype.lookupMutationKeys=function(e,t){var n=this.findMutationBatch(t);return g(null!=n,"Failed to find local mutation batch."),ze.resolve(n.keys())},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this.indexOfBatchId(t+1),r=n<0?0:n;return ze.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)},e.prototype.getHighestUnacknowledgedBatchId=function(){return ze.resolve(0===this.mutationQueue.length?-1:this.nextBatchId-1)},e.prototype.getAllMutationBatches=function(e){return ze.resolve(this.mutationQueue.slice())},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=new Hn(t,0),i=new Hn(t,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(e){g(t.isEqual(e.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(e.targetOrBatchId);g(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),ze.resolve(o)},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new Ae(K);return t.forEach(function(e){var t=new Hn(e,0),i=new Hn(e,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([t,i],function(t){g(e.isEqual(t.key),"For each key, should only iterate over a single key's batches"),r=r.add(t.targetOrBatchId)})}),ze.resolve(this.findMutationBatches(r))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){g(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=t.path,r=n.length+1,i=n;ce.isDocumentKey(i)||(i=i.child(""));var o=new Hn(new ce(i),0),a=new Ae(K);return this.batchesByDocumentKey.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.targetOrBatchId)),!0)},o),ze.resolve(this.findMutationBatches(a))},e.prototype.findMutationBatches=function(e){var t=this,n=[];return e.forEach(function(e){var r=t.findMutationBatch(e);null!==r&&n.push(r)}),n},e.prototype.removeMutationBatch=function(e,t){var n=this;g(0===this.indexOfExistingBatchId(t.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return ze.forEach(t.mutations,function(i){var o=new Hn(i.key,t.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(e,i.key)}).next(function(){n.batchesByDocumentKey=r})},e.prototype.removeCachedMutationKeys=function(e){},e.prototype.containsKey=function(e,t){var n=new Hn(t,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return ze.resolve(t.isEqual(r&&r.key))},e.prototype.performConsistencyCheck=function(e){return 0===this.mutationQueue.length&&g(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),ze.resolve()},e.prototype.indexOfExistingBatchId=function(e,t){var n=this.indexOfBatchId(e);return g(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+t),n},e.prototype.indexOfBatchId=function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId},e.prototype.findMutationBatch=function(e){var t=this.indexOfBatchId(e);if(t<0||t>=this.mutationQueue.length)return null;var n=this.mutationQueue[t];return g(n.batchId===e,"If found batch must match"),n},e}(),Kn=function(){function e(e){this.persistence=e,this.queries=new Ht(function(e){return e.canonicalId()}),this.lastRemoteSnapshotVersion=ke.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Qn,this.targetCount=0,this.targetIdGenerator=$e.forQueryCache()}return e.prototype.getTargetCount=function(e){return ze.resolve(this.targetCount)},e.prototype.forEachTarget=function(e,t){return this.queries.forEach(function(e,n){return t(n)}),ze.resolve()},e.prototype.getLastRemoteSnapshotVersion=function(e){return ze.resolve(this.lastRemoteSnapshotVersion)},e.prototype.getHighestSequenceNumber=function(e){return ze.resolve(this.highestSequenceNumber)},e.prototype.allocateTargetId=function(e){var t=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=t,ze.resolve(t)},e.prototype.setTargetsMetadata=function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),ze.resolve()},e.prototype.saveQueryData=function(e){this.queries.set(e.query,e);var t=e.targetId;t>this.highestTargetId&&(this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)},e.prototype.addQueryData=function(e,t){return g(!this.queries.has(t.query),"Adding a query that already exists"),this.saveQueryData(t),this.targetCount+=1,ze.resolve()},e.prototype.updateQueryData=function(e,t){return g(this.queries.has(t.query),"Updating a non-existent query"),this.saveQueryData(t),ze.resolve()},e.prototype.removeQueryData=function(e,t){return g(this.targetCount>0,"Removing a target from an empty cache"),g(this.queries.has(t.query),"Removing a non-existent target from the cache"),this.queries.delete(t.query),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,ze.resolve()},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return this.queries.forEach(function(a,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.queries.delete(a),o.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),ze.waitFor(o).next(function(){return i})},e.prototype.getQueryCount=function(e){return ze.resolve(this.targetCount)},e.prototype.getQueryData=function(e,t){var n=this.queries.get(t)||null;return ze.resolve(n)},e.prototype.getQueryDataForTarget=function(e,t){return m("Not yet implemented.")},e.prototype.addMatchingKeys=function(e,t,n){this.references.addReferences(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.addReference(e,t))}),ze.waitFor(i)},e.prototype.removeMatchingKeys=function(e,t,n){this.references.removeReferences(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.removeReference(e,t))}),ze.waitFor(i)},e.prototype.removeMatchingKeysForTargetId=function(e,t){return this.references.removeReferencesForId(t),ze.resolve()},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=this.references.referencesForId(t);return ze.resolve(n)},e.prototype.containsKey=function(e,t){return ze.resolve(this.references.containsKey(t))},e}(),Yn=function(){function e(e,t){this.indexManager=e,this.sizer=t,this.docs=new Se(ce.comparator),this.size=0}return e.prototype.addEntry=function(e,t,n){g(!n.isEqual(ke.MIN),"Cannot add a document with a read time of zero");var r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.sizer(t);return this.docs=this.docs.insert(r,{maybeDocument:t,size:a,readTime:n}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())},e.prototype.removeEntry=function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)},e.prototype.getEntry=function(e,t){var n=this.docs.get(t);return ze.resolve(n?n.maybeDocument:null)},e.prototype.getEntries=function(e,t){var n=this,r=xe();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.maybeDocument:null)}),ze.resolve(r)},e.prototype.getDocumentsMatchingQuery=function(e,t,n){g(!t.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var r=Pe(),i=new ce(t.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.value,u=s.maybeDocument,c=s.readTime;if(!t.path.isPrefixOf(a.key.path))break;c.compareTo(n)<=0||u instanceof jt&&t.matches(u)&&(r=r.insert(u.key,u))}return ze.resolve(r)},e.prototype.forEachDocumentKey=function(e,t){return ze.forEach(this.docs,function(e){return t(e)})},e.prototype.getNewDocumentChanges=function(e,t){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},e.prototype.newChangeBuffer=function(t){return new e.RemoteDocumentChangeBuffer(this)},e.prototype.getSize=function(e){return ze.resolve(this.size)},e.RemoteDocumentChangeBuffer=function(e){function t(t){var n=e.call(this)||this;return n.documentCache=t,n}return o.__extends(t,e),t.prototype.applyChanges=function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i?n.push(t.documentCache.addEntry(e,i,t.readTime)):t.documentCache.removeEntry(r)}),ze.waitFor(n)},t.prototype.getFromCache=function(e,t){return this.documentCache.getEntry(e,t)},t.prototype.getAllFromCache=function(e,t){return this.documentCache.getEntries(e,t)},t}(Wt),e}(),Zn=function(){function e(e,t){var n=this;this.clientId=e,this.mutationQueues={},this.listenSequence=new ie(0),this._started=!1,this._started=!0,this.referenceDelegate=t(this),this.queryCache=new Kn(this),this.indexManager=new Xt,this.remoteDocumentCache=new Yn(this.indexManager,function(e){return n.referenceDelegate.documentSize(e)})}return e.createLruPersistence=function(t,n,r){return new e(t,function(e){return new $n(e,new En(n),r)})},e.createEagerPersistence=function(t){return new e(t,function(e){return new Xn(e)})},e.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(e.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),e.prototype.getActiveClients=function(){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){return[2,[this.clientId]]})})},e.prototype.setPrimaryStateListener=function(e){return e(!0)},e.prototype.setDatabaseDeletedListener=function(){},e.prototype.setNetworkEnabled=function(e){},e.prototype.getIndexManager=function(){return this.indexManager},e.prototype.getMutationQueue=function(e){var t=this.mutationQueues[e.toKey()];return t||(t=new Gn(this.indexManager,this.referenceDelegate),this.mutationQueues[e.toKey()]=t),t},e.prototype.getQueryCache=function(){return this.queryCache},e.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},e.prototype.runTransaction=function(e,t,n){var r=this;p("MemoryPersistence","Starting transaction:",e);var i=new Jn(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next(function(e){return r.referenceDelegate.onTransactionCommitted(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})},e.prototype.mutationQueuesContainKey=function(e,t){return ze.or((n=this.mutationQueues,r=[],I(n,function(e,t){return r.push(t)}),r).map(function(n){return function(){return n.containsKey(e,t)}}));var n,r},e}(),Jn=function(e){function t(t){var n=e.call(this)||this;return n.currentSequenceNumber=t,n}return o.__extends(t,e),t}(xn),Xn=function(){function e(e){this.persistence=e,this.inMemoryPins=null,this._orphanedDocuments=null}return Object.defineProperty(e.prototype,"orphanedDocuments",{get:function(){if(this._orphanedDocuments)return this._orphanedDocuments;throw m("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.addReference=function(e,t){return this.orphanedDocuments.delete(t),ze.resolve()},e.prototype.removeReference=function(e,t){return this.orphanedDocuments.add(t),ze.resolve()},e.prototype.removeMutationReference=function(e,t){return this.orphanedDocuments.add(t),ze.resolve()},e.prototype.removeTarget=function(e,t){var n=this,r=this.persistence.getQueryCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.orphanedDocuments.add(e)})}).next(function(){return r.removeQueryData(e,t)})},e.prototype.onTransactionStarted=function(){this._orphanedDocuments=new Set},e.prototype.onTransactionCommitted=function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ze.forEach(this.orphanedDocuments,function(r){return t.isReferenced(e,r).next(function(e){e||n.removeEntry(r)})}).next(function(){return t._orphanedDocuments=null,n.apply(e)})},e.prototype.updateLimboDocument=function(e,t){var n=this;return this.isReferenced(e,t).next(function(e){e?n.orphanedDocuments.delete(t):n.orphanedDocuments.add(t)})},e.prototype.documentSize=function(e){return 0},e.prototype.isReferenced=function(e,t){var n=this;return ze.or([function(){return n.persistence.getQueryCache().containsKey(e,t)},function(){return n.persistence.mutationQueuesContainKey(e,t)},function(){return ze.resolve(n.inMemoryPins.containsKey(t))}])},e}(),$n=function(){function e(e,t,n){this.persistence=e,this.serializer=t,this.inMemoryPins=null,this.orphanedSequenceNumbers=new Ht(function(e){return ge(e.path)}),this.garbageCollector=new Rn(this,n)}return e.prototype.onTransactionStarted=function(){},e.prototype.onTransactionCommitted=function(e){return ze.resolve()},e.prototype.forEachTarget=function(e,t){return this.persistence.getQueryCache().forEachTarget(e,t)},e.prototype.getSequenceNumberCount=function(e){var t=this.orphanedDocumentCount(e);return this.persistence.getQueryCache().getTargetCount(e).next(function(e){return t.next(function(t){return e+t})})},e.prototype.orphanedDocumentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,function(e){t++}).next(function(){return t})},e.prototype.forEachOrphanedDocumentSequenceNumber=function(e,t){var n=this;return ze.forEach(this.orphanedSequenceNumbers,function(r,i){return n.isPinned(e,r,i).next(function(e){return e?ze.resolve():t(i)})})},e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.removeTargets=function(e,t,n){return this.persistence.getQueryCache().removeTargets(e,t,n)},e.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.forEachDocumentKey(e,function(i){return n.isPinned(e,i,t).next(function(e){e||(r++,o.removeEntry(i))})}).next(function(){return o.apply(e)}).next(function(){return r})},e.prototype.removeMutationReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),ze.resolve()},e.prototype.removeTarget=function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getQueryCache().updateQueryData(e,n)},e.prototype.addReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),ze.resolve()},e.prototype.removeReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),ze.resolve()},e.prototype.updateLimboDocument=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),ze.resolve()},e.prototype.documentSize=function(e){var t,n=this.serializer.toDbRemoteDocument(e,e.version);if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw m("Unknown remote document type");t=n.noDocument}return JSON.stringify(t).length},e.prototype.isPinned=function(e,t,n){var r=this;return ze.or([function(){return r.persistence.mutationQueuesContainKey(e,t)},function(){return ze.resolve(r.inMemoryPins.containsKey(t))},function(){return r.persistence.getQueryCache().containsKey(e,t)},function(){var e=r.orphanedSequenceNumbers.get(t);return ze.resolve(void 0!==e&&e>n)}])},e.prototype.getCacheSize=function(e){return this.persistence.getRemoteDocumentCache().getSize(e)},e}(),er=function(){function e(){}return e.prototype.setLocalDocumentsView=function(e){this.localDocumentsView=e},e.prototype.getDocumentsMatchingQuery=function(e,t,n,r){return g(void 0!==this.localDocumentsView,"setLocalDocumentsView() not called"),this.localDocumentsView.getDocumentsMatchingQuery(e,t,ke.MIN)},e}(),tr=Number,nr=tr.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),rr=tr.MAX_SAFE_INTEGER||Math.pow(2,53)-1,ir=tr.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function or(e){return null==e}function ar(e){return ir(e)&&e<=rr&&e>=nr}var sr=1e3,ur=1.5,cr=6e4,lr=function(){function e(e,t,n,r,i){void 0===n&&(n=sr),void 0===r&&(r=ur),void 0===i&&(i=cr),this.queue=e,this.timerId=t,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return e.prototype.reset=function(){this.currentBaseMs=0},e.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},e.prototype.backoffAndRun=function(e){var t=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);this.currentBaseMs>0&&p("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return t.lastAttemptTime=Date.now(),e()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},e.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},e.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},e}(),hr=function(e){return e[e.Initial=0]="Initial",e[e.Starting=1]="Starting",e[e.Open=2]="Open",e[e.Error=3]="Error",e[e.Backoff=4]="Backoff",e}({}),fr=function(){function e(e,t,n,r,i,o){this.queue=e,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=hr.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new lr(e,t)}return e.prototype.isStarted=function(){return this.state===hr.Starting||this.state===hr.Open||this.state===hr.Backoff},e.prototype.isOpen=function(){return this.state===hr.Open},e.prototype.start=function(){this.state!==hr.Error?(g(this.state===hr.Initial,"Already started"),this.auth()):this.performBackoff()},e.prototype.stop=function(){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return this.isStarted()?[4,this.close(hr.Initial)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.inhibitBackoff=function(){g(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=hr.Initial,this.backoff.reset()},e.prototype.markIdle=function(){var e=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return e.handleIdleCloseTimer()}))},e.prototype.sendRequest=function(e){this.cancelIdleCheck(),this.stream.send(e)},e.prototype.handleIdleCloseTimer=function(){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){return this.isOpen()?[2,this.close(hr.Initial)]:[2]})})},e.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},e.prototype.close=function(e,t){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(n){switch(n.label){case 0:return g(this.isStarted(),"Only started streams should be closed."),g(e===hr.Error||or(t),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,e!==hr.Error?this.backoff.reset():t&&t.code===w.RESOURCE_EXHAUSTED?(y(t.toString()),y("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===w.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.onClose(t)];case 1:return n.sent(),[2]}})})},e.prototype.tearDown=function(){},e.prototype.auth=function(){var e=this;g(this.state===hr.Initial,"Must be in initial state to auth"),this.state=hr.Starting;var t=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then(function(t){e.closeCount===n&&e.startStream(t)},function(n){t(function(){var t=new C(w.UNKNOWN,"Fetching auth token failed: "+n.message);return e.handleStreamClose(t)})})},e.prototype.startStream=function(e){var t=this;g(this.state===hr.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e),this.stream.onOpen(function(){n(function(){return g(t.state===hr.Starting,"Expected stream to be in state Starting, but was "+t.state),t.state=hr.Open,t.listener.onOpen()})}),this.stream.onClose(function(e){n(function(){return t.handleStreamClose(e)})}),this.stream.onMessage(function(e){n(function(){return t.onMessage(e)})})},e.prototype.performBackoff=function(){var e=this;g(this.state===hr.Error,"Should only perform backoff when in Error state"),this.state=hr.Backoff,this.backoff.backoffAndRun(function(){return o.__awaiter(e,void 0,void 0,function(){return o.__generator(this,function(e){return g(this.state===hr.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=hr.Initial,this.start(),g(this.isStarted(),"PersistentStream should have started"),[2]})})})},e.prototype.handleStreamClose=function(e){return g(this.isStarted(),"Can't handle server close on non-started stream"),p("PersistentStream","close with error: "+e),this.stream=null,this.close(hr.Error,e)},e.prototype.getCloseGuardedDispatcher=function(e){var t=this;return function(n){t.queue.enqueueAndForget(function(){return t.closeCount===e?n():(p("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},e}(),dr=function(e){function t(t,n,r,i,o){var a=e.call(this,t,he.ListenStreamConnectionBackoff,he.ListenStreamIdle,n,r,o)||this;return a.serializer=i,a}return o.__extends(t,e),t.prototype.startRpc=function(e){return this.connection.openStream("Listen",e)},t.prototype.onMessage=function(e){this.backoff.reset();var t=this.serializer.fromWatchChange(e),n=this.serializer.versionFromListenResponse(e);return this.listener.onWatchChange(t,n)},t.prototype.watch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.addTarget=this.serializer.toTarget(e);var n=this.serializer.toListenRequestLabels(e);n&&(t.labels=n),this.sendRequest(t)},t.prototype.unwatch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.removeTarget=e,this.sendRequest(t)},t}(fr),pr=function(e){function t(t,n,r,i,o){var a=e.call(this,t,he.WriteStreamConnectionBackoff,he.WriteStreamIdle,n,r,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a.lastStreamToken=b(),a}return o.__extends(t,e),Object.defineProperty(t.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.handshakeComplete_=!1,e.prototype.start.call(this)},t.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},t.prototype.startRpc=function(e){return this.connection.openStream("Write",e)},t.prototype.onMessage=function(e){if(g(!!e.streamToken,"Got a write response without a stream token"),this.lastStreamToken=e.streamToken,this.handshakeComplete_){this.backoff.reset();var t=this.serializer.fromWriteResults(e.writeResults,e.commitTime),n=this.serializer.fromVersion(e.commitTime);return this.listener.onMutationResult(n,t)}return g(!e.writeResults||0===e.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},t.prototype.writeHandshake=function(){g(this.isOpen(),"Writing handshake requires an opened stream"),g(!this.handshakeComplete_,"Handshake already completed");var e={};e.database=this.serializer.encodedDatabaseId,this.sendRequest(e)},t.prototype.writeMutations=function(e){var t=this;g(this.isOpen(),"Writing mutations requires an opened stream"),g(this.handshakeComplete_,"Handshake must be complete before writing mutations"),g(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:e.map(function(e){return t.serializer.toMutation(e)})};this.sendRequest(n)},t}(fr),yr=function(){function e(e,t,n,r){this.queue=e,this.connection=t,this.credentials=n,this.serializer=r}return e.prototype.newPersistentWriteStream=function(e){return new pr(this.queue,this.connection,this.credentials,this.serializer,e)},e.prototype.newPersistentWatchStream=function(e){return new dr(this.queue,this.connection,this.credentials,this.serializer,e)},e.prototype.commit=function(e){var t=this,n={database:this.serializer.encodedDatabaseId,writes:e.map(function(e){return t.serializer.toMutation(e)})};return this.invokeRPC("Commit",n).then(function(e){return t.serializer.fromWriteResults(e.writeResults,e.commitTime)})},e.prototype.lookup=function(e){var t=this,n={database:this.serializer.encodedDatabaseId,documents:e.map(function(e){return t.serializer.toName(e)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=Re();n.forEach(function(e){var n=t.serializer.fromMaybeDocument(e);r=r.insert(n.key,n)});var i=[];return e.forEach(function(e){var t=r.get(e);g(!!t,"Missing entity in write response for "+e),i.push(t)}),i})},e.prototype.invokeRPC=function(e,t){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeRPC(e,t,r)}).catch(function(e){throw e.code===w.UNAUTHENTICATED&&n.credentials.invalidateToken(),e})},e.prototype.invokeStreamingRPC=function(e,t){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeStreamingRPC(e,t,r)}).catch(function(e){throw e.code===w.UNAUTHENTICATED&&n.credentials.invalidateToken(),e})},e}(),vr=function(){function e(e){this.datastore=e,this.readVersions=Le(),this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e.prototype.lookup=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n=this;return o.__generator(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new C(w.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.datastore.lookup(e)];case 1:return(t=r.sent()).forEach(function(e){e instanceof zt||e instanceof jt?n.recordVersion(e):m("Document in a transaction was a "+e.constructor.name)}),[2,t]}})})},e.prototype.set=function(e,t){this.write(t.toMutations(e,this.precondition(e))),this.writtenDocs.add(e)},e.prototype.update=function(e,t){try{this.write(t.toMutations(e,this.preconditionForUpdate(e)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(e)},e.prototype.delete=function(e){this.write([new Ct(e,this.precondition(e))]),this.writtenDocs.add(e)},e.prototype.commit=function(){return o.__awaiter(this,void 0,void 0,function(){var e;return o.__generator(this,function(t){switch(t.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;if(e=this.readVersions,this.mutations.forEach(function(t){e=e.remove(t.key)}),!e.isEmpty())throw new C(w.INVALID_ARGUMENT,"Every document read in a transaction must also be written.");return[4,this.datastore.commit(this.mutations)];case 1:return t.sent(),this.committed=!0,[2]}})})},e.prototype.recordVersion=function(e){var t;if(e instanceof jt)t=e.version;else{if(!(e instanceof zt))throw m("Document in a transaction was a "+e.constructor.name);t=ke.forDeletedDoc()}var n=this.readVersions.get(e.key);if(null!==n){if(!t.isEqual(n))throw new C(w.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(e.key,t)},e.prototype.precondition=function(e){var t=this.readVersions.get(e);return!this.writtenDocs.has(e)&&t?mt.updateTime(t):mt.NONE},e.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e);if(!this.writtenDocs.has(e)&&t){if(t.isEqual(ke.forDeletedDoc()))throw new C(w.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return mt.updateTime(t)}return mt.exists(!0)},e.prototype.write=function(e){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(e)},e.prototype.ensureCommitNotCalled=function(){g(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},e}(),mr=function(e){return e[e.Unknown=0]="Unknown",e[e.Online=1]="Online",e[e.Offline=2]="Offline",e}({}),gr=function(e){return e[e.RemoteStore=0]="RemoteStore",e[e.SharedClientState=1]="SharedClientState",e}({}),_r=function(){function e(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state=mr.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return e.prototype.handleWatchStreamStart=function(){var e=this;0===this.watchStreamFailures&&(this.setAndBroadcast(mr.Unknown),g(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(he.OnlineStateTimeout,1e4,function(){return e.onlineStateTimer=null,g(e.state===mr.Unknown,"Timer should be canceled if we transitioned to a different state."),e.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),e.setAndBroadcast(mr.Offline),Promise.resolve()}))},e.prototype.handleWatchStreamFailure=function(e){this.state===mr.Online?(this.setAndBroadcast(mr.Unknown),g(0===this.watchStreamFailures,"watchStreamFailures must be 0"),g(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=1&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+e.toString()),this.setAndBroadcast(mr.Offline)))},e.prototype.set=function(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e===mr.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)},e.prototype.setAndBroadcast=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},e.prototype.logClientOfflineWarningIfNecessary=function(e){var t="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(y(t),this.shouldWarnClientIsOffline=!1):p("OnlineStateTracker",t)},e.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},e}(),br=function(e){return e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e}({});function wr(e){switch(e){case w.OK:return m("Treated status OK as error");case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0;default:return m("Unknown status code: "+e)}}function Cr(e){if(void 0===e)return y("GRPC error has no .code"),w.UNKNOWN;switch(e){case br.OK:return w.OK;case br.CANCELLED:return w.CANCELLED;case br.UNKNOWN:return w.UNKNOWN;case br.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case br.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case br.INTERNAL:return w.INTERNAL;case br.UNAVAILABLE:return w.UNAVAILABLE;case br.UNAUTHENTICATED:return w.UNAUTHENTICATED;case br.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case br.NOT_FOUND:return w.NOT_FOUND;case br.ALREADY_EXISTS:return w.ALREADY_EXISTS;case br.PERMISSION_DENIED:return w.PERMISSION_DENIED;case br.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case br.ABORTED:return w.ABORTED;case br.OUT_OF_RANGE:return w.OUT_OF_RANGE;case br.UNIMPLEMENTED:return w.UNIMPLEMENTED;case br.DATA_LOSS:return w.DATA_LOSS;default:return m("Unknown status code: "+e)}}function kr(e){if(void 0===e)return br.OK;switch(e){case w.OK:return br.OK;case w.CANCELLED:return br.CANCELLED;case w.UNKNOWN:return br.UNKNOWN;case w.DEADLINE_EXCEEDED:return br.DEADLINE_EXCEEDED;case w.RESOURCE_EXHAUSTED:return br.RESOURCE_EXHAUSTED;case w.INTERNAL:return br.INTERNAL;case w.UNAVAILABLE:return br.UNAVAILABLE;case w.UNAUTHENTICATED:return br.UNAUTHENTICATED;case w.INVALID_ARGUMENT:return br.INVALID_ARGUMENT;case w.NOT_FOUND:return br.NOT_FOUND;case w.ALREADY_EXISTS:return br.ALREADY_EXISTS;case w.PERMISSION_DENIED:return br.PERMISSION_DENIED;case w.FAILED_PRECONDITION:return br.FAILED_PRECONDITION;case w.ABORTED:return br.ABORTED;case w.OUT_OF_RANGE:return br.OUT_OF_RANGE;case w.UNIMPLEMENTED:return br.UNIMPLEMENTED;case w.DATA_LOSS:return br.DATA_LOSS;default:return m("Unknown status code: "+e)}}var Sr=function(){function e(e){this.comparator=e?function(t,n){return e(t,n)||ce.comparator(t.key,n.key)}:function(e,t){return ce.comparator(e.key,t.key)},this.keyedMap=Pe(),this.sortedSet=new Se(this.comparator)}return e.emptySet=function(t){return new e(t.comparator)},e.prototype.has=function(e){return null!=this.keyedMap.get(e)},e.prototype.get=function(e){return this.keyedMap.get(e)},e.prototype.first=function(){return this.sortedSet.minKey()},e.prototype.last=function(){return this.sortedSet.maxKey()},e.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},e.prototype.indexOf=function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})},e.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},e.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},e.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},e.prototype.copy=function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r},e}(),Er=function(e){return e[e.Added=0]="Added",e[e.Removed=1]="Removed",e[e.Modified=2]="Modified",e[e.Metadata=3]="Metadata",e}({}),Tr=function(e){return e[e.Local=0]="Local",e[e.Synced=1]="Synced",e}({}),Ir=function(){function e(){this.changeMap=new Se(ce.comparator)}return e.prototype.track=function(e){var t=e.doc.key,n=this.changeMap.get(t);n?e.type!==Er.Added&&n.type===Er.Metadata?this.changeMap=this.changeMap.insert(t,e):e.type===Er.Metadata&&n.type!==Er.Removed?this.changeMap=this.changeMap.insert(t,{type:n.type,doc:e.doc}):e.type===Er.Modified&&n.type===Er.Modified?this.changeMap=this.changeMap.insert(t,{type:Er.Modified,doc:e.doc}):e.type===Er.Modified&&n.type===Er.Added?this.changeMap=this.changeMap.insert(t,{type:Er.Added,doc:e.doc}):e.type===Er.Removed&&n.type===Er.Added?this.changeMap=this.changeMap.remove(t):e.type===Er.Removed&&n.type===Er.Modified?this.changeMap=this.changeMap.insert(t,{type:Er.Removed,doc:n.doc}):e.type===Er.Added&&n.type===Er.Removed?this.changeMap=this.changeMap.insert(t,{type:Er.Modified,doc:e.doc}):m("unsupported combination of changes: "+JSON.stringify(e)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(t,e)},e.prototype.getChanges=function(){var e=[];return this.changeMap.inorderTraversal(function(t,n){e.push(n)}),e},e}(),Ar=function(){function e(e,t,n,r,i,o,a,s){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return e.fromInitialDocuments=function(t,n,r,i){var o=[];return n.forEach(function(e){o.push({type:Er.Added,doc:e})}),new e(t,n,Sr.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&this.query.isEqual(e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},e}(),Dr=function(){function e(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return e.createSynthesizedRemoteEventForCurrentChange=function(t,n){var r,i=((r={})[t]=Nr.createSynthesizedTargetChangeForCurrentChange(t,n),r);return new e(ke.MIN,i,qe(),Re(),Fe())},e}(),Nr=function(){function e(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return e.createSynthesizedTargetChangeForCurrentChange=function(t,n){return new e(b(),n,Fe(),Fe(),Fe())},e}(),Rr=function(e,t,n,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=n,this.newDoc=r},xr=function(e,t){this.targetId=e,this.existenceFilter=t},Or=function(e){return e[e.NoChange=0]="NoChange",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Current=3]="Current",e[e.Reset=4]="Reset",e}({}),Pr=function(e,t,n,r){void 0===n&&(n=b()),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},Mr=function(){function e(){this.pendingResponses=0,this.documentChanges=Fr(),this._resumeToken=b(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(e.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),e.prototype.updateResumeToken=function(e){e.length>0&&(this._hasPendingChanges=!0,this._resumeToken=e)},e.prototype.toTargetChange=function(){var e=Fe(),t=Fe(),n=Fe();return this.documentChanges.forEach(function(r,i){switch(i){case Er.Added:e=e.add(r);break;case Er.Modified:t=t.add(r);break;case Er.Removed:n=n.add(r);break;default:m("Encountered invalid change type: "+i)}}),new Nr(this._resumeToken,this._current,e,t,n)},e.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=Fr()},e.prototype.addDocumentChange=function(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)},e.prototype.removeDocumentChange=function(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)},e.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},e.prototype.recordTargetResponse=function(){this.pendingResponses-=1},e.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},e}(),Lr=function(){function e(e){this.metadataProvider=e,this.targetStates={},this.pendingDocumentUpdates=Re(),this.pendingDocumentTargetMapping=Vr(),this.pendingTargetResets=new Ae(K)}return e.prototype.handleDocumentChange=function(e){for(var t=0,n=e.updatedTargetIds;t<n.length;t++){var r=n[t];e.newDoc instanceof jt?this.addDocumentToTarget(r,e.newDoc):e.newDoc instanceof zt&&this.removeDocumentFromTarget(r,e.key,e.newDoc)}for(var i=0,o=e.removedTargetIds;i<o.length;i++)this.removeDocumentFromTarget(r=o[i],e.key,e.newDoc)},e.prototype.handleTargetChange=function(e){var t=this;this.forEachTarget(e,function(n){var r=t.ensureTargetState(n);switch(e.state){case Or.NoChange:t.isActiveTarget(n)&&r.updateResumeToken(e.resumeToken);break;case Or.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(e.resumeToken);break;case Or.Removed:r.recordTargetResponse(),r.isPending||t.removeTarget(n),g(!e.cause,"WatchChangeAggregator does not handle errored targets");break;case Or.Current:t.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(e.resumeToken));break;case Or.Reset:t.isActiveTarget(n)&&(t.resetTarget(n),r.updateResumeToken(e.resumeToken));break;default:m("Unknown target watch change state: "+e.state)}})},e.prototype.forEachTarget=function(e,t){e.targetIds.length>0?e.targetIds.forEach(t):T(this.targetStates,t)},e.prototype.handleExistenceFilter=function(e){var t=e.targetId,n=e.existenceFilter.count,r=this.queryDataForActiveTarget(t);if(r){var i=r.query;if(i.isDocumentQuery())if(0===n){var o=new ce(i.path);this.removeDocumentFromTarget(t,o,new zt(o,ke.forDeletedDoc()))}else g(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(t)!==n&&(this.resetTarget(t),this.pendingTargetResets=this.pendingTargetResets.add(t))}},e.prototype.createRemoteEvent=function(e){var t=this,n={};T(this.targetStates,function(r,i){var o=t.queryDataForActiveTarget(r);if(o){if(i.current&&o.query.isDocumentQuery()){var a=new ce(o.query.path);null!==t.pendingDocumentUpdates.get(a)||t.targetContainsDocument(r,a)||t.removeDocumentFromTarget(r,a,new zt(a,e))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}});var r=Fe();this.pendingDocumentTargetMapping.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.queryDataForActiveTarget(e);return!n||n.purpose===kn.LimboResolution||(i=!1,!1)}),i&&(r=r.add(e))});var i=new Dr(e,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Re(),this.pendingDocumentTargetMapping=Vr(),this.pendingTargetResets=new Ae(K),i},e.prototype.addDocumentToTarget=function(e,t){if(this.isActiveTarget(e)){var n=this.targetContainsDocument(e,t.key)?Er.Modified:Er.Added;this.ensureTargetState(e).addDocumentChange(t.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}},e.prototype.removeDocumentFromTarget=function(e,t,n){if(this.isActiveTarget(e)){var r=this.ensureTargetState(e);this.targetContainsDocument(e,t)?r.addDocumentChange(t,Er.Removed):r.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,n))}},e.prototype.removeTarget=function(e){delete this.targetStates[e]},e.prototype.getCurrentDocumentCountForTarget=function(e){var t=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size},e.prototype.recordPendingTargetRequest=function(e){this.ensureTargetState(e).recordPendingTargetRequest()},e.prototype.ensureTargetState=function(e){return this.targetStates[e]||(this.targetStates[e]=new Mr),this.targetStates[e]},e.prototype.ensureDocumentTargetMapping=function(e){var t=this.pendingDocumentTargetMapping.get(e);return t||(t=new Ae(K),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t},e.prototype.isActiveTarget=function(e){var t=null!==this.queryDataForActiveTarget(e);return t||p("WatchChangeAggregator","Detected inactive target",e),t},e.prototype.queryDataForActiveTarget=function(e){var t=this.targetStates[e];return t&&t.isPending?null:this.metadataProvider.getQueryDataForTarget(e)},e.prototype.resetTarget=function(e){var t=this;g(!this.targetStates[e].isPending,"Should only reset active targets"),this.targetStates[e]=new Mr,this.metadataProvider.getRemoteKeysForTarget(e).forEach(function(n){t.removeDocumentFromTarget(e,n,null)})},e.prototype.targetContainsDocument=function(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)},e}();function Vr(){return new Se(ce.comparator)}function Fr(){return new Se(ce.comparator)}var Ur="RemoteStore",qr=function(){function e(e,t,n,r,i){var a=this;this.localStore=e,this.datastore=t,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback(function(e){n.enqueueAndForget(function(){return o.__awaiter(a,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return this.canUseNetwork()?(p(Ur,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})}),this.onlineStateTracker=new _r(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return e.prototype.start=function(){return this.enableNetwork()},e.prototype.enableNetwork=function(){return o.__awaiter(this,void 0,void 0,function(){var e;return o.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(e=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(mr.Unknown),[4,this.fillWritePipeline()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},e.prototype.disableNetwork=function(){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.onlineStateTracker.set(mr.Offline),[2]}})})},e.prototype.disableNetworkInternal=function(){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return[4,this.writeStream.stop()];case 1:return e.sent(),[4,this.watchStream.stop()];case 2:return e.sent(),this.writePipeline.length>0&&(p(Ur,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}})})},e.prototype.shutdown=function(){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return p(Ur,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(mr.Unknown),[2]}})})},e.prototype.listen=function(e){g(!S(this.listenTargets,e.targetId),"listen called with duplicate targetId!"),this.listenTargets[e.targetId]=e,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(e)},e.prototype.unlisten=function(e){g(S(this.listenTargets,e),"unlisten called without assigned target ID!"),delete this.listenTargets[e],this.watchStream.isOpen()&&this.sendUnwatchRequest(e),A(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(mr.Unknown))},e.prototype.getQueryDataForTarget=function(e){return this.listenTargets[e]||null},e.prototype.getRemoteKeysForTarget=function(e){return this.syncEngine.getRemoteKeysForTarget(e)},e.prototype.sendWatchRequest=function(e){this.watchChangeAggregator.recordPendingTargetRequest(e.targetId),this.watchStream.watch(e)},e.prototype.sendUnwatchRequest=function(e){this.watchChangeAggregator.recordPendingTargetRequest(e),this.watchStream.unwatch(e)},e.prototype.startWatchStream=function(){g(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new Lr(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},e.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!A(this.listenTargets)},e.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},e.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},e.prototype.onWatchStreamOpen=function(){return o.__awaiter(this,void 0,void 0,function(){var e=this;return o.__generator(this,function(t){return T(this.listenTargets,function(t,n){e.sendWatchRequest(n)}),[2]})})},e.prototype.onWatchStreamClose=function(e){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(t){return void 0===e&&g(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(e),this.startWatchStream()):this.onlineStateTracker.set(mr.Unknown),[2]})})},e.prototype.onWatchStreamChange=function(e,t){return o.__awaiter(this,void 0,void 0,function(){var n;return o.__generator(this,function(r){switch(r.label){case 0:return this.onlineStateTracker.set(mr.Online),e instanceof Pr&&e.state===Or.Removed&&e.cause?[2,this.handleTargetError(e)]:(e instanceof Rr?this.watchChangeAggregator.handleDocumentChange(e):e instanceof xr?this.watchChangeAggregator.handleExistenceFilter(e):(g(e instanceof Pr,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(e)),t.isEqual(ke.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),t.compareTo(n)>=0?[4,this.raiseWatchSnapshot(t)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.raiseWatchSnapshot=function(e){var t=this;g(!e.isEqual(ke.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(e);return T(n.targetChanges,function(n,r){if(r.resumeToken.length>0){var i=t.listenTargets[n];i&&(t.listenTargets[n]=i.withResumeToken(r.resumeToken,e))}}),n.targetMismatches.forEach(function(e){var n=t.listenTargets[e];if(n){t.listenTargets[e]=n.withResumeToken(b(),n.snapshotVersion),t.sendUnwatchRequest(e);var r=new Sn(n.query,e,kn.ExistenceFilterMismatch,n.sequenceNumber);t.sendWatchRequest(r)}}),this.syncEngine.applyRemoteEvent(n)},e.prototype.handleTargetError=function(e){var t=this;g(!!e.cause,"Handling target error without a cause");var n=e.cause,r=Promise.resolve();return e.targetIds.forEach(function(e){r=r.then(function(){return o.__awaiter(t,void 0,void 0,function(){return o.__generator(this,function(t){return S(this.listenTargets,e)?(delete this.listenTargets[e],this.watchChangeAggregator.removeTarget(e),[2,this.syncEngine.rejectListen(e,n)]):[2]})})})}),r},e.prototype.fillWritePipeline=function(){return o.__awaiter(this,void 0,void 0,function(){var e;return o.__generator(this,function(t){switch(t.label){case 0:return this.canAddToWritePipeline()?[4,this.localStore.nextMutationBatch(this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:-1)]:[3,4];case 1:return null!==(e=t.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:t.sent(),t.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}})})},e.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},e.prototype.outstandingWrites=function(){return this.writePipeline.length},e.prototype.addToWritePipeline=function(e){g(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(e),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(e.mutations)},e.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},e.prototype.startWriteStream=function(){g(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},e.prototype.onWriteStreamOpen=function(){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){return this.writeStream.writeHandshake(),[2]})})},e.prototype.onWriteHandshakeComplete=function(){var e=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var t=0,n=e.writePipeline;t<n.length;t++)e.writeStream.writeMutations(n[t].mutations)}).catch(Fn)},e.prototype.onMutationResult=function(e,t){var n=this;g(this.writePipeline.length>0,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=je.from(r,e,t,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},e.prototype.onWriteStreamClose=function(e){return o.__awaiter(this,void 0,void 0,function(){var t=this;return o.__generator(this,function(n){return void 0===e&&g(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),e&&this.writePipeline.length>0?[2,(this.writeStream.handshakeComplete?this.handleWriteError(e):this.handleHandshakeError(e)).then(function(){t.shouldStartWriteStream()&&t.startWriteStream()})]:[2]})})},e.prototype.handleHandshakeError=function(e){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(t){return wr(e.code)?(p(Ur,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=b(),[2,this.localStore.setLastStreamToken(b()).catch(Fn)]):[2]})})},e.prototype.handleWriteError=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n=this;return o.__generator(this,function(r){return wr(i=e.code)&&i!==w.ABORTED?(t=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(t.batchId,e).then(function(){return n.fillWritePipeline()})]):[2];var i})})},e.prototype.createTransaction=function(){return new vr(this.datastore)},e.prototype.restartNetwork=function(){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.onlineStateTracker.set(mr.Unknown),[4,this.enableNetwork()];case 2:return e.sent(),[2]}})})},e.prototype.handleCredentialChange=function(){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return this.canUseNetwork()?(p(Ur,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.applyPrimaryState=function(e){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return this.isPrimary=e,e&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,4];case 2:return e?[3,4]:[4,this.disableNetworkInternal()];case 3:t.sent(),this.onlineStateTracker.set(mr.Unknown),t.label=4;case 4:return[2]}})})},e}(),Br=function(){function e(e,t){if(N("GeoPoint",arguments,2),O("GeoPoint","number",1,e),O("GeoPoint","number",2,t),!isFinite(e)||e<-90||e>90)throw new C(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new C(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},e.prototype._compareTo=function(e){return K(this._lat,e._lat)||K(this._long,e._long)},e}(),jr=function(){function e(e,t,n,r,i,o,a){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return e.atPath=function(t){return new e(t)},Object.defineProperty(e.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var e=this.getInequalityFilterField(),t=this.getFirstOrderByField();if(null!==e&&null===t)this.memoizedOrderBy=e.isKeyField()?[ei]:[new $r(e),ei];else{g(null===e||null!==t&&e.isEqual(t),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}n||this.memoizedOrderBy.push((this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Jr.ASCENDING)===Jr.ASCENDING?ei:ti)}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),e.prototype.addFilter=function(t){g(null==this.getInequalityFilterField()||!(t instanceof Hr)||!t.isInequality()||t.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),g(!this.isDocumentQuery(),"No filtering allowed for document query");var n=this.filters.concat([t]);return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},e.prototype.addOrderBy=function(t){g(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([t]);return new e(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},e.prototype.withLimit=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),t,this.startAt,this.endAt)},e.prototype.withStartAt=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,t,this.endAt)},e.prototype.withEndAt=function(t){return new e(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,t)},e.prototype.asCollectionQueryAtPath=function(t){return new e(t,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,this.endAt)},e.prototype.matchesAllDocuments=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.explicitOrderBy.length||1===this.explicitOrderBy.length&&this.explicitOrderBy[0].field.isKeyField())},e.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var e=this.path.canonicalString();this.isCollectionGroupQuery()&&(e+="|cg:"+this.collectionGroup),e+="|f:";for(var t=0,n=this.filters;t<n.length;t++)e+=n[t].canonicalId(),e+=",";e+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++)e+=i[r].canonicalId(),e+=",";or(this.limit)||(e+="|l:",e+=this.limit),this.startAt&&(e+="|lb:",e+=this.startAt.canonicalId()),this.endAt&&(e+="|ub:",e+=this.endAt.canonicalId()),this.memoizedCanonicalId=e}return this.memoizedCanonicalId},e.prototype.toString=function(){var e="Query("+this.path.canonicalString();return this.isCollectionGroupQuery()&&(e+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(e+=", filters: ["+this.filters.join(", ")+"]"),or(this.limit)||(e+=", limit: "+this.limit),this.explicitOrderBy.length>0&&(e+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(e+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(e+=", endAt: "+this.endAt.canonicalId()),e+")"},e.prototype.isEqual=function(e){if(this.limit!==e.limit)return!1;if(this.orderBy.length!==e.orderBy.length)return!1;for(var t=0;t<this.orderBy.length;t++)if(!this.orderBy[t].isEqual(e.orderBy[t]))return!1;if(this.filters.length!==e.filters.length)return!1;for(t=0;t<this.filters.length;t++)if(!this.filters[t].isEqual(e.filters[t]))return!1;return this.collectionGroup===e.collectionGroup&&!!this.path.isEqual(e.path)&&!(null!==this.startAt?!this.startAt.isEqual(e.startAt):null!==e.startAt)&&(null!==this.endAt?this.endAt.isEqual(e.endAt):null===e.endAt)},e.prototype.docComparator=function(e,t){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(e,t);if(0!==a)return a;n=n||o.field.isKeyField()}return g(n,"orderBy used that doesn't compare on key field"),0},e.prototype.matches=function(e){return this.matchesPathAndCollectionGroup(e)&&this.matchesOrderBy(e)&&this.matchesFilters(e)&&this.matchesBounds(e)},e.prototype.hasLimit=function(){return!or(this.limit)},e.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},e.prototype.getInequalityFilterField=function(){for(var e=0,t=this.filters;e<t.length;e++){var n=t[e];if(n instanceof Hr&&n.isInequality())return n.field}return null},e.prototype.findFilterOperator=function(e){for(var t=0,n=this.filters;t<n.length;t++){var r=n[t];if(r instanceof Hr&&e.indexOf(r.op)>=0)return r.op}return null},e.prototype.isDocumentQuery=function(){return ce.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},e.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},e.prototype.matchesPathAndCollectionGroup=function(e){var t=e.key.path;return null!==this.collectionGroup?e.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(t):ce.isDocumentKey(this.path)?this.path.isEqual(t):this.path.isImmediateParentOf(t)},e.prototype.matchesOrderBy=function(e){for(var t=0,n=this.explicitOrderBy;t<n.length;t++){var r=n[t];if(!r.field.isKeyField()&&null===e.field(r.field))return!1}return!0},e.prototype.matchesFilters=function(e){for(var t=0,n=this.filters;t<n.length;t++)if(!n[t].matches(e))return!1;return!0},e.prototype.matchesBounds=function(e){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,e)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,e))},e.prototype.assertValidBound=function(e){g(e.position.length<=this.orderBy.length,"Bound is longer than orderBy")},e}(),zr=function(){},Qr=function(){function e(e){this.name=e}return e.fromString=function(t){switch(t){case"<":return e.LESS_THAN;case"<=":return e.LESS_THAN_OR_EQUAL;case"==":return e.EQUAL;case">=":return e.GREATER_THAN_OR_EQUAL;case">":return e.GREATER_THAN;case"array-contains":return e.ARRAY_CONTAINS;case"in":return e.IN;case"array-contains-any":return e.ARRAY_CONTAINS_ANY;default:return m("Unknown FieldFilter operator: "+t)}},e.prototype.toString=function(){return this.name},e.prototype.isEqual=function(e){return this.name===e.name},e.LESS_THAN=new e("<"),e.LESS_THAN_OR_EQUAL=new e("<="),e.EQUAL=new e("=="),e.GREATER_THAN=new e(">"),e.GREATER_THAN_OR_EQUAL=new e(">="),e.ARRAY_CONTAINS=new e("array-contains"),e.IN=new e("in"),e.ARRAY_CONTAINS_ANY=new e("array-contains-any"),e}(),Hr=function(e){function t(t,n,r){var i=e.call(this)||this;return i.field=t,i.op=n,i.value=r,i}return o.__extends(t,e),t.create=function(e,n,r){if(e.isKeyField())return n===Qr.IN?(g(r instanceof qt,"Comparing on key with IN, but filter value not an ArrayValue"),g(r.internalValue.every(function(e){return e instanceof Vt}),"Comparing on key with IN, but an array value was not a RefValue"),new Gr(e,r)):(g(r instanceof Vt,"Comparing on key, but filter value not a RefValue"),g(n!==Qr.ARRAY_CONTAINS&&n!==Qr.ARRAY_CONTAINS_ANY,"'"+n.toString()+"' queries don't make sense on document keys."),new Wr(e,n,r));if(r.isEqual(It.INSTANCE)){if(n!==Qr.EQUAL)throw new C(w.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new t(e,n,r)}if(r.isEqual(xt.NAN)){if(n!==Qr.EQUAL)throw new C(w.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new t(e,n,r)}return n===Qr.ARRAY_CONTAINS?new Kr(e,r):n===Qr.IN?(g(r instanceof qt,"IN filter has invalid value: "+r.toString()),new Yr(e,r)):n===Qr.ARRAY_CONTAINS_ANY?(g(r instanceof qt,"ARRAY_CONTAINS_ANY filter has invalid value: "+r.toString()),new Zr(e,r)):new t(e,n,r)},t.prototype.matches=function(e){var t=e.field(this.field);return null!==t&&this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},t.prototype.matchesComparison=function(e){switch(this.op){case Qr.LESS_THAN:return e<0;case Qr.LESS_THAN_OR_EQUAL:return e<=0;case Qr.EQUAL:return 0===e;case Qr.GREATER_THAN:return e>0;case Qr.GREATER_THAN_OR_EQUAL:return e>=0;default:return m("Unknown FieldFilter operator: "+this.op)}},t.prototype.isInequality=function(){return[Qr.LESS_THAN,Qr.LESS_THAN_OR_EQUAL,Qr.GREATER_THAN,Qr.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},t.prototype.isEqual=function(e){return e instanceof t&&this.op.isEqual(e.op)&&this.field.isEqual(e.field)&&this.value.isEqual(e.value)},t.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},t}(zr),Wr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.matches=function(e){var t=ce.comparator(e.key,this.value.key);return this.matchesComparison(t)},t}(Hr),Gr=function(e){function t(t,n){var r=e.call(this,t,Qr.IN,n)||this;return r.value=n,r}return o.__extends(t,e),t.prototype.matches=function(e){return this.value.internalValue.some(function(t){return e.key.isEqual(t.key)})},t}(Hr),Kr=function(e){function t(t,n){return e.call(this,t,Qr.ARRAY_CONTAINS,n)||this}return o.__extends(t,e),t.prototype.matches=function(e){var t=e.field(this.field);return t instanceof qt&&t.contains(this.value)},t}(Hr),Yr=function(e){function t(t,n){var r=e.call(this,t,Qr.IN,n)||this;return r.value=n,r}return o.__extends(t,e),t.prototype.matches=function(e){var t=this.value,n=e.field(this.field);return null!==n&&t.contains(n)},t}(Hr),Zr=function(e){function t(t,n){var r=e.call(this,t,Qr.ARRAY_CONTAINS_ANY,n)||this;return r.value=n,r}return o.__extends(t,e),t.prototype.matches=function(e){var t=this,n=e.field(this.field);return n instanceof qt&&n.internalValue.some(function(e){return t.value.contains(e)})},t}(Hr),Jr=function(){function e(e){this.name=e}return e.prototype.toString=function(){return this.name},e.ASCENDING=new e("asc"),e.DESCENDING=new e("desc"),e}(),Xr=function(){function e(e,t){this.position=e,this.before=t}return e.prototype.canonicalId=function(){for(var e=this.before?"b:":"a:",t=0,n=this.position;t<n.length;t++)e+=n[t].toString();return e},e.prototype.sortsBeforeDocument=function(e,t){g(this.position.length<=e.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=e[r],o=this.position[r];if(i.field.isKeyField())g(o instanceof Vt,"Bound has a non-key value where the key path is being used."),n=ce.comparator(o.key,t.key);else{var a=t.field(i.field);g(null!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===Jr.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},e.prototype.isEqual=function(e){if(null===e)return!1;if(this.before!==e.before||this.position.length!==e.position.length)return!1;for(var t=0;t<this.position.length;t++)if(!this.position[t].isEqual(e.position[t]))return!1;return!0},e}(),$r=function(){function e(e,t){this.field=e,void 0===t&&(t=Jr.ASCENDING),this.dir=t,this.isKeyOrderBy=e.isKeyField()}return e.prototype.compare=function(e,t){var n=this.isKeyOrderBy?jt.compareByKey(e,t):jt.compareByField(this.field,e,t);switch(this.dir){case Jr.ASCENDING:return n;case Jr.DESCENDING:return-1*n;default:return m("Unknown direction: "+this.dir)}},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},e.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},e.prototype.isEqual=function(e){return this.dir===e.dir&&this.field.isEqual(e.field)},e}(),ei=new $r(ue.keyField(),Jr.ASCENDING),ti=new $r(ue.keyField(),Jr.DESCENDING),ni=function(){function e(){}return e.prototype.applyToLocalView=function(e,t){return new Mt(t,e)},e.prototype.applyToRemoteDocument=function(e,t){return t},e.prototype.computeBaseValue=function(e){return null},e.prototype.isEqual=function(t){return t instanceof e},e.instance=new e,e}(),ri=function(){function e(e){this.elements=e}return e.prototype.applyToLocalView=function(e,t){return this.apply(e)},e.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},e.prototype.apply=function(e){for(var t=ai(e),n=function(e){t.find(function(t){return t.isEqual(e)})||t.push(e)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new qt(t)},e.prototype.computeBaseValue=function(e){return null},e.prototype.isEqual=function(t){return t instanceof e&&Y(t.elements,this.elements)},e}(),ii=function(){function e(e){this.elements=e}return e.prototype.applyToLocalView=function(e,t){return this.apply(e)},e.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},e.prototype.apply=function(e){for(var t=ai(e),n=function(e){t=t.filter(function(t){return!t.isEqual(e)})},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new qt(t)},e.prototype.computeBaseValue=function(e){return null},e.prototype.isEqual=function(t){return t instanceof e&&Y(t.elements,this.elements)},e}(),oi=function(){function e(e){this.operand=e}return e.prototype.applyToLocalView=function(e,t){var n=this.computeBaseValue(e);return n instanceof Rt&&this.operand instanceof Rt?new Rt(n.internalValue+this.operand.internalValue):new xt(n.internalValue+this.operand.internalValue)},e.prototype.applyToRemoteDocument=function(e,t){return g(null!==t,"Didn't receive transformResult for NUMERIC_ADD transform"),t},e.prototype.computeBaseValue=function(e){return e instanceof Dt?e:new Rt(0)},e.prototype.isEqual=function(t){return t instanceof e&&this.operand.isEqual(t.operand)},e}();function ai(e){return e instanceof qt?e.internalValue.slice():[]}var si,ui,ci=function(){function e(e){this.count=e}return e.prototype.isEqual=function(e){return e&&e.count===this.count},e}(),li=((si={})[Jr.ASCENDING.name]="ASCENDING",si[Jr.DESCENDING.name]="DESCENDING",si),hi=((ui={})[Qr.LESS_THAN.name]="LESS_THAN",ui[Qr.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",ui[Qr.GREATER_THAN.name]="GREATER_THAN",ui[Qr.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",ui[Qr.EQUAL.name]="EQUAL",ui[Qr.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",ui[Qr.IN.name]="IN",ui[Qr.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",ui),fi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function di(e,t){g(!or(e),t+" is missing")}function pi(e){return"number"==typeof e?e:"string"==typeof e?Number(e):m("can't parse "+e)}var yi=function(){function e(e,t){this.databaseId=e,this.options=t}return e.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},e.prototype.unsafeCastProtoByteString=function(e){return e},e.prototype.fromRpcStatus=function(e){var t=void 0===e.code?w.UNKNOWN:Cr(e.code);return new C(t,e.message||"")},e.prototype.toInt32Value=function(e){return this.options.useProto3Json||or(e)?e:{value:e}},e.prototype.fromInt32Value=function(e){var t;return or(t="object"==typeof e?e.value:e)?null:t},e.prototype.toTimestamp=function(e){return this.options.useProto3Json?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}},e.prototype.fromTimestamp=function(e){if("string"==typeof e)return this.fromIso8601String(e);g(!!e,"Cannot deserialize null or undefined timestamp.");var t=pi(e.seconds||"0");return new Ce(t,e.nanos||0)},e.prototype.fromIso8601String=function(e){var t=0,n=fi.exec(e);if(g(!!n,"invalid timestamp: "+e),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e),o=Math.floor(i.getTime()/1e3);return new Ce(o,t)},e.prototype.toBytes=function(e){return this.options.useProto3Json?e.toBase64():this.unsafeCastProtoByteString(e.toUint8Array())},e.prototype.fromBlob=function(e){return"string"==typeof e?(g(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),$.fromBase64String(e)):(g(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),$.fromUint8Array(e))},e.prototype.toVersion=function(e){return this.toTimestamp(e.toTimestamp())},e.prototype.fromVersion=function(e){return g(!!e,"Trying to deserialize version that isn't set"),ke.fromTimestamp(this.fromTimestamp(e))},e.prototype.toResourceName=function(e,t){return this.fullyQualifiedPrefixPath(e).child("documents").child(t).canonicalString()},e.prototype.fromResourceName=function(e){var t=ae.fromString(e);return g(this.isValidResourceName(t),"Tried to deserialize invalid key "+t.toString()),t},e.prototype.toName=function(e){return this.toResourceName(this.databaseId,e.path)},e.prototype.fromName=function(e){var t=this.fromResourceName(e);return g(t.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+t.get(1)+" vs "+this.databaseId.projectId),g(!t.get(3)&&!this.databaseId.database||t.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+t.get(3)+" vs "+this.databaseId.database),new ce(this.extractLocalPathFromResourceName(t))},e.prototype.toQueryPath=function(e){return this.toResourceName(this.databaseId,e)},e.prototype.fromQueryPath=function(e){var t=this.fromResourceName(e);return 4===t.length?ae.EMPTY_PATH:this.extractLocalPathFromResourceName(t)},Object.defineProperty(e.prototype,"encodedDatabaseId",{get:function(){return new ae(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),e.prototype.fullyQualifiedPrefixPath=function(e){return new ae(["projects",e.projectId,"databases",e.database])},e.prototype.extractLocalPathFromResourceName=function(e){return g(e.length>4&&"documents"===e.get(4),"tried to deserialize invalid key "+e.toString()),e.popFirst(5)},e.prototype.isValidResourceName=function(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)},e.prototype.toValue=function(e){if(e instanceof It)return{nullValue:"NULL_VALUE"};if(e instanceof At)return{booleanValue:e.value()};if(e instanceof Rt)return{integerValue:""+e.value()};if(e instanceof xt){var t=e.value();if(this.options.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:e.value()}}return e instanceof Ot?{stringValue:e.value()}:e instanceof Ut?{mapValue:this.toMapValue(e)}:e instanceof qt?{arrayValue:this.toArrayValue(e)}:e instanceof Pt?{timestampValue:this.toTimestamp(e.internalValue)}:e instanceof Ft?{geoPointValue:{latitude:e.value().latitude,longitude:e.value().longitude}}:e instanceof Lt?{bytesValue:this.toBytes(e.value())}:e instanceof Vt?{referenceValue:this.toResourceName(e.databaseId,e.key.path)}:m("Unknown FieldValue "+JSON.stringify(e))},e.prototype.fromValue=function(e){var t=this;if("nullValue"in e)return It.INSTANCE;if("booleanValue"in e)return At.of(e.booleanValue);if("integerValue"in e)return new Rt(pi(e.integerValue));if("doubleValue"in e){if(this.options.useProto3Json){if("NaN"===e.doubleValue)return xt.NAN;if("Infinity"===e.doubleValue)return xt.POSITIVE_INFINITY;if("-Infinity"===e.doubleValue)return xt.NEGATIVE_INFINITY}return new xt(e.doubleValue)}if("stringValue"in e)return new Ot(e.stringValue);if("mapValue"in e)return this.fromFields(e.mapValue.fields||{});if("arrayValue"in e)return di(e.arrayValue,"arrayValue"),new qt((e.arrayValue.values||[]).map(function(e){return t.fromValue(e)}));if("timestampValue"in e)return di(e.timestampValue,"timestampValue"),new Pt(this.fromTimestamp(e.timestampValue));if("geoPointValue"in e)return di(e.geoPointValue,"geoPointValue"),new Ft(new Br(e.geoPointValue.latitude||0,e.geoPointValue.longitude||0));if("bytesValue"in e){di(e.bytesValue,"bytesValue");var n=this.fromBlob(e.bytesValue);return new Lt(n)}if("referenceValue"in e){di(e.referenceValue,"referenceValue");var r=this.fromResourceName(e.referenceValue),i=new re(r.get(1),r.get(3)),o=new ce(this.extractLocalPathFromResourceName(r));return new Vt(i,o)}return m("Unknown Value proto "+JSON.stringify(e))},e.prototype.toMutationDocument=function(e,t){return{name:this.toName(e),fields:this.toFields(t)}},e.prototype.toDocument=function(e){return g(!e.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(e.key),fields:this.toFields(e.data()),updateTime:this.toTimestamp(e.version.toTimestamp())}},e.prototype.fromDocument=function(e,t){var n=this,r=this.fromName(e.name),i=this.fromVersion(e.updateTime);return new jt(r,i,{hasCommittedMutations:!!t},void 0,e,function(e){return n.fromValue(e)})},e.prototype.toFields=function(e){var t=this,n={};return e.forEach(function(e,r){n[e]=t.toValue(r)}),n},e.prototype.fromFields=function(e){var t=this,n=Ut.EMPTY;return I(e,function(e,r){n=n.set(new ue([e]),t.fromValue(r))}),n},e.prototype.toMapValue=function(e){return{fields:this.toFields(e)}},e.prototype.toArrayValue=function(e){var t=this,n=[];return e.forEach(function(e){n.push(t.toValue(e))}),{values:n}},e.prototype.fromFound=function(e){var t=this;g(!!e.found,"Tried to deserialize a found document from a missing document."),di(e.found.name,"doc.found.name"),di(e.found.updateTime,"doc.found.updateTime");var n=this.fromName(e.found.name),r=this.fromVersion(e.found.updateTime);return new jt(n,r,{},void 0,e.found,function(e){return t.fromValue(e)})},e.prototype.fromMissing=function(e){g(!!e.missing,"Tried to deserialize a missing document from a found document."),g(!!e.readTime,"Tried to deserialize a missing document without a read time.");var t=this.fromName(e.missing),n=this.fromVersion(e.readTime);return new zt(t,n)},e.prototype.fromMaybeDocument=function(e){return"found"in e?this.fromFound(e):"missing"in e?this.fromMissing(e):m("invalid batch get response: "+JSON.stringify(e))},e.prototype.toWatchTargetChangeState=function(e){switch(e){case Or.Added:return"ADD";case Or.Current:return"CURRENT";case Or.NoChange:return"NO_CHANGE";case Or.Removed:return"REMOVE";case Or.Reset:return"RESET";default:return m("Unknown WatchTargetChangeState: "+e)}},e.prototype.toTestWatchChange=function(e){if(e instanceof xr)return{filter:{count:e.existenceFilter.count,targetId:e.targetId}};if(e instanceof Rr){var t;if(e.newDoc instanceof jt)return{documentChange:{document:{name:this.toName((t=e.newDoc).key),fields:this.toFields(t.data()),updateTime:this.toVersion(t.version)},targetIds:e.updatedTargetIds,removedTargetIds:e.removedTargetIds}};if(e.newDoc instanceof zt)return{documentDelete:{document:this.toName((t=e.newDoc).key),readTime:this.toVersion(t.version),removedTargetIds:e.removedTargetIds}};if(null===e.newDoc)return{documentRemove:{document:this.toName(e.key),removedTargetIds:e.removedTargetIds}}}if(e instanceof Pr){var n=void 0;return e.cause&&(n={code:kr(e.cause.code),message:e.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(e.state),targetIds:e.targetIds,resumeToken:this.unsafeCastProtoByteString(e.resumeToken),cause:n}}}return m("Unrecognized watch change: "+JSON.stringify(e))},e.prototype.fromWatchChange=function(e){var t,n=this;if("targetChange"in e){di(e.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=e.targetChange.resumeToken||this.emptyByteString(),a=e.targetChange.cause,s=a&&this.fromRpcStatus(a);t=new Pr(r,i,o,s||null)}else if("documentChange"in e){di(e.documentChange,"documentChange"),di(e.documentChange.document,"documentChange.name"),di(e.documentChange.document.name,"documentChange.document.name"),di(e.documentChange.document.updateTime,"documentChange.document.updateTime");var u=e.documentChange,c=this.fromName(u.document.name),l=this.fromVersion(u.document.updateTime),h=new jt(c,l,{},void 0,u.document,function(e){return n.fromValue(e)});t=new Rr(u.targetIds||[],u.removedTargetIds||[],h.key,h)}else if("documentDelete"in e){di(e.documentDelete,"documentDelete"),di(e.documentDelete.document,"documentDelete.document");var f=e.documentDelete;c=this.fromName(f.document),l=f.readTime?this.fromVersion(f.readTime):ke.forDeletedDoc(),h=new zt(c,l),t=new Rr([],f.removedTargetIds||[],h.key,h)}else if("documentRemove"in e){di(e.documentRemove,"documentRemove"),di(e.documentRemove.document,"documentRemove");var d=e.documentRemove;c=this.fromName(d.document),t=new Rr([],d.removedTargetIds||[],c,null)}else{if(!("filter"in e))return m("Unknown change type "+JSON.stringify(e));di(e.filter,"filter"),di(e.filter.targetId,"filter.targetId");var p=e.filter,y=new ci(p.count||0);t=new xr(p.targetId,y)}return t},e.prototype.fromWatchTargetChangeState=function(e){return"NO_CHANGE"===e?Or.NoChange:"ADD"===e?Or.Added:"REMOVE"===e?Or.Removed:"CURRENT"===e?Or.Current:"RESET"===e?Or.Reset:m("Got unexpected TargetChange.state: "+e)},e.prototype.versionFromListenResponse=function(e){if(!("targetChange"in e))return ke.MIN;var t=e.targetChange;return t.targetIds&&t.targetIds.length?ke.MIN:t.readTime?this.fromVersion(t.readTime):ke.MIN},e.prototype.toMutation=function(e){var t,n=this;if(e instanceof _t)t={update:this.toMutationDocument(e.key,e.value)};else if(e instanceof Ct)t={delete:this.toName(e.key)};else if(e instanceof bt)t={update:this.toMutationDocument(e.key,e.data),updateMask:this.toDocumentMask(e.fieldMask)};else{if(!(e instanceof wt))return m("Unknown mutation type "+e.type);t={transform:{document:this.toName(e.key),fieldTransforms:e.fieldTransforms.map(function(e){return n.toFieldTransform(e)})}}}return e.precondition.isNone||(t.currentDocument=this.toPrecondition(e.precondition)),t},e.prototype.fromMutation=function(e){var t=this,n=e.currentDocument?this.fromPrecondition(e.currentDocument):mt.NONE;if(e.update){di(e.update.name,"name");var r=this.fromName(e.update.name),i=this.fromFields(e.update.fields||{});if(e.updateMask){var o=this.fromDocumentMask(e.updateMask);return new bt(r,i,o,n)}return new _t(r,i,n)}if(e.delete)return r=this.fromName(e.delete),new Ct(r,n);if(e.transform){r=this.fromName(e.transform.document);var a=e.transform.fieldTransforms.map(function(e){return t.fromFieldTransform(e)});return g(!0===n.exists,'Transforms only support precondition "exists == true"'),new wt(r,a)}return m("unknown mutation proto: "+JSON.stringify(e))},e.prototype.toPrecondition=function(e){return g(!e.isNone,"Can't serialize an empty precondition"),void 0!==e.updateTime?{updateTime:this.toVersion(e.updateTime)}:void 0!==e.exists?{exists:e.exists}:m("Unknown precondition")},e.prototype.fromPrecondition=function(e){return void 0!==e.updateTime?mt.updateTime(this.fromVersion(e.updateTime)):void 0!==e.exists?mt.exists(e.exists):mt.NONE},e.prototype.fromWriteResult=function(e,t){var n=this,r=this.fromVersion(e.updateTime?e.updateTime:t);r.isEqual(ke.MIN)&&(r=this.fromVersion(t));var i=null;return e.transformResults&&e.transformResults.length>0&&(i=e.transformResults.map(function(e){return n.fromValue(e)})),new yt(r,i)},e.prototype.fromWriteResults=function(e,t){var n=this;return e&&e.length>0?(g(void 0!==t,"Received a write result without a commit time"),e.map(function(e){return n.fromWriteResult(e,t)})):[]},e.prototype.toFieldTransform=function(e){var t=this,n=e.transform;if(n instanceof ni)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ri)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements.map(function(e){return t.toValue(e)})}};if(n instanceof ii)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements.map(function(e){return t.toValue(e)})}};if(n instanceof oi)return{fieldPath:e.field.canonicalString(),increment:this.toValue(n.operand)};throw m("Unknown transform: "+e.transform)},e.prototype.fromFieldTransform=function(e){var t=this,n=null;if("setToServerValue"in e)g("REQUEST_TIME"===e.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(e)),n=ni.instance;else if("appendMissingElements"in e)n=new ri((e.appendMissingElements.values||[]).map(function(e){return t.fromValue(e)}));else if("removeAllFromArray"in e)n=new ii((e.removeAllFromArray.values||[]).map(function(e){return t.fromValue(e)}));else if("increment"in e){var r=this.fromValue(e.increment);g(r instanceof Dt,"NUMERIC_ADD transform requires a NumberValue"),n=new oi(r)}else m("Unknown transform proto: "+JSON.stringify(e));var i=ue.fromServerFormat(e.fieldPath);return new pt(i,n)},e.prototype.toDocumentsTarget=function(e){return{documents:[this.toQueryPath(e.path)]}},e.prototype.fromDocumentsTarget=function(e){var t=e.documents.length;return g(1===t,"DocumentsTarget contained other than 1 document: "+t),jr.atPath(this.fromQueryPath(e.documents[0]))},e.prototype.toQueryTarget=function(e){var t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(g(n.length%2==0,"Collection Group queries should be within a document path or root."),t.parent=this.toQueryPath(n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(g(n.length%2!=0,"Document queries with filters are not supported."),t.parent=this.toQueryPath(n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(e.filters);r&&(t.structuredQuery.where=r);var i=this.toOrder(e.orderBy);i&&(t.structuredQuery.orderBy=i);var o=this.toInt32Value(e.limit);return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=this.toCursor(e.startAt)),e.endAt&&(t.structuredQuery.endAt=this.toCursor(e.endAt)),t},e.prototype.fromQueryTarget=function(e){var t=this.fromQueryPath(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){g(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:t=t.child(o.collectionId)}var a=[];n.where&&(a=this.fromFilter(n.where));var s=[];n.orderBy&&(s=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var c=null;n.startAt&&(c=this.fromCursor(n.startAt));var l=null;return n.endAt&&(l=this.fromCursor(n.endAt)),new jr(t,i,s,a,u,c,l)},e.prototype.toListenRequestLabels=function(e){var t=this.toLabel(e.purpose);return null==t?null:{"goog-listen-tags":t}},e.prototype.toLabel=function(e){switch(e){case kn.Listen:return null;case kn.ExistenceFilterMismatch:return"existence-filter-mismatch";case kn.LimboResolution:return"limbo-document";default:return m("Unrecognized query purpose: "+e)}},e.prototype.toTarget=function(e){var t,n=e.query;return(t=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=e.targetId,e.resumeToken.length>0&&(t.resumeToken=this.unsafeCastProtoByteString(e.resumeToken)),t},e.prototype.toFilter=function(e){var t=this;if(0!==e.length){var n=e.map(function(e){return e instanceof Hr?t.toUnaryOrFieldFilter(e):m("Unrecognized filter: "+JSON.stringify(e))});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},e.prototype.fromFilter=function(e){var t=this;return e?void 0!==e.unaryFilter?[this.fromUnaryFilter(e)]:void 0!==e.fieldFilter?[this.fromFieldFilter(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return t.fromFilter(e)}).reduce(function(e,t){return e.concat(t)}):m("Unknown filter: "+JSON.stringify(e)):[]},e.prototype.toOrder=function(e){var t=this;if(0!==e.length)return e.map(function(e){return t.toPropertyOrder(e)})},e.prototype.fromOrder=function(e){var t=this;return e.map(function(e){return t.fromPropertyOrder(e)})},e.prototype.toCursor=function(e){var t=this;return{before:e.before,values:e.position.map(function(e){return t.toValue(e)})}},e.prototype.fromCursor=function(e){var t=this,n=!!e.before,r=e.values.map(function(e){return t.fromValue(e)});return new Xr(r,n)},e.prototype.toDirection=function(e){return li[e.name]},e.prototype.fromDirection=function(e){switch(e){case"ASCENDING":return Jr.ASCENDING;case"DESCENDING":return Jr.DESCENDING;default:return}},e.prototype.toOperatorName=function(e){return hi[e.name]},e.prototype.fromOperatorName=function(e){switch(e){case"EQUAL":return Qr.EQUAL;case"GREATER_THAN":return Qr.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Qr.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Qr.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Qr.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Qr.ARRAY_CONTAINS;case"IN":return Qr.IN;case"ARRAY_CONTAINS_ANY":return Qr.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return m("Unspecified operator");default:return m("Unknown operator")}},e.prototype.toFieldPathReference=function(e){return{fieldPath:e.canonicalString()}},e.prototype.fromFieldPathReference=function(e){return ue.fromServerFormat(e.fieldPath)},e.prototype.toPropertyOrder=function(e){return{field:this.toFieldPathReference(e.field),direction:this.toDirection(e.dir)}},e.prototype.fromPropertyOrder=function(e){return new $r(this.fromFieldPathReference(e.field),this.fromDirection(e.direction))},e.prototype.fromFieldFilter=function(e){return Hr.create(this.fromFieldPathReference(e.fieldFilter.field),this.fromOperatorName(e.fieldFilter.op),this.fromValue(e.fieldFilter.value))},e.prototype.toUnaryOrFieldFilter=function(e){if(e.op===Qr.EQUAL){if(e.value.isEqual(xt.NAN))return{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NAN"}};if(e.value.isEqual(It.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(e.field),op:this.toOperatorName(e.op),value:this.toValue(e.value)}}},e.prototype.fromUnaryFilter=function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=this.fromFieldPathReference(e.unaryFilter.field);return Hr.create(t,Qr.EQUAL,xt.NAN);case"IS_NULL":var n=this.fromFieldPathReference(e.unaryFilter.field);return Hr.create(n,Qr.EQUAL,It.INSTANCE);case"OPERATOR_UNSPECIFIED":return m("Unspecified filter");default:return m("Unknown filter")}},e.prototype.toDocumentMask=function(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}},e.prototype.fromDocumentMask=function(e){var t=(e.fieldPaths||[]).map(function(e){return ue.fromServerFormat(e)});return dt.fromArray(t)},e}(),vi=function(){this.viewSnap=null,this.targetId=0,this.listeners=[]},mi=function(){function e(e){this.syncEngine=e,this.queries=new Ht(function(e){return e.canonicalId()}),this.onlineState=mr.Unknown,this.snapshotsInSyncListeners=new Set,this.syncEngine.subscribe(this)}return e.prototype.listen=function(e){var t=e.query,n=!1,r=this.queries.get(t);return r||(n=!0,r=new vi,this.queries.set(t,r)),r.listeners.push(e),g(!e.applyOnlineStateChange(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),r.viewSnap&&e.onViewSnapshot(r.viewSnap)&&this.raiseSnapshotsInSyncEvent(),n?this.syncEngine.listen(t).then(function(e){return r.targetId=e,e}):Promise.resolve(r.targetId)},e.prototype.unlisten=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n,r,i;return o.__generator(this,function(o){return n=!1,(r=this.queries.get(t=e.query))&&(i=r.listeners.indexOf(e))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(t),[2,this.syncEngine.unlisten(t)]):[2]})})},e.prototype.onWatchChange=function(e){for(var t=!1,n=0,r=e;n<r.length;n++){var i=r[n],o=this.queries.get(i.query);if(o){for(var a=0,s=o.listeners;a<s.length;a++)s[a].onViewSnapshot(i)&&(t=!0);o.viewSnap=i}}t&&this.raiseSnapshotsInSyncEvent()},e.prototype.onWatchError=function(e,t){var n=this.queries.get(e);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(t);this.queries.delete(e)},e.prototype.onOnlineStateChange=function(e){this.onlineState=e;var t=!1;this.queries.forEach(function(n,r){for(var i=0,o=r.listeners;i<o.length;i++)o[i].applyOnlineStateChange(e)&&(t=!0)}),t&&this.raiseSnapshotsInSyncEvent()},e.prototype.addSnapshotsInSyncListener=function(e){this.snapshotsInSyncListeners.add(e),e.next()},e.prototype.removeSnapshotsInSyncListener=function(e){this.snapshotsInSyncListeners.delete(e)},e.prototype.raiseSnapshotsInSyncEvent=function(){this.snapshotsInSyncListeners.forEach(function(e){e.next()})},e}(),gi=function(){function e(e,t,n){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState=mr.Unknown,this.options=n||{}}return e.prototype.onViewSnapshot=function(e){if(g(e.docChanges.length>0||e.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var i=r[n];i.type!==Er.Metadata&&t.push(i)}e=new Ar(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var o=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),o=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),o=!0),this.snap=e,o},e.prototype.onError=function(e){this.queryObserver.error(e)},e.prototype.applyOnlineStateChange=function(e){this.onlineState=e;var t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t},e.prototype.shouldRaiseInitialEvent=function(e,t){return g(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!e.fromCache||(this.options.waitForSyncWhenOnline&&t!==mr.Offline?(g(e.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!e.docs.isEmpty()||t===mr.Offline)},e.prototype.shouldRaiseEvent=function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges},e.prototype.raiseInitialEvent=function(e){g(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e=Ar.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(e)},e}(),_i=function(){function e(e,t,n,r){this.targetId=e,this.fromCache=t,this.addedKeys=n,this.removedKeys=r}return e.fromSnapshot=function(t,n){for(var r=Fe(),i=Fe(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case Er.Added:r=r.add(s.doc.key);break;case Er.Removed:i=i.add(s.doc.key)}}return new e(t,n.fromCache,r,i)},e}(),bi=function(e){this.key=e},wi=function(e){this.key=e},Ci=function(){function e(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.current=!1,this.limboDocuments=Fe(),this.mutatedKeys=Fe(),this.documentSet=new Sr(e.docComparator.bind(e))}return Object.defineProperty(e.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),e.prototype.computeDocChanges=function(e,t){var n=this,r=t?t.changeSet:new Ir,i=t?t.documentSet:this.documentSet,o=t?t.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(e.inorderTraversal(function(e,t){var c=i.get(e),l=t instanceof jt?t:null;l&&(g(e.isEqual(l.key),"Mismatching keys found in document changes: "+e+" != "+l.key),l=n.query.matches(l)?l:null);var h=!!c&&n.mutatedKeys.has(c.key),f=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;c&&l?c.data().isEqual(l.data())?h!==f&&(r.track({type:Er.Metadata,doc:l}),d=!0):n.shouldWaitForSyncedDocument(c,l)||(r.track({type:Er.Modified,doc:l}),d=!0,u&&n.query.docComparator(l,u)>0&&(s=!0)):!c&&l?(r.track({type:Er.Added,doc:l}),d=!0):c&&!l&&(r.track({type:Er.Removed,doc:c}),d=!0,u&&(s=!0)),d&&(l?(a=a.add(l),o=f?o.add(e):o.delete(e)):(a=a.delete(e),o=o.delete(e)))}),this.query.hasLimit())for(;a.size>this.query.limit;){var c=a.last();a=a.delete(c.key),o=o.delete(c.key),r.track({type:Er.Removed,doc:c})}return g(!s||!t,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},e.prototype.shouldWaitForSyncedDocument=function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations},e.prototype.applyChanges=function(e,t,n){var r=this;g(!e.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;var o=e.changeSet.getChanges();o.sort(function(e,t){return function(e,t){var n=function(e){switch(e){case Er.Added:return 1;case Er.Modified:case Er.Metadata:return 2;case Er.Removed:return 0;default:return m("Unknown ChangeType: "+e)}};return n(e)-n(t)}(e.type,t.type)||r.query.docComparator(e.doc,t.doc)}),this.applyTargetChange(n);var a=t?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?Tr.Synced:Tr.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new Ar(this.query,e.documentSet,i,o,e.mutatedKeys,s===Tr.Local,u,!1),limboChanges:a}:{limboChanges:a}},e.prototype.applyOnlineStateChange=function(e){return this.current&&e===mr.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Ir,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},e.prototype.shouldBeInLimbo=function(e){return!this._syncedDocuments.has(e)&&!!this.documentSet.has(e)&&!this.documentSet.get(e).hasLocalMutations},e.prototype.applyTargetChange=function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t._syncedDocuments=t._syncedDocuments.add(e)}),e.modifiedDocuments.forEach(function(e){return g(t._syncedDocuments.has(e),"Modified document "+e+" not found in view.")}),e.removedDocuments.forEach(function(e){return t._syncedDocuments=t._syncedDocuments.delete(e)}),this.current=e.current)},e.prototype.updateLimboDocuments=function(){var e=this;if(!this.current)return[];var t=this.limboDocuments;this.limboDocuments=Fe(),this.documentSet.forEach(function(t){e.shouldBeInLimbo(t.key)&&(e.limboDocuments=e.limboDocuments.add(t.key))});var n=[];return t.forEach(function(t){e.limboDocuments.has(t)||n.push(new wi(t))}),this.limboDocuments.forEach(function(e){t.has(e)||n.push(new bi(e))}),n},e.prototype.synchronizeWithPersistedState=function(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=Fe();var t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)},e.prototype.computeInitialSnapshot=function(){return Ar.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===Tr.Local)},e}(),ki=5,Si=function(){function e(e,t,n,r){this.asyncQueue=e,this.remoteStore=t,this.updateFunction=n,this.deferred=r,this.retries=ki,this.backoff=new lr(this.asyncQueue,he.RetryTransaction)}return e.prototype.run=function(){this.runWithBackOff()},e.prototype.runWithBackOff=function(){var e=this;this.backoff.backoffAndRun(function(){return o.__awaiter(e,void 0,void 0,function(){var e,t,n=this;return o.__generator(this,function(r){return e=this.remoteStore.createTransaction(),(t=this.tryRunUpdateFunction(e))&&t.then(function(t){n.asyncQueue.enqueueAndForget(function(){return e.commit().then(function(){n.deferred.resolve(t)}).catch(function(e){n.handleTransactionError(e)})})}).catch(function(e){n.handleTransactionError(e)}),[2]})})})},e.prototype.tryRunUpdateFunction=function(e){try{var t=this.updateFunction(e);return!or(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(y){return this.deferred.reject(y),null}},e.prototype.handleTransactionError=function(e){var t=this;this.retries>0&&this.isRetryableTransactionError(e)?(this.retries-=1,this.asyncQueue.enqueueAndForget(function(){return t.runWithBackOff(),Promise.resolve()})):this.deferred.reject(e)},e.prototype.isRetryableTransactionError=function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!wr(t)}return!1},e}(),Ei=function(e,t,n){this.query=e,this.targetId=t,this.view=n},Ti=function(e){this.key=e,this.receivedDocument=!1},Ii=function(){function e(e,t,n,r){this.localStore=e,this.remoteStore=t,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new Ht(function(e){return e.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new Se(ce.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new Qn,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=$e.forSyncEngine(),this.isPrimary=void 0,this.onlineState=mr.Unknown}return Object.defineProperty(e.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),e.prototype.subscribe=function(e){g(null!==e,"SyncEngine listener cannot be null"),g(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=e},e.prototype.listen=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n,r,i,a;return o.__generator(this,function(o){switch(o.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(e))?(this.sharedClientState.addLocalQueryTarget(t=r.targetId),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateQuery(e)];case 2:return i=o.sent(),a=this.sharedClientState.addLocalQueryTarget(i.targetId),t=i.targetId,[4,this.initializeViewAndComputeSnapshot(i,"current"===a)];case 3:n=o.sent(),this.isPrimary&&this.remoteStore.listen(i),o.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,t]}})})},e.prototype.initializeViewAndComputeSnapshot=function(e,t){return o.__awaiter(this,void 0,void 0,function(){var n,r,i,a,s,u,c;return o.__generator(this,function(o){switch(o.label){case 0:return[4,this.localStore.executeQuery(n=e.query,!0)];case 1:return r=o.sent(),i=new Ci(n,r.remoteKeys),a=i.computeDocChanges(r.documents),s=Nr.createSynthesizedTargetChangeForCurrentChange(e.targetId,t&&this.onlineState!==mr.Offline),g(0===(u=i.applyChanges(a,!0===this.isPrimary,s)).limboChanges.length,"View returned limbo docs before target ack from the server."),g(!!u.snapshot,"applyChanges for new view should always return a snapshot"),c=new Ei(n,e.targetId,i),this.queryViewsByQuery.set(n,c),this.queryViewsByTarget[e.targetId]=c,[2,u.snapshot]}})})},e.prototype.synchronizeViewAndComputeSnapshot=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n;return o.__generator(this,function(r){switch(r.label){case 0:return[4,this.localStore.executeQuery(e.query,!0)];case 1:return t=r.sent(),n=e.view.synchronizeWithPersistedState(t),this.isPrimary&&this.updateTrackedLimbos(e.targetId,n.limboChanges),[2,n]}})})},e.prototype.unlisten=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n=this;return o.__generator(this,function(r){switch(r.label){case 0:return this.assertSubscribed("unlisten()"),g(!!(t=this.queryViewsByQuery.get(e)),"Trying to unlisten on query not found:"+e),this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(t.targetId),this.sharedClientState.isActiveQueryTarget(t.targetId)?[3,2]:[4,this.localStore.releaseQuery(e,!1).then(function(){n.sharedClientState.clearQueryState(t.targetId),n.remoteStore.unlisten(t.targetId),n.removeAndCleanupQuery(t)}).catch(Fn)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(t),[4,this.localStore.releaseQuery(e,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}})})},e.prototype.write=function(e,t){return o.__awaiter(this,void 0,void 0,function(){var n;return o.__generator(this,function(r){switch(r.label){case 0:return this.assertSubscribed("write()"),[4,this.localStore.localWrite(e)];case 1:return n=r.sent(),this.sharedClientState.addPendingMutation(n.batchId),this.addMutationCallback(n.batchId,t),[4,this.emitNewSnapsAndNotifyLocalStore(n.changes)];case 2:return r.sent(),[4,this.remoteStore.fillWritePipeline()];case 3:return r.sent(),[2]}})})},e.prototype.runTransaction=function(e,t,n){new Si(e,this.remoteStore,t,n).run()},e.prototype.applyRemoteEvent=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n=this;return o.__generator(this,function(r){switch(r.label){case 0:this.assertSubscribed("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.applyRemoteEvent(e)];case 2:return t=r.sent(),I(e.targetChanges,function(e,t){var r=n.limboResolutionsByTarget[Number(e)];r&&(g(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),t.addedDocuments.size>0?r.receivedDocument=!0:t.modifiedDocuments.size>0?g(r.receivedDocument,"Received change for limbo target document without add."):t.removedDocuments.size>0&&(g(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))}),[4,this.emitNewSnapsAndNotifyLocalStore(t,e)];case 3:return r.sent(),[3,6];case 4:return[4,Fn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},e.prototype.applyOnlineStateChange=function(e,t){if(this.isPrimary&&t===gr.RemoteStore||!this.isPrimary&&t===gr.SharedClientState){this.assertSubscribed("applyOnlineStateChange()");var n=[];this.queryViewsByQuery.forEach(function(t,r){var i=r.view.applyOnlineStateChange(e);g(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)}),this.syncEngineListener.onOnlineStateChange(e),this.syncEngineListener.onWatchChange(n),this.onlineState=e,this.isPrimary&&this.sharedClientState.setOnlineState(e)}},e.prototype.rejectListen=function(e,t){return o.__awaiter(this,void 0,void 0,function(){var n,r,i,a,s,u,c=this;return o.__generator(this,function(o){switch(o.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(e,"rejected",t),(r=(n=this.limboResolutionsByTarget[e])&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[e],i=(i=new Se(ce.comparator)).insert(r,new zt(r,ke.forDeletedDoc())),a=Fe().add(r),s=new Dr(ke.MIN,{},new Ae(K),i,a),[2,this.applyRemoteEvent(s)]):[3,1];case 1:return g(!!(u=this.queryViewsByTarget[e]),"Unknown targetId: "+e),[4,this.localStore.releaseQuery(u.query,!1).then(function(){return c.removeAndCleanupQuery(u)}).catch(Fn)];case 2:o.sent(),this.syncEngineListener.onWatchError(u.query,t),o.label=3;case 3:return[2]}})})},e.prototype.applyBatchState=function(e,t,n){return o.__awaiter(this,void 0,void 0,function(){var r;return o.__generator(this,function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(e)];case 1:return null===(r=i.sent())?(p("SyncEngine","Cannot apply mutation batch with id: "+e),[2]):"pending"!==t?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===t||"rejected"===t?(this.processUserCallback(e,n||null),this.localStore.removeCachedMutationBatchMetadata(e)):m("Unknown batchState: "+t),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}})})},e.prototype.applySuccessfulWrite=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n;return o.__generator(this,function(r){switch(r.label){case 0:this.assertSubscribed("applySuccessfulWrite()"),this.processUserCallback(t=e.batch.batchId,null),this.triggerPendingWritesCallbacks(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.acknowledgeBatch(e)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(t,"acknowledged"),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,Fn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},e.prototype.rejectFailedWrite=function(e,t){return o.__awaiter(this,void 0,void 0,function(){var n;return o.__generator(this,function(r){switch(r.label){case 0:this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(e,t),this.triggerPendingWritesCallbacks(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.localStore.rejectBatch(e)];case 2:return n=r.sent(),this.sharedClientState.updateMutationState(e,"rejected",t),[4,this.emitNewSnapsAndNotifyLocalStore(n)];case 3:return r.sent(),[3,6];case 4:return[4,Fn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},e.prototype.registerPendingWritesCallback=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n;return o.__generator(this,function(r){switch(r.label){case 0:return this.remoteStore.canUseNetwork()||p("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.localStore.getHighestUnacknowledgedBatchId()];case 1:return-1===(t=r.sent())?(e.resolve(),[2]):((n=this.pendingWritesCallbacks.get(t)||[]).push(e),this.pendingWritesCallbacks.set(t,n),[2])}})})},e.prototype.triggerPendingWritesCallbacks=function(e){(this.pendingWritesCallbacks.get(e)||[]).forEach(function(e){e.resolve()}),this.pendingWritesCallbacks.delete(e)},e.prototype.rejectOutstandingPendingWritesCallbacks=function(e){this.pendingWritesCallbacks.forEach(function(t){t.forEach(function(t){t.reject(new C(w.CANCELLED,e))})}),this.pendingWritesCallbacks.clear()},e.prototype.addMutationCallback=function(e,t){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new Se(K)),n=n.insert(e,t),this.mutationUserCallbacks[this.currentUser.toKey()]=n},e.prototype.processUserCallback=function(e,t){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(e);r&&(g(e===n.minKey(),"Mutation callbacks processed out-of-order?"),t?r.reject(t):r.resolve(),n=n.remove(e)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},e.prototype.removeAndCleanupQuery=function(e){var t=this;if(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.queryViewsByQuery.delete(e.query),delete this.queryViewsByTarget[e.targetId],this.isPrimary){var n=this.limboDocumentRefs.referencesForId(e.targetId);this.limboDocumentRefs.removeReferencesForId(e.targetId),n.forEach(function(e){t.limboDocumentRefs.containsKey(e)||t.removeLimboTarget(e)})}},e.prototype.removeLimboTarget=function(e){var t=this.limboTargetsByKey.get(e);null!==t&&(this.remoteStore.unlisten(t),this.limboTargetsByKey=this.limboTargetsByKey.remove(e),delete this.limboResolutionsByTarget[t])},e.prototype.updateTrackedLimbos=function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];i instanceof bi?(this.limboDocumentRefs.addReference(i.key,e),this.trackLimboChange(i)):i instanceof wi?(p("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,e),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)):m("Unknown limbo change: "+JSON.stringify(i))}},e.prototype.trackLimboChange=function(e){var t=e.key;if(!this.limboTargetsByKey.get(t)){p("SyncEngine","New document in limbo: "+t);var n=this.limboTargetIdGenerator.next(),r=jr.atPath(t.path);this.limboResolutionsByTarget[n]=new Ti(t),this.remoteStore.listen(new Sn(r,n,kn.LimboResolution,ie.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(t,n)}},e.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},e.prototype.emitNewSnapsAndNotifyLocalStore=function(e,t){return o.__awaiter(this,void 0,void 0,function(){var n,r,i,a=this;return o.__generator(this,function(o){switch(o.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach(function(o,s){i.push(Promise.resolve().then(function(){var t=s.view.computeDocChanges(e);return t.needsRefill?a.localStore.executeQuery(s.query,!1).then(function(e){return s.view.computeDocChanges(e.documents,t)}):t}).then(function(e){var i=s.view.applyChanges(e,!0===a.isPrimary,t&&t.targetChanges[s.targetId]);if(a.updateTrackedLimbos(s.targetId,i.limboChanges),i.snapshot){a.isPrimary&&a.sharedClientState.updateQueryState(s.targetId,i.snapshot.fromCache?"not-current":"current"),n.push(i.snapshot);var o=_i.fromSnapshot(s.targetId,i.snapshot);r.push(o)}}))}),[4,Promise.all(i)];case 1:return o.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return o.sent(),[2]}})})},e.prototype.assertSubscribed=function(e){g(null!==this.syncEngineListener,"Trying to call "+e+" before calling subscribe().")},e.prototype.handleCredentialChange=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n;return o.__generator(this,function(r){switch(r.label){case 0:return t=!this.currentUser.isEqual(e),this.currentUser=e,t?(this.rejectOutstandingPendingWritesCallbacks("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.localStore.handleUserChange(e)]):[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}})})},e.prototype.applyPrimaryState=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n,r,i,a,s,u=this;return o.__generator(this,function(o){switch(o.label){case 0:return!0!==e||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return o.sent(),t=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(t.toArray())];case 2:for(n=o.sent(),r=0,i=n;r<i.length;r++)this.remoteStore.listen(i[r]);return[3,7];case 3:return!1!==e||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,a=[],s=Promise.resolve(),T(this.queryViewsByTarget,function(e,t){u.sharedClientState.isLocalQueryTarget(e)?a.push(e):s=s.then(function(){return u.unlisten(t.query)}),u.remoteStore.unlisten(t.targetId)}),[4,s]);case 4:return o.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)];case 5:return o.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:o.sent(),o.label=7;case 7:return[2]}})})},e.prototype.resetLimboDocuments=function(){var e=this;T(this.limboResolutionsByTarget,function(t){e.remoteStore.unlisten(t)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new Se(ce.comparator)},e.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n,r,i,a,s,u,c,l;return o.__generator(this,function(o){switch(o.label){case 0:t=[],n=[],r=0,i=e,o.label=1;case 1:return r<i.length?(s=void 0,(u=this.queryViewsByTarget[a=i[r]])?[4,this.localStore.releaseQuery(u.query,!0)]:[3,5]):[3,11];case 2:return o.sent(),[4,this.localStore.allocateQuery(u.query)];case 3:return s=o.sent(),[4,this.synchronizeViewAndComputeSnapshot(u)];case 4:return(c=o.sent()).snapshot&&n.push(c.snapshot),[3,9];case 5:return g(!0===this.isPrimary,"A secondary tab should never have an active query without an active view."),[4,this.localStore.getQueryForTarget(a)];case 6:return g(!!(l=o.sent()),"Query data for target "+a+" not found"),[4,this.localStore.allocateQuery(l)];case 7:return s=o.sent(),[4,this.initializeViewAndComputeSnapshot(s,!1)];case 8:o.sent(),o.label=9;case 9:t.push(s),o.label=10;case 10:return r++,[3,1];case 11:return this.syncEngineListener.onWatchChange(n),[2,t]}})})},e.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},e.prototype.applyTargetState=function(e,t,n){return o.__awaiter(this,void 0,void 0,function(){var r,i,a;return o.__generator(this,function(o){switch(o.label){case 0:if(this.isPrimary)return p("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.queryViewsByTarget[e])return[3,7];switch(t){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.localStore.getNewDocumentChanges()];case 2:return r=o.sent(),i=Dr.createSynthesizedRemoteEventForCurrentChange(e,"current"===t),[4,this.emitNewSnapsAndNotifyLocalStore(r,i)];case 3:return o.sent(),[3,7];case 4:return this.removeAndCleanupQuery(a=this.queryViewsByTarget[e]),[4,this.localStore.releaseQuery(a.query,!0)];case 5:return o.sent(),this.syncEngineListener.onWatchError(a.query,n),[3,7];case 6:m("Unexpected target state: "+t),o.label=7;case 7:return[2]}})})},e.prototype.applyActiveTargetsChange=function(e,t){return o.__awaiter(this,void 0,void 0,function(){var n,r,i,a,s,u,c,l,h,f=this;return o.__generator(this,function(d){switch(d.label){case 0:if(!this.isPrimary)return[2];n=0,r=e,d.label=1;case 1:return n<r.length?(g(!this.queryViewsByTarget[h=r[n]],"Trying to add an already active target"),[4,this.localStore.getQueryForTarget(h)]):[3,6];case 2:return g(!!(i=d.sent()),"Query data for active target "+h+" not found"),[4,this.localStore.allocateQuery(i)];case 3:return a=d.sent(),[4,this.initializeViewAndComputeSnapshot(a,!1)];case 4:d.sent(),this.remoteStore.listen(a),d.label=5;case 5:return n++,[3,1];case 6:s=function(e){var t;return o.__generator(this,function(n){switch(n.label){case 0:return(t=u.queryViewsByTarget[e])?[4,u.localStore.releaseQuery(t.query,!1).then(function(){f.remoteStore.unlisten(e),f.removeAndCleanupQuery(t)}).catch(Fn)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})},u=this,c=0,l=t,d.label=7;case 7:return c<l.length?[5,s(h=l[c])]:[3,10];case 8:d.sent(),d.label=9;case 9:return c++,[3,7];case 10:return[2]}})})},e.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},e.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},e.prototype.getRemoteKeysForTarget=function(e){var t=this.limboResolutionsByTarget[e];return t&&t.receivedDocument?Fe().add(t.key):this.queryViewsByTarget[e]?this.queryViewsByTarget[e].view.syncedDocuments:Fe()},e}(),Ai=function(){function e(e){this.uid=e}return e.prototype.isAuthenticated=function(){return null!=this.uid},e.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(e){return e.uid===this.uid},e.UNAUTHENTICATED=new e(null),e.GOOGLE_CREDENTIALS=new e("google-credentials-uid"),e.FIRST_PARTY=new e("first-party-uid"),e}(),Di="SharedClientState",Ni="firestore_clients",Ri="firestore_mutations",xi="firestore_targets",Oi="firestore_online_state",Pi="firestore_sequence_number",Mi=function(){function e(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r,g(void 0!==r==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return e.fromWebStorageEntry=function(t,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),a=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new C(i.error.code,i.error.message)),o?new e(t,n,i.state,a):(y(Di,"Failed to parse mutation state for ID '"+n+"': "+r),null)},e.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),Li=function(){function e(e,t,n){this.targetId=e,this.state=t,this.error=n,g(void 0!==n==("rejected"===t),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return e.fromWebStorageEntry=function(t,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new C(r.error.code,r.error.message)),i?new e(t,r.state,o):(y(Di,"Failed to parse target state for ID '"+t+"': "+n),null)},e.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),Vi=function(){function e(e,t){this.clientId=e,this.activeTargetIds=t}return e.fromWebStorageEntry=function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=qe(),a=0;i&&a<r.activeTargetIds.length;++a)i=ar(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new e(t,o):(y(Di,"Failed to parse client data for instance '"+t+"': "+n),null)},e}(),Fi=function(){function e(e,t){this.clientId=e,this.onlineState=t}return e.fromWebStorageEntry=function(t){var n=JSON.parse(t);return"object"==typeof n&&n.onlineState in mr&&"string"==typeof n.clientId?new e(n.clientId,mr[n.onlineState]):(y(Di,"Failed to parse online state: "+t),null)},e}(),Ui=function(){function e(){this.activeTargetIds=qe()}return e.prototype.addQueryTarget=function(e){g(!this.activeTargetIds.has(e),"Target with ID '"+e+"' already active."),this.activeTargetIds=this.activeTargetIds.add(e)},e.prototype.removeQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},e.prototype.toWebStorageJSON=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},e}(),qi=function(){function e(t,n,r,i,o){if(this.queue=t,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!e.isAvailable(this.platform))throw new C(w.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey=Pi+"_"+r,this.activeClients[this.localClientId]=new Ui,this.clientStateKeyRe=new RegExp("^"+Ni+"_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Ri+"_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+xi+"_"+a+"_(\\d+)$"),this.onlineStateKey=Oi+"_"+r,this.platform.window.addEventListener("storage",this.storageListener)}return e.isAvailable=function(e){return!(!e.window||null==e.window.localStorage)},e.prototype.start=function(){return o.__awaiter(this,void 0,void 0,function(){var e,t,n,r,i,a,s,u,c,l,h=this;return o.__generator(this,function(o){switch(o.label){case 0:return g(!this.started,"WebStorageSharedClientState already started"),g(null!==this.syncEngine,"syncEngine property must be set before calling start()"),g(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(e=o.sent(),t=0,n=e;t<n.length;t++)(r=n[t])!==this.localClientId&&(i=this.getItem(this.toWebStorageClientStateKey(r)))&&(a=Vi.fromWebStorageEntry(r,i))&&(this.activeClients[a.clientId]=a);for(this.persistClientState(),(s=this.storage.getItem(this.onlineStateKey))&&(u=this.fromWebStorageOnlineState(s))&&this.handleOnlineStateEvent(u),c=0,l=this.earlyEvents;c<l.length;c++)this.handleWebStorageEvent(l[c]);return this.earlyEvents=[],this.platform.window.addEventListener("unload",function(){return h.shutdown()}),this.started=!0,[2]}})})},e.prototype.writeSequenceNumber=function(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))},e.prototype.getAllActiveQueryTargets=function(){var e=qe();return I(this.activeClients,function(t,n){e=e.unionWith(n.activeTargetIds)}),e},e.prototype.isActiveQueryTarget=function(e){for(var t in this.activeClients)if(this.activeClients.hasOwnProperty(t)&&this.activeClients[t].activeTargetIds.has(e))return!0;return!1},e.prototype.addPendingMutation=function(e){this.persistMutationState(e,"pending")},e.prototype.updateMutationState=function(e,t,n){this.persistMutationState(e,t,n),this.removeMutationState(e)},e.prototype.addLocalQueryTarget=function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(e));if(n){var r=Li.fromWebStorageEntry(e,n);r&&(t=r.state)}}return this.localClientState.addQueryTarget(e),this.persistClientState(),t},e.prototype.removeLocalQueryTarget=function(e){this.localClientState.removeQueryTarget(e),this.persistClientState()},e.prototype.isLocalQueryTarget=function(e){return this.localClientState.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){this.removeItem(this.toWebStorageQueryTargetMetadataKey(e))},e.prototype.updateQueryState=function(e,t,n){this.persistQueryTargetState(e,t,n)},e.prototype.handleUserChange=function(e,t,n){var r=this;t.forEach(function(e){r.removeMutationState(e)}),this.currentUser=e,n.forEach(function(e){r.addPendingMutation(e)})},e.prototype.setOnlineState=function(e){this.persistOnlineState(e)},e.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},e.prototype.getItem=function(e){var t=this.storage.getItem(e);return p(Di,"READ",e,t),t},e.prototype.setItem=function(e,t){p(Di,"SET",e,t),this.storage.setItem(e,t)},e.prototype.removeItem=function(e){p(Di,"REMOVE",e),this.storage.removeItem(e)},e.prototype.handleWebStorageEvent=function(e){var t=this;if(e.storageArea===this.storage){if(p(Di,"EVENT",e.key,e.newValue),e.key===this.localClientStorageKey)return void y("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget(function(){return o.__awaiter(t,void 0,void 0,function(){var t,n,r,i,a,s;return o.__generator(this,function(o){if(!this.started)return this.earlyEvents.push(e),[2];if(null===e.key)return[2];if(this.clientStateKeyRe.test(e.key)){if(null==e.newValue)return n=this.fromWebStorageClientStateKey(e.key),[2,this.handleClientStateEvent(n,null)];if(t=this.fromWebStorageClientState(e.key,e.newValue))return[2,this.handleClientStateEvent(t.clientId,t)]}else if(this.mutationBatchKeyRe.test(e.key)){if(null!==e.newValue&&(r=this.fromWebStorageMutationMetadata(e.key,e.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(e.key)){if(null!==e.newValue&&(i=this.fromWebStorageQueryTargetMetadata(e.key,e.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(e.key===this.onlineStateKey){if(null!==e.newValue&&(a=this.fromWebStorageOnlineState(e.newValue)))return[2,this.handleOnlineStateEvent(a)]}else e.key===this.sequenceNumberKey&&(g(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(s=function(e){var t=ie.INVALID;if(null!=e)try{var n=JSON.parse(e);g("number"==typeof n,"Found non-numeric sequence number"),t=n}catch(r){y(Di,"Failed to read sequence number from WebStorage",r)}return t}(e.newValue))!==ie.INVALID&&this.sequenceNumberHandler(s));return[2]})})})}},Object.defineProperty(e.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),e.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},e.prototype.persistMutationState=function(e,t,n){var r=new Mi(this.currentUser,e,t,n),i=this.toWebStorageMutationBatchKey(e);this.setItem(i,r.toWebStorageJSON())},e.prototype.removeMutationState=function(e){var t=this.toWebStorageMutationBatchKey(e);this.removeItem(t)},e.prototype.persistOnlineState=function(e){this.storage.setItem(this.onlineStateKey,JSON.stringify({clientId:this.localClientId,onlineState:mr[e]}))},e.prototype.persistQueryTargetState=function(e,t,n){var r=this.toWebStorageQueryTargetMetadataKey(e),i=new Li(e,t,n);this.setItem(r,i.toWebStorageJSON())},e.prototype.toWebStorageClientStateKey=function(e){return g(-1===e.indexOf("_"),"Client key cannot contain '_', but was '"+e+"'"),Ni+"_"+this.persistenceKey+"_"+e},e.prototype.toWebStorageQueryTargetMetadataKey=function(e){return xi+"_"+this.persistenceKey+"_"+e},e.prototype.toWebStorageMutationBatchKey=function(e){var t=Ri+"_"+this.persistenceKey+"_"+e;return this.currentUser.isAuthenticated()&&(t+="_"+this.currentUser.uid),t},e.prototype.fromWebStorageClientStateKey=function(e){var t=this.clientStateKeyRe.exec(e);return t?t[1]:null},e.prototype.fromWebStorageClientState=function(e,t){var n=this.fromWebStorageClientStateKey(e);return g(null!==n,"Cannot parse client state key '"+e+"'"),Vi.fromWebStorageEntry(n,t)},e.prototype.fromWebStorageMutationMetadata=function(e,t){var n=this.mutationBatchKeyRe.exec(e);g(null!==n,"Cannot parse mutation batch key '"+e+"'");var r=Number(n[1]);return Mi.fromWebStorageEntry(new Ai(void 0!==n[2]?n[2]:null),r,t)},e.prototype.fromWebStorageQueryTargetMetadata=function(e,t){var n=this.queryTargetKeyRe.exec(e);g(null!==n,"Cannot parse query target key '"+e+"'");var r=Number(n[1]);return Li.fromWebStorageEntry(r,t)},e.prototype.fromWebStorageOnlineState=function(e){return Fi.fromWebStorageEntry(e)},e.prototype.handleMutationBatchEvent=function(e){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(t){return e.user.uid!==this.currentUser.uid?(p(Di,"Ignoring mutation for non-active user "+e.user.uid),[2]):[2,this.syncEngine.applyBatchState(e.batchId,e.state,e.error)]})})},e.prototype.handleQueryTargetEvent=function(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)},e.prototype.handleClientStateEvent=function(e,t){var n=this,r=this.getAllActiveQueryTargets();t?this.activeClients[e]=t:delete this.activeClients[e];var i=this.getAllActiveQueryTargets(),a=[],s=[];return i.forEach(function(e){return o.__awaiter(n,void 0,void 0,function(){return o.__generator(this,function(t){return r.has(e)||a.push(e),[2]})})}),r.forEach(function(e){return o.__awaiter(n,void 0,void 0,function(){return o.__generator(this,function(t){return i.has(e)||s.push(e),[2]})})}),this.syncEngine.applyActiveTargetsChange(a,s)},e.prototype.handleOnlineStateEvent=function(e){this.activeClients[e.clientId]&&this.onlineStateHandler(e.onlineState)},e}(),Bi=function(){function e(){this.localState=new Ui,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e.prototype.addPendingMutation=function(e){},e.prototype.updateMutationState=function(e,t,n){},e.prototype.addLocalQueryTarget=function(e){return this.localState.addQueryTarget(e),this.queryState[e]||"not-current"},e.prototype.updateQueryState=function(e,t,n){this.queryState[e]=t},e.prototype.removeLocalQueryTarget=function(e){this.localState.removeQueryTarget(e)},e.prototype.isLocalQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){delete this.queryState[e]},e.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},e.prototype.isActiveQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},e.prototype.start=function(){return this.localState=new Ui,Promise.resolve()},e.prototype.handleUserChange=function(e,t,n){},e.prototype.setOnlineState=function(e){},e.prototype.shutdown=function(){},e.prototype.writeSequenceNumber=function(e){},e}(),ji=function(){function e(e,t){this.cacheSizeBytes=e,this.synchronizeTabs=t}return e.prototype.lruParams=function(){return Dn.withCacheSize(this.cacheSizeBytes)},e}(),zi=function(){},Qi=function(){function e(e,t,n,r){this.platform=e,this.databaseInfo=t,this.credentials=n,this.asyncQueue=r,this.clientId=G.newId()}return e.prototype.start=function(e){var t=this;this.verifyNotTerminated();var n=new le,r=new le,i=!1;return this.credentials.setChangeListener(function(o){i?t.asyncQueue.enqueueAndForget(function(){return t.handleCredentialChange(o)}):(i=!0,t.initializePersistence(e,r,o).then(function(e){return t.initializeRest(o,e)}).then(n.resolve,n.reject))}),this.asyncQueue.enqueueAndForget(function(){return n.promise}),r.promise},e.prototype.enableNetwork=function(){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return e.syncEngine.enableNetwork()})},e.prototype.initializePersistence=function(e,t,n){var r=this;return e instanceof ji?this.startIndexedDbPersistence(n,e).then(function(e){return t.resolve(),e}).catch(function(e){if(t.reject(e),!r.canFallback(e))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),r.startMemoryPersistence()}):(t.resolve(),this.startMemoryPersistence())},e.prototype.canFallback=function(e){return e instanceof C?e.code===w.FAILED_PRECONDITION||e.code===w.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code},e.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new C(w.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.startIndexedDbPersistence=function(e,t){var n=this,r=Vn.buildStoragePrefix(this.databaseInfo),i=new yi(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return o.__awaiter(n,void 0,void 0,function(){var n,a;return o.__generator(this,function(o){switch(o.label){case 0:if(t.synchronizeTabs&&!qi.isAvailable(this.platform))throw new C(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return n=t.lruParams(),this.sharedClientState=t.synchronizeTabs?new qi(this.asyncQueue,this.platform,r,this.clientId,e):new Bi,[4,Vn.createIndexedDbPersistence({allowTabSynchronization:t.synchronizeTabs,persistenceKey:r,clientId:this.clientId,platform:this.platform,queue:this.asyncQueue,serializer:i,lruParams:n,sequenceNumberSyncer:this.sharedClientState})];case 1:return a=o.sent(),this.persistence=a,[2,a.referenceDelegate.garbageCollector]}})})})},e.prototype.startMemoryPersistence=function(){return this.persistence=Zn.createEagerPersistence(this.clientId),this.sharedClientState=new Bi,Promise.resolve(null)},e.prototype.initializeRest=function(e,t){var n=this;return p("FirestoreClient","Initializing. user=",e.uid),this.platform.loadConnection(this.databaseInfo).then(function(r){return o.__awaiter(n,void 0,void 0,function(){var n,i,a,s,u,c=this;return o.__generator(this,function(l){switch(l.label){case 0:return n=new er,this.localStore=new Wn(this.persistence,n,e),[4,this.localStore.start()];case 1:return l.sent(),t&&(this.lruScheduler=new Nn(t,this.asyncQueue,this.localStore)),i=this.platform.newConnectivityMonitor(),a=this.platform.newSerializer(this.databaseInfo.databaseId),s=new yr(this.asyncQueue,r,this.credentials,a),u=function(e){return c.syncEngine.applyOnlineStateChange(e,gr.SharedClientState)},this.remoteStore=new qr(this.localStore,s,this.asyncQueue,function(e){return c.syncEngine.applyOnlineStateChange(e,gr.RemoteStore)},i),this.syncEngine=new Ii(this.localStore,this.remoteStore,this.sharedClientState,e),this.sharedClientState.onlineStateHandler=u,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new mi(this.syncEngine),[4,this.sharedClientState.start()];case 2:return l.sent(),[4,this.remoteStore.start()];case 3:return l.sent(),[4,this.persistence.setPrimaryStateListener(function(e){return o.__awaiter(c,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return[4,this.syncEngine.applyPrimaryState(e)];case 1:return t.sent(),this.lruScheduler&&(e&&!this.lruScheduler.started?this.lruScheduler.start():e||this.lruScheduler.stop()),[2]}})})})];case 4:return l.sent(),[4,this.persistence.setDatabaseDeletedListener(function(){return o.__awaiter(c,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return[4,this.terminate()];case 1:return e.sent(),[2]}})})})];case 5:return l.sent(),[2]}})})})},e.prototype.handleCredentialChange=function(e){return this.asyncQueue.verifyOperationInProgress(),p("FirestoreClient","Credential Changed. Current user: "+e.uid),this.syncEngine.handleCredentialChange(e)},e.prototype.disableNetwork=function(){var e=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return e.syncEngine.disableNetwork()})},e.prototype.terminate=function(){var e=this;return this.asyncQueue.enqueueAndInitiateShutdown(function(){return o.__awaiter(e,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return e.sent(),[4,this.sharedClientState.shutdown()];case 2:return e.sent(),[4,this.persistence.shutdown()];case 3:return e.sent(),this.credentials.removeChangeListener(),[2]}})})})},e.prototype.waitForPendingWrites=function(){var e=this;this.verifyNotTerminated();var t=new le;return this.asyncQueue.enqueueAndForget(function(){return e.syncEngine.registerPendingWritesCallback(t)}),t.promise},e.prototype.listen=function(e,t,n){var r=this;this.verifyNotTerminated();var i=new gi(e,t,n);return this.asyncQueue.enqueueAndForget(function(){return r.eventMgr.listen(i)}),i},e.prototype.unlisten=function(e){var t=this;this.clientTerminated||this.asyncQueue.enqueueAndForget(function(){return t.eventMgr.unlisten(e)})},e.prototype.getDocumentFromLocalCache=function(e){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return t.localStore.readDocument(e)}).then(function(e){if(e instanceof jt)return e;if(e instanceof zt)return null;throw new C(w.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},e.prototype.getDocumentsFromLocalCache=function(e){var t=this;return this.verifyNotTerminated(),this.asyncQueue.enqueue(function(){return o.__awaiter(t,void 0,void 0,function(){var t,n,r;return o.__generator(this,function(i){switch(i.label){case 0:return[4,this.localStore.executeQuery(e,!0)];case 1:return t=i.sent(),n=new Ci(e,t.remoteKeys),r=n.computeDocChanges(t.documents),[2,n.applyChanges(r,!1).snapshot]}})})})},e.prototype.write=function(e){var t=this;this.verifyNotTerminated();var n=new le;return this.asyncQueue.enqueueAndForget(function(){return t.syncEngine.write(e,n)}),n.promise},e.prototype.databaseId=function(){return this.databaseInfo.databaseId},e.prototype.addSnapshotsInSyncListener=function(e){var t=this;this.verifyNotTerminated(),this.asyncQueue.enqueueAndForget(function(){return t.eventMgr.addSnapshotsInSyncListener(e),Promise.resolve()})},e.prototype.removeSnapshotsInSyncListener=function(e){this.clientTerminated||this.eventMgr.removeSnapshotsInSyncListener(e)},Object.defineProperty(e.prototype,"clientTerminated",{get:function(){return this.asyncQueue.isShuttingDown},enumerable:!0,configurable:!0}),e.prototype.transaction=function(e){var t=this;this.verifyNotTerminated();var n=new le;return this.asyncQueue.enqueueAndForget(function(){return t.syncEngine.runTransaction(t.asyncQueue,e,n),Promise.resolve()}),n.promise},e}(),Hi=function(){function e(e){this.observer=e,this.muted=!1}return e.prototype.next=function(e){this.scheduleEvent(this.observer.next,e)},e.prototype.error=function(e){this.scheduleEvent(this.observer.error,e)},e.prototype.mute=function(){this.muted=!0},e.prototype.scheduleEvent=function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)},e}(),Wi=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];!function(t,n,r,i){if(!(e instanceof Array)||e.length<1)throw new C(w.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+W(1,"element")+".")}();for(var n=0;n<e.length;++n)if(O("FieldPath","string",n,e[n]),0===e[n].length)throw new C(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ue(e)}return e.documentId=function(){return e._DOCUMENT_ID},e.prototype.isEqual=function(t){if(!(t instanceof e))throw Q("isEqual","FieldPath",1,t);return this._internalPath.isEqual(t._internalPath)},e._DOCUMENT_ID=new e(ue.keyField().canonicalString()),e}(),Gi=new RegExp("[~\\*/\\[\\]]"),Ki=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+e}},Yi=function(){function e(){this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(e){g(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,e(Ai.UNAUTHENTICATED)},e.prototype.removeChangeListener=function(){g(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},e}(),Zi=function(){function e(e){var t=this;this.app=e,this.tokenListener=null,this.currentUser=Ai.UNAUTHENTICATED,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){t.tokenCounter++,t.currentUser=t.getUser(),t.changeListener&&t.changeListener(t.currentUser)},this.currentUser=this.getUser(),this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return e.prototype.getToken=function(){var e=this;g(null!=this.tokenListener,"getToken cannot be called after listener removed.");var t=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(n).then(function(n){if(e.tokenCounter!==t)throw new C(w.ABORTED,"getToken aborted due to token change.");return n?(g("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new Ki(n.accessToken,e.currentUser)):null})},e.prototype.invalidateToken=function(){this.forceRefresh=!0},e.prototype.setChangeListener=function(e){g(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,e(this.currentUser)},e.prototype.removeChangeListener=function(){g(null!=this.tokenListener,"removeChangeListener() called twice"),g(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},e.prototype.getUser=function(){var e=this.app.INTERNAL.getUid();return g(null===e||"string"==typeof e,"Received invalid UID: "+e),new Ai(e)},e}(),Ji=function(){function e(e,t){this.gapi=e,this.sessionIndex=t,this.type="FirstParty",this.user=Ai.FIRST_PARTY}return Object.defineProperty(e.prototype,"authHeaders",{get:function(){var e={"X-Goog-AuthUser":this.sessionIndex},t=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),e},enumerable:!0,configurable:!0}),e}(),Xi=function(){function e(e,t){this.gapi=e,this.sessionIndex=t}return e.prototype.getToken=function(){return Promise.resolve(new Ji(this.gapi,this.sessionIndex))},e.prototype.setChangeListener=function(e){e(Ai.FIRST_PARTY)},e.prototype.removeChangeListener=function(){},e.prototype.invalidateToken=function(){},e}();function $i(e){if(!e)return new Yi;switch(e.type){case"gapi":var t=e.client;return g(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new Xi(t,e.sessionIndex||"0");case"provider":return e.client;default:throw new C(w.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function eo(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(e)}var to=function(){function e(e){this._methodName=e}return e.delete=function(){return D("FieldValue.delete",arguments),no.instance},e.serverTimestamp=function(){return D("FieldValue.serverTimestamp",arguments),ro.instance},e.arrayUnion=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return R("FieldValue.arrayUnion",arguments,1),new io(e)},e.arrayRemove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return R("FieldValue.arrayRemove",arguments,1),new oo(e)},e.increment=function(e){return O("FieldValue.increment","number",1,e),N("FieldValue.increment",arguments,1),new ao(e)},e.prototype.isEqual=function(e){return this===e},e}(),no=function(e){function t(){return e.call(this,"FieldValue.delete")||this}return o.__extends(t,e),t.instance=new t,t}(to),ro=function(e){function t(){return e.call(this,"FieldValue.serverTimestamp")||this}return o.__extends(t,e),t.instance=new t,t}(to),io=function(e){function t(t){var n=e.call(this,"FieldValue.arrayUnion")||this;return n._elements=t,n}return o.__extends(t,e),t}(to),oo=function(e){function t(t){var n=e.call(this,"FieldValue.arrayRemove")||this;return n._elements=t,n}return o.__extends(t,e),t}(to),ao=function(e){function t(t){var n=e.call(this,"FieldValue.increment")||this;return n._operand=t,n}return o.__extends(t,e),t}(to),so=k(to,"Use FieldValue.<field>() instead."),uo=/^__.*__$/,co=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutations=function(e,t){var n=[];return n.push(null!==this.fieldMask?new bt(e,this.data,this.fieldMask,t):new _t(e,this.data,t)),this.fieldTransforms.length>0&&n.push(new wt(e,this.fieldTransforms)),n},e}(),lo=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutations=function(e,t){var n=[new bt(e,this.data,this.fieldMask,t)];return this.fieldTransforms.length>0&&n.push(new wt(e,this.fieldTransforms)),n},e}(),ho=function(e){return e[e.Set=0]="Set",e[e.Update=1]="Update",e[e.MergeSet=2]="MergeSet",e[e.Argument=3]="Argument",e}({});function fo(e){switch(e){case ho.Set:case ho.MergeSet:case ho.Update:return!0;case ho.Argument:return!1;default:throw m("Unexpected case for UserDataSource: "+e)}}var po=function(){function e(e,t,n,r,i,o){this.dataSource=e,this.methodName=t,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return e.prototype.childContextForField=function(t){var n=null==this.path?null:this.path.child(t),r=new e(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(t),r},e.prototype.childContextForFieldPath=function(t){var n=null==this.path?null:this.path.child(t),r=new e(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},e.prototype.childContextForArray=function(t){return new e(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},e.prototype.createError=function(e){var t=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new C(w.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+e+t)},e.prototype.contains=function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})},e.prototype.validatePath=function(){if(null!==this.path)for(var e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))},e.prototype.validatePathSegment=function(e){if(fo(this.dataSource)&&uo.test(e))throw this.createError("Document fields cannot begin and end with __")},e}(),yo=function(e,t){this.databaseId=e,this.key=t},vo=function(){function e(e){this.preConverter=e}return e.prototype.parseSetData=function(e,t){var n=new po(ho.Set,e,ue.EMPTY_PATH);go("Data must be an object, but it was:",n,t);var r=this.parseData(t,n);return new co(r,null,n.fieldTransforms)},e.prototype.parseMergeData=function(e,t,n){var r=new po(ho.MergeSet,e,ue.EMPTY_PATH);go("Data must be an object, but it was:",r,t);var i,o,a=this.parseData(t,r);if(n){for(var s=new Ae(ue.comparator),u=0,c=n;u<c.length;u++){var l=c[u],h=void 0;if(l instanceof Wi)h=l._internalPath;else{if("string"!=typeof l)throw m("Expected stringOrFieldPath to be a string or a FieldPath");h=bo(e,l)}if(!r.contains(h))throw new C(w.INVALID_ARGUMENT,"Field '"+h+"' is specified in your field mask but missing from your input data.");s=s.add(h)}i=dt.fromSet(s),o=r.fieldTransforms.filter(function(e){return i.covers(e.field)})}else i=dt.fromArray(r.fieldMask),o=r.fieldTransforms;return new co(a,i,o)},e.prototype.parseUpdateData=function(e,t){var n=this,r=new po(ho.Update,e,ue.EMPTY_PATH);go("Data must be an object, but it was:",r,t);var i=new Ae(ue.comparator),o=Ut.EMPTY;I(t,function(t,a){var s=bo(e,t),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof no)i=i.add(s);else{var c=n.parseData(a,u);null!=c&&(i=i.add(s),o=o.set(s,c))}});var a=dt.fromSet(i);return new lo(o,a,r.fieldTransforms)},e.prototype.parseUpdateVarargs=function(e,t,n,r){var i=new po(ho.Update,e,ue.EMPTY_PATH),o=[_o(e,t)],a=[n];if(r.length%2!=0)throw new C(w.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(_o(e,r[s])),a.push(r[s+1]);var u=new Ae(ue.comparator),c=Ut.EMPTY;for(s=0;s<o.length;++s){var l=o[s],h=i.childContextForFieldPath(l),f=this.runPreConverter(a[s],h);if(f instanceof no)u=u.add(l);else{var d=this.parseData(f,h);null!=d&&(u=u.add(l),c=c.set(l,d))}}var p=dt.fromSet(u);return new lo(c,p,i.fieldTransforms)},e.prototype.parseQueryValue=function(e,t){var n=new po(ho.Argument,e,ue.EMPTY_PATH),r=this.parseData(t,n);return g(null!=r,"Parsed data should not be null."),g(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},e.prototype.runPreConverter=function(e,t){try{return this.preConverter(e)}catch(r){var n=wo(r);throw t.createError(n)}},e.prototype.parseData=function(e,t){if(mo(e=this.runPreConverter(e,t)))return go("Unsupported field value:",t,e),this.parseObject(e,t);if(e instanceof to)return this.parseSentinelFieldValue(e,t),null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.arrayElement)throw t.createError("Nested arrays are not supported");return this.parseArray(e,t)}return this.parseScalarValue(e,t)},e.prototype.parseObject=function(e,t){var n=this,r=new Se(K);return A(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):I(e,function(e,i){var o=n.parseData(i,t.childContextForField(e));null!=o&&(r=r.insert(e,o))}),new Ut(r)},e.prototype.parseArray=function(e,t){for(var n=[],r=0,i=0,o=e;i<o.length;i++){var a=this.parseData(o[i],t.childContextForArray(r));null==a&&(a=It.INSTANCE),n.push(a),r++}return new qt(n)},e.prototype.parseSentinelFieldValue=function(e,t){if(!fo(t.dataSource))throw t.createError(e._methodName+"() can only be used with update() and set()");if(null===t.path)throw t.createError(e._methodName+"() is not currently supported inside arrays");if(e instanceof no){if(t.dataSource!==ho.MergeSet)throw t.dataSource===ho.Update?(g(t.path.length>0,"FieldValue.delete() at the top level should have already been handled."),t.createError("FieldValue.delete() can only appear at the top level of your update data")):t.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");t.fieldMask.push(t.path)}else if(e instanceof ro)t.fieldTransforms.push(new pt(t.path,ni.instance));else if(e instanceof io){var n=this.parseArrayTransformElements(e._methodName,e._elements),r=new ri(n);t.fieldTransforms.push(new pt(t.path,r))}else if(e instanceof oo){n=this.parseArrayTransformElements(e._methodName,e._elements);var i=new ii(n);t.fieldTransforms.push(new pt(t.path,i))}else if(e instanceof ao){var o=this.parseQueryValue("FieldValue.increment",e._operand),a=new oi(o);t.fieldTransforms.push(new pt(t.path,a))}else m("Unknown FieldValue type: "+e)},e.prototype.parseScalarValue=function(e,t){if(null===e)return It.INSTANCE;if("number"==typeof e)return ar(e)?new Rt(e):new xt(e);if("boolean"==typeof e)return At.of(e);if("string"==typeof e)return new Ot(e);if(e instanceof Date)return new Pt(Ce.fromDate(e));if(e instanceof Ce)return new Pt(new Ce(e.seconds,1e3*Math.floor(e.nanoseconds/1e3)));if(e instanceof Br)return new Ft(e);if(e instanceof $)return new Lt(e);if(e instanceof yo)return new Vt(e.databaseId,e.key);throw t.createError("Unsupported field value: "+B(e))},e.prototype.parseArrayTransformElements=function(e,t){var n=this;return t.map(function(t,r){var i=new po(ho.Argument,e,ue.EMPTY_PATH);return n.parseData(t,i.childContextForArray(r))})},e}();function mo(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ce||e instanceof Br||e instanceof $||e instanceof yo||e instanceof to)}function go(e,t,n){if(!mo(n)||!q(n)){var r=B(n);throw t.createError("an object"===r?e+" a custom object":e+" "+r)}}function _o(e,t){if(t instanceof Wi)return t._internalPath;if("string"==typeof t)return bo(e,t);throw new C(w.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function bo(e,t){try{return function(e){if(e.search(Gi)>=0)throw new C(w.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Wi.bind.apply(Wi,o.__spreadArrays([void 0],e.split("."))))}catch(t){throw new C(w.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(t)._internalPath}catch(r){var n=wo(r);throw new C(w.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. "+n)}}function wo(e){return e instanceof Error?e.message:e.toString()}var Co="firestore.googleapis.com",ko=!0,So=!0,Eo=!1,To=Dn.COLLECTION_DISABLED,Io=function(){function e(e){if(void 0===e.host){if(void 0!==e.ssl)throw new C(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Co,this.ssl=ko}else M("settings","non-empty string","host",e.host),this.host=e.host,L("settings","boolean","ssl",e.ssl),this.ssl=E(e.ssl,ko);if(z("settings",e,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),L("settings","object","credentials",e.credentials),this.credentials=e.credentials,L("settings","boolean","timestampsInSnapshots",e.timestampsInSnapshots),!0===e.timestampsInSnapshots?y("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===e.timestampsInSnapshots&&y("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=E(e.timestampsInSnapshots,So),L("settings","number","cacheSizeBytes",e.cacheSizeBytes),void 0===e.cacheSizeBytes)this.cacheSizeBytes=Dn.DEFAULT_CACHE_SIZE_BYTES;else{if(e.cacheSizeBytes!==To&&e.cacheSizeBytes<Dn.MINIMUM_CACHE_SIZE_BYTES)throw new C(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Dn.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=e.cacheSizeBytes}L("settings","boolean","experimentalForceLongPolling",e.experimentalForceLongPolling),this.forceLongPolling=void 0===e.experimentalForceLongPolling?Eo:e.experimentalForceLongPolling}return e.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.timestampsInSnapshots===e.timestampsInSnapshots&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.forceLongPolling===e.forceLongPolling},e}(),Ao=function(){function e(t){var n=this;if(this._firebaseApp=null,this._queue=new de,this.INTERNAL={delete:function(){return o.__awaiter(n,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.terminate()];case 1:return e.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this._firebaseApp=r,this._databaseId=e.databaseIdFromApp(r),this._persistenceKey=r.name,this._credentials=new Zi(r)}else{var i=t;if(!i.projectId)throw new C(w.INVALID_ARGUMENT,"Must provide projectId");this._databaseId=new re(i.projectId,i.database),this._persistenceKey="[DEFAULT]",this._credentials=new Yi}this._settings=new Io({}),this._dataConverter=this.createDataConverter(this._databaseId)}return e.prototype.settings=function(e){if(N("Firestore.settings",arguments,1),O("Firestore.settings","object",1,e),S(e,"persistence"))throw new C(w.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var t=new Io(e);if(this._firestoreClient&&!this._settings.isEqual(t))throw new C(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._settings=t,void 0!==t.credentials&&(this._credentials=$i(t.credentials))},e.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},e.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},e.prototype.enablePersistence=function(e){if(this._firestoreClient)throw new C(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var t=!1;return e&&(void 0!==e.experimentalTabSynchronization&&y("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),t=E(void 0!==e.synchronizeTabs?e.synchronizeTabs:e.experimentalTabSynchronization,!1)),this.configureClient(new ji(this._settings.cacheSizeBytes,t))},e.prototype.clearPersistence=function(){var e=this,t=Vn.buildStoragePrefix(this.makeDatabaseInfo()),n=new le;return this._queue.enqueueAndForgetEvenAfterShutdown(function(){return o.__awaiter(e,void 0,void 0,function(){var e;return o.__generator(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientTerminated)throw new C(w.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,Vn.clearPersistence(t)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(e.prototype,"_isTerminated",{get:function(){return this.ensureClientConfigured(),this._firestoreClient.clientTerminated},enumerable:!0,configurable:!0}),e.prototype.waitForPendingWrites=function(){return this.ensureClientConfigured(),this._firestoreClient.waitForPendingWrites()},e.prototype.onSnapshotsInSync=function(e){return this.ensureClientConfigured(),eo(e)?this.onSnapshotsInSyncInternal(e):(O("Firestore.onSnapshotsInSync","function",1,e),this.onSnapshotsInSyncInternal({next:e}))},e.prototype.onSnapshotsInSyncInternal=function(e){var t=this,n=new Hi({next:function(){e.next&&e.next()},error:function(e){throw m("Uncaught Error in onSnapshotsInSync")}});return this._firestoreClient.addSnapshotsInSyncListener(n),function(){n.mute(),t._firestoreClient.removeSnapshotsInSyncListener(n)}},e.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new zi),this._firestoreClient},e.prototype.makeDatabaseInfo=function(){return new te(this._databaseId,this._persistenceKey,this._settings.host,this._settings.ssl,this._settings.forceLongPolling)},e.prototype.configureClient=function(e){g(!!this._settings.host,"FirestoreSettings.host is not set"),g(!this._firestoreClient,"configureClient() called multiple times");var t=this.makeDatabaseInfo();return this._firestoreClient=new Qi(_.getPlatform(),t,this._credentials,this._queue),this._firestoreClient.start(e)},e.prototype.createDataConverter=function(e){return new vo(function(t){if(t instanceof Ro){var n=e,r=t.firestore._databaseId;if(!r.isEqual(n))throw new C(w.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new yo(e,t._key)}return t})},e.databaseIdFromApp=function(e){var t=e.options;if(!S(t,"projectId"))throw new C(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=t.projectId;if(!n||"string"!=typeof n)throw new C(w.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new re(n)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this._firebaseApp)throw new C(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._firebaseApp},enumerable:!0,configurable:!0}),e.prototype.collection=function(e){return N("Firestore.collection",arguments,1),O("Firestore.collection","non-empty string",1,e),this.ensureClientConfigured(),new Vo(ae.fromString(e),this)},e.prototype.doc=function(e){return N("Firestore.doc",arguments,1),O("Firestore.doc","non-empty string",1,e),this.ensureClientConfigured(),Ro.forPath(ae.fromString(e),this)},e.prototype.collectionGroup=function(e){if(N("Firestore.collectionGroup",arguments,1),O("Firestore.collectionGroup","non-empty string",1,e),e.indexOf("/")>=0)throw new C(w.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new Mo(new jr(ae.EMPTY_PATH,e),this)},e.prototype.runTransaction=function(e){var t=this;return N("Firestore.runTransaction",arguments,1),O("Firestore.runTransaction","function",1,e),this.ensureClientConfigured().transaction(function(n){return e(new Do(t,n))})},e.prototype.batch=function(){return this.ensureClientConfigured(),new No(this)},Object.defineProperty(e,"logLevel",{get:function(){switch(f()){case h.DEBUG:return"debug";case h.ERROR:return"error";case h.SILENT:return"silent";default:return m("Unknown log level: "+f())}},enumerable:!0,configurable:!0}),e.setLogLevel=function(e){switch(N("Firestore.setLogLevel",arguments,1),O("Firestore.setLogLevel","non-empty string",1,e),e){case"debug":d(h.DEBUG);break;case"error":d(h.ERROR);break;case"silent":d(h.SILENT);break;default:throw new C(w.INVALID_ARGUMENT,"Invalid log level: "+e)}},e.prototype._areTimestampsInSnapshotsEnabled=function(){return this._settings.timestampsInSnapshots},e}(),Do=function(){function e(e,t){this._firestore=e,this._transaction=t}return e.prototype.get=function(e){var t=this;N("Transaction.get",arguments,1);var n=Bo("Transaction.get",e,this._firestore);return this._transaction.lookup([n._key]).then(function(e){if(!e||1!==e.length)return m("Mismatch in docs returned from document lookup.");var r=e[0];if(r instanceof zt)return new Oo(t._firestore,n._key,null,!1,!1);if(r instanceof jt)return new Oo(t._firestore,n._key,r,!1,!1);throw m("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)})},e.prototype.set=function(e,t,n){x("Transaction.set",arguments,2,3);var r=Bo("Transaction.set",e,this._firestore),i=(n=Fo("Transaction.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",t,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",t);return this._transaction.set(r._key,i),this},e.prototype.update=function(e,t,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"==typeof t||t instanceof Wi?(R("Transaction.update",arguments,3),r=Bo("Transaction.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",t,n,o)):(N("Transaction.update",arguments,2),r=Bo("Transaction.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateData("Transaction.update",t)),this._transaction.update(r._key,i),this},e.prototype.delete=function(e){N("Transaction.delete",arguments,1);var t=Bo("Transaction.delete",e,this._firestore);return this._transaction.delete(t._key),this},e}(),No=function(){function e(e){this._firestore=e,this._mutations=[],this._committed=!1}return e.prototype.set=function(e,t,n){x("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=Bo("WriteBatch.set",e,this._firestore),i=(n=Fo("WriteBatch.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",t,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",t);return this._mutations=this._mutations.concat(i.toMutations(r._key,mt.NONE)),this},e.prototype.update=function(e,t,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),"string"==typeof t||t instanceof Wi?(R("WriteBatch.update",arguments,3),r=Bo("WriteBatch.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",t,n,o)):(N("WriteBatch.update",arguments,2),r=Bo("WriteBatch.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",t)),this._mutations=this._mutations.concat(i.toMutations(r._key,mt.exists(!0))),this},e.prototype.delete=function(e){N("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var t=Bo("WriteBatch.delete",e,this._firestore);return this._mutations=this._mutations.concat(new Ct(t._key,mt.NONE)),this},e.prototype.commit=function(){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},e.prototype.verifyNotCommitted=function(){if(this._committed)throw new C(w.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}(),Ro=function(){function e(e,t){this._key=e,this.firestore=t,this._firestoreClient=this.firestore.ensureClientConfigured()}return e.forPath=function(t,n){if(t.length%2!=0)throw new C(w.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(new ce(t),n)},Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Vo(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.collection=function(e){if(N("DocumentReference.collection",arguments,1),O("DocumentReference.collection","non-empty string",1,e),!e)throw new C(w.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var t=ae.fromString(e);return new Vo(this._key.path.child(t),this.firestore)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw Q("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this._key.isEqual(t._key)},e.prototype.set=function(e,t){x("DocumentReference.set",arguments,1,2);var n=(t=Fo("DocumentReference.set",t)).merge||t.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",e,t.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",e);return this._firestoreClient.write(n.toMutations(this._key,mt.NONE))},e.prototype.update=function(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof e||e instanceof Wi?(R("DocumentReference.update",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",e,t,r)):(N("DocumentReference.update",arguments,1),n=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",e)),this._firestoreClient.write(n.toMutations(this._key,mt.exists(!0)))},e.prototype.delete=function(){return N("DocumentReference.delete",arguments,0),this._firestoreClient.write([new Ct(this._key,mt.NONE)])},e.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];x("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof e[i]||eo(e[i])||(z("DocumentReference.onSnapshot",r=e[i],["includeMetadataChanges"]),L("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return eo(e[i])?n=e[i]:(O("DocumentReference.onSnapshot","function",i,e[i]),P("DocumentReference.onSnapshot","function",i+1,e[i+1]),P("DocumentReference.onSnapshot","function",i+2,e[i+2]),n={next:e[i],error:e[i+1],complete:e[i+2]}),this.onSnapshotInternal(o,n)},e.prototype.onSnapshotInternal=function(e,t){var n=this,r=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(r=t.error.bind(t));var i=new Hi({next:function(e){if(t.next){g(e.docs.size<=1,"Too many documents returned on a document query");var r=e.docs.get(n._key);t.next(new Oo(n.firestore,n._key,r,e.fromCache,e.hasPendingWrites))}},error:r}),o=this._firestoreClient.listen(jr.atPath(this._key.path),i,e);return function(){i.mute(),n._firestoreClient.unlisten(o)}},e.prototype.get=function(e){var t=this;return x("DocumentReference.get",arguments,0,1),qo("DocumentReference.get",e),new Promise(function(n,r){e&&"cache"===e.source?t.firestore.ensureClientConfigured().getDocumentFromLocalCache(t._key).then(function(e){n(new Oo(t.firestore,t._key,e,!0,e instanceof jt&&e.hasLocalMutations))},r):t.getViaSnapshotListener(n,r,e)})},e.prototype.getViaSnapshotListener=function(e,t,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?t(new C(w.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?t(new C(w.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(i)},error:t})},e}(),xo=function(){function e(e,t){this.hasPendingWrites=e,this.fromCache=t}return e.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},e}(),Oo=function(){function e(e,t,n,r,i){this._firestore=e,this._key=t,this._document=n,this._fromCache=r,this._hasPendingWrites=i}return e.prototype.data=function(e){return x("DocumentSnapshot.data",arguments,0,1),e=Uo("DocumentSnapshot.data",e),this._document?this.convertObject(this._document.data(),Et.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},e.prototype.get=function(e,t){if(x("DocumentSnapshot.get",arguments,1,2),t=Uo("DocumentSnapshot.get",t),this._document){var n=this._document.data().field(_o("DocumentSnapshot.get",e));if(null!==n)return this.convertValue(n,Et.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new Ro(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return new xo(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){if(!(t instanceof e))throw Q("isEqual","DocumentSnapshot",1,t);return this._firestore===t._firestore&&this._fromCache===t._fromCache&&this._key.isEqual(t._key)&&(null===this._document?null===t._document:this._document.isEqual(t._document))},e.prototype.convertObject=function(e,t){var n=this,r={};return e.forEach(function(e,i){r[e]=n.convertValue(i,t)}),r},e.prototype.convertValue=function(e,t){if(e instanceof Ut)return this.convertObject(e,t);if(e instanceof qt)return this.convertArray(e,t);if(e instanceof Vt){var n=e.value(t),r=this._firestore.ensureClientConfigured().databaseId();return e.databaseId.isEqual(r)||y("Document "+this._key.path+" contains a document reference within a different database ("+e.databaseId.projectId+"/"+e.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new Ro(n,this._firestore)}return e.value(t)},e.prototype.convertArray=function(e,t){var n=this;return e.internalValue.map(function(e){return n.convertValue(e,t)})},e}(),Po=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.data=function(t){var n=e.prototype.data.call(this,t);return g("object"==typeof n,"Document in a QueryDocumentSnapshot should exist"),n},t}(Oo),Mo=function(){function e(e,t){this._query=e,this.firestore=t}return e.prototype.where=function(t,n,r){if(N("Query.where",arguments,3),j("Query.where",3,r),"in"!==n&&"array-contains-any"!==n){var i=["<","<=","==",">=",">","array-contains"];F("Query.where",i,2,n)}var o,a=_o("Query.where",t),s=Qr.fromString(n);if(a.isKeyField()){if(s===Qr.ARRAY_CONTAINS||s===Qr.ARRAY_CONTAINS_ANY)throw new C(w.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+s.toString()+"' queries on FieldPath.documentId().");if(s===Qr.IN){this.validateDisjunctiveFilterElements(r,s);for(var u=[],c=0,l=r;c<l.length;c++){var h=l[c];u.push(this.parseDocumentIdValue(h))}o=new qt(u)}else o=this.parseDocumentIdValue(r)}else s!==Qr.IN&&s!==Qr.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(r,s),o=this.firestore._dataConverter.parseQueryValue("Query.where",r);var f=Hr.create(a,s,o);return this.validateNewFilter(f),new e(this._query.addFilter(f),this.firestore)},e.prototype.orderBy=function(t,n){var r;if(x("Query.orderBy",arguments,1,2),P("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=Jr.ASCENDING;else{if("desc"!==n)throw new C(w.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=Jr.DESCENDING}if(null!==this._query.startAt)throw new C(w.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new C(w.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=_o("Query.orderBy",t),o=new $r(i,r);return this.validateNewOrderBy(o),new e(this._query.addOrderBy(o),this.firestore)},e.prototype.limit=function(t){if(N("Query.limit",arguments,1),O("Query.limit","number",1,t),t<=0)throw new C(w.INVALID_ARGUMENT,"Invalid Query. Query limit ("+t+") is invalid. Limit must be positive.");return new e(this._query.withLimit(t),this.firestore)},e.prototype.startAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];R("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",t,n,!0);return new e(this._query.withStartAt(i),this.firestore)},e.prototype.startAfter=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];R("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",t,n,!1);return new e(this._query.withStartAt(i),this.firestore)},e.prototype.endBefore=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];R("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",t,n,!0);return new e(this._query.withEndAt(i),this.firestore)},e.prototype.endAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];R("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",t,n,!1);return new e(this._query.withEndAt(i),this.firestore)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw Q("isEqual","Query",1,t);return this.firestore===t.firestore&&this._query.isEqual(t._query)},e.prototype.boundFromDocOrFields=function(e,t,n,r){if(j(e,1,t),t instanceof Oo){if(n.length>0)throw new C(w.INVALID_ARGUMENT,"Too many arguments provided to "+e+"().");var i=t;if(!i.exists)throw new C(w.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+e+"().");return this.boundFromDocument(e,i._document,r)}var o=[t].concat(n);return this.boundFromFields(e,o,r)},e.prototype.boundFromDocument=function(e,t,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Vt(this.firestore._databaseId,t.key));else{var s=t.field(a.field);if(s instanceof Mt)throw new C(w.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=a.field.canonicalString();throw new C(w.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new Xr(r,n)},e.prototype.boundFromFields=function(e,t,n){var r=this._query.explicitOrderBy;if(t.length>r.length)throw new C(w.INVALID_ARGUMENT,"Too many arguments provided to "+e+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<t.length;o++){var a=t[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new C(w.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+e+"(), but got a "+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf("/"))throw new C(w.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+e+"() must be a plain document ID, but '"+a+"' contains a slash.");var s=this._query.path.child(ae.fromString(a));if(!ce.isDocumentKey(s))throw new C(w.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+e+"() must result in a valid document path, but '"+s+"' is not because it contains an odd number of segments.");var u=new ce(s);i.push(new Vt(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(e,a);i.push(c)}}return new Xr(i,n)},e.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];x("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof e[i]||eo(e[i])||(z("Query.onSnapshot",r=e[i],["includeMetadataChanges"]),L("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),eo(e[i])?n=e[i]:(O("Query.onSnapshot","function",i,e[i]),P("Query.onSnapshot","function",i+1,e[i+1]),P("Query.onSnapshot","function",i+2,e[i+2]),n={next:e[i],error:e[i+1],complete:e[i+2]}),this.onSnapshotInternal(r,n)},e.prototype.onSnapshotInternal=function(e,t){var n=this,r=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(r=t.error.bind(t));var i=new Hi({next:function(e){t.next&&t.next(new Lo(n.firestore,n._query,e))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,e);return function(){i.mute(),o.unlisten(a)}},e.prototype.get=function(e){var t=this;return x("Query.get",arguments,0,1),qo("Query.get",e),new Promise(function(n,r){e&&"cache"===e.source?t.firestore.ensureClientConfigured().getDocumentsFromLocalCache(t._query).then(function(e){n(new Lo(t.firestore,t._query,e))},r):t.getViaSnapshotListener(n,r,e)})},e.prototype.getViaSnapshotListener=function(e,t,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?t(new C(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(i)},error:t})},e.prototype.parseDocumentIdValue=function(e){if("string"==typeof e){if(""===e)throw new C(w.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==e.indexOf("/"))throw new C(w.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+e+"' contains a '/' character.");var t=this._query.path.child(ae.fromString(e));if(!ce.isDocumentKey(t))throw new C(w.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+t+"' is not because it has an odd number of segments ("+t.length+").");return new Vt(this.firestore._databaseId,new ce(t))}if(e instanceof Ro)return new Vt(this.firestore._databaseId,e._key);throw new C(w.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+B(e)+".")},e.prototype.validateDisjunctiveFilterElements=function(e,t){if(!Array.isArray(e)||0===e.length)throw new C(w.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(e.length>10)throw new C(w.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.");if(e.indexOf(null)>=0)throw new C(w.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters cannot contain 'null' in the value array.");if(e.filter(function(e){return Number.isNaN(e)}).length>0)throw new C(w.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters cannot contain 'NaN' in the value array.")},e.prototype.validateNewFilter=function(e){if(e instanceof Hr){var t=[Qr.ARRAY_CONTAINS,Qr.ARRAY_CONTAINS_ANY],n=[Qr.IN,Qr.ARRAY_CONTAINS_ANY],r=t.indexOf(e.op)>=0,i=n.indexOf(e.op)>=0;if(e.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(e.field))throw new C(w.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+e.field.toString()+"'");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(e.field,a)}else if(i||r){var s=null;if(i&&(s=this._query.findFilterOperator(n)),null===s&&r&&(s=this._query.findFilterOperator(t)),null!=s)throw new C(w.INVALID_ARGUMENT,s===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},e.prototype.validateNewOrderBy=function(e){if(null===this._query.getFirstOrderByField()){var t=this._query.getInequalityFilterField();null!==t&&this.validateOrderByAndInequalityMatch(t,e.field)}},e.prototype.validateOrderByAndInequalityMatch=function(e,t){if(!t.isEqual(e))throw new C(w.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+t.toString()+"' instead.")},e}(),Lo=function(){function e(e,t,n){this._firestore=e,this._originalQuery=t,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new xo(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(e.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e,t){var n=this;x("QuerySnapshot.forEach",arguments,1,2),O("QuerySnapshot.forEach","function",1,e),this._snapshot.docs.forEach(function(r){e.call(t,n.convertToDocumentImpl(r))})},Object.defineProperty(e.prototype,"query",{get:function(){return new Mo(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),e.prototype.docChanges=function(e){e&&(z("QuerySnapshot.docChanges",e,["includeMetadataChanges"]),L("QuerySnapshot.docChanges","boolean","includeMetadataChanges",e.includeMetadataChanges));var t=!(!e||!e.includeMetadataChanges);if(t&&this._snapshot.excludesMetadataChanges)throw new C(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t,n){if(n.oldDocs.isEmpty()){var r,i=0;return n.docChanges.map(function(t){var o=new Po(e,t.doc.key,t.doc,n.fromCache,n.mutatedKeys.has(t.doc.key));return g(t.type===Er.Added,"Invalid event type for first snapshot"),g(!r||n.query.docComparator(r,t.doc)<0,"Got added events in wrong order"),r=t.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.oldDocs;return n.docChanges.filter(function(e){return t||e.type!==Er.Metadata}).map(function(t){var r=new Po(e,t.doc.key,t.doc,n.fromCache,n.mutatedKeys.has(t.doc.key)),i=-1,a=-1;return t.type!==Er.Added&&(g((i=o.indexOf(t.doc.key))>=0,"Index for document not found"),o=o.delete(t.doc.key)),t.type!==Er.Removed&&(a=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:jo(t.type),doc:r,oldIndex:i,newIndex:a}})}(this._firestore,t,this._snapshot),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},e.prototype.isEqual=function(t){if(!(t instanceof e))throw Q("isEqual","QuerySnapshot",1,t);return this._firestore===t._firestore&&this._originalQuery.isEqual(t._originalQuery)&&this._snapshot.isEqual(t._snapshot)},e.prototype.convertToDocumentImpl=function(e){return new Po(this._firestore,e.key,e,this.metadata.fromCache,this._snapshot.mutatedKeys.has(e.key))},e}();o.__spreadArrays(["length","forEach","map"],"undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach(function(e){try{Object.defineProperty(Lo.prototype.docChanges,e,{get:function(){return function(){throw new C(w.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}});var Vo=function(e){function t(t,n){var r=e.call(this,jr.atPath(t),n)||this;if(t.length%2!=1)throw new C(w.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.canonicalString()+" has "+t.length);return r}return o.__extends(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._query.path.popLast();return e.isEmpty()?null:new Ro(new ce(e),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.doc=function(e){if(x("CollectionReference.doc",arguments,0,1),0===arguments.length&&(e=G.newId()),O("CollectionReference.doc","non-empty string",1,e),""===e)throw new C(w.INVALID_ARGUMENT,"Document path must be a non-empty string");var t=ae.fromString(e);return Ro.forPath(this._query.path.child(t),this.firestore)},t.prototype.add=function(e){N("CollectionReference.add",arguments,1),O("CollectionReference.add","object",1,e);var t=this.doc();return t.set(e).then(function(){return t})},t}(Mo);function Fo(e,t){if(void 0===t)return{merge:!1};if(z(e,t,["merge","mergeFields"]),L(e,"boolean","merge",t.merge),void 0!==(n=t.mergeFields)&&function(e,t,n,r,i){if(!(r instanceof Array))throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires its mergeFields option to be an array, but it was: "+B(r));for(var o=0;o<r.length;++o)if(!("string"==typeof(a=r[o])||a instanceof Wi))throw new C(w.INVALID_ARGUMENT,"Function "+e+"() requires all mergeFields elements to be a string or a FieldPath, but the value at index "+o+" was: "+B(r[o]));var a}(e,0,0,n),void 0!==t.mergeFields&&void 0!==t.merge)throw new C(w.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');var n;return t}function Uo(e,t){return void 0===t?{}:(z(e,t,["serverTimestamps"]),V(e,0,"serverTimestamps",t.serverTimestamps,["estimate","previous","none"]),t)}function qo(e,t){P(e,"object",1,t),t&&(z(e,t,["source"]),V(e,0,"source",t.source,["default","server","cache"]))}function Bo(e,t,n){if(t instanceof Ro){if(t.firestore!==n)throw new C(w.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}throw Q(e,"DocumentReference",1,t)}function jo(e){switch(e){case Er.Added:return"added";case Er.Modified:case Er.Metadata:return"modified";case Er.Removed:return"removed";default:return m("Unknown change type: "+e)}}var zo=k(Ao,"Use firebase.firestore() instead."),Qo=k(Do,"Use firebase.firestore().runTransaction() instead."),Ho=k(No,"Use firebase.firestore().batch() instead."),Wo=k(Ro,"Use firebase.firestore().doc() instead."),Go=k(Oo),Ko=k(Po),Yo=k(Mo),Zo=k(Lo),Jo=k(Vo,"Use firebase.firestore().collection() instead."),Xo={Firestore:zo,GeoPoint:Br,Timestamp:Ce,Blob:ee,Transaction:Qo,WriteBatch:Ho,DocumentReference:Wo,DocumentSnapshot:Go,Query:Yo,QueryDocumentSnapshot:Ko,QuerySnapshot:Zo,CollectionReference:Jo,FieldPath:Wi,FieldValue:so,setLogLevel:Ao.setLogLevel,CACHE_SIZE_UNLIMITED:To},$o=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.shutdown=function(){},e}(),ea=function(){function e(){var e=this;this.networkAvailableListener=function(){return e.onNetworkAvailable()},this.networkUnavailableListener=function(){return e.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return e.prototype.addCallback=function(e){this.callbacks.push(e)},e.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},e.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},e.prototype.onNetworkAvailable=function(){p("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++)(0,t[e])(0)},e.prototype.onNetworkUnavailable=function(){p("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var e=0,t=this.callbacks;e<t.length;e++)(0,t[e])(1)},e.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},e}(),ta=function(){function e(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}return e.prototype.onOpen=function(e){g(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=e},e.prototype.onClose=function(e){g(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=e},e.prototype.onMessage=function(e){g(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=e},e.prototype.close=function(){this.closeFn()},e.prototype.send=function(e){this.sendFn(e)},e.prototype.callOnOpen=function(){g(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},e.prototype.callOnClose=function(e){g(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(e)},e.prototype.callOnMessage=function(e){g(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(e)},e}(),na="Connection",ra={BatchGetDocuments:"batchGet",Commit:"commit"},ia="gl-js/ fire/"+c,oa=function(){function e(e){this.databaseId=e.databaseId,this.baseUrl=(e.ssl?"https":"http")+"://"+e.host,this.forceLongPolling=e.forceLongPolling}return e.prototype.modifyHeadersForRequest=function(e,t){if(t)for(var n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n]);e["X-Goog-Api-Client"]=ia},e.prototype.invokeRPC=function(e,t,n){var r=this,i=this.makeUrl(e);return new Promise(function(a,s){var c=new u.XhrIo;c.listenOnce(u.EventType.COMPLETE,function(){try{switch(c.getLastErrorCode()){case u.ErrorCode.NO_ERROR:var t=c.getResponseJson();p(na,"XHR received:",JSON.stringify(t)),a(t);break;case u.ErrorCode.TIMEOUT:p(na,'RPC "'+e+'" timed out'),s(new C(w.DEADLINE_EXCEEDED,"Request time out"));break;case u.ErrorCode.HTTP_ERROR:var n=c.getStatus();if(p(na,'RPC "'+e+'" failed with status:',n,"response text:",c.getResponseText()),n>0){var r=c.getResponseJson().error;if(r&&r.status&&r.message){var i=(o=r.status.toLowerCase().replace("_","-"),Object.values(w).indexOf(o)>=0?o:w.UNKNOWN);s(new C(i,r.message))}else s(new C(w.UNKNOWN,"Server responded with status "+c.getStatus()))}else p(na,'RPC "'+e+'" failed'),s(new C(w.UNAVAILABLE,"Connection failed."));break;default:m('RPC "'+e+'" failed with unanticipated webchannel error '+c.getLastErrorCode()+": "+c.getLastError()+", giving up.")}}finally{p(na,'RPC "'+e+'" completed.')}var o});var l=o.__assign({},t);delete l.database;var h=JSON.stringify(l);p(na,"XHR sending: ",i+" "+h);var f={"Content-Type":"text/plain"};r.modifyHeadersForRequest(f,n),c.send(i,"POST",h,f,15)})},e.prototype.invokeStreamingRPC=function(e,t,n){return this.invokeRPC(e,t,n)},e.prototype.openStream=function(e,t){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=u.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,t),s.isReactNative()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");p(na,"Creating WebChannel: "+o+" "+i);var a=r.createWebChannel(o,i),c=!1,l=!1,h=new ta({sendFn:function(e){l?p(na,"Not sending because WebChannel is closed:",e):(c||(p(na,"Opening WebChannel transport."),a.open(),c=!0),p(na,"WebChannel sending:",e),a.send(e))},closeFn:function(){return a.close()}}),f=function(e,t){a.listen(e,function(e){try{t(e)}catch(n){setTimeout(function(){throw n},0)}})};return f(u.WebChannel.EventType.OPEN,function(){l||p(na,"WebChannel transport opened.")}),f(u.WebChannel.EventType.CLOSE,function(){l||(l=!0,p(na,"WebChannel transport closed"),h.callOnClose())}),f(u.WebChannel.EventType.ERROR,function(e){l||(l=!0,p(na,"WebChannel transport errored:",e),h.callOnClose(new C(w.UNAVAILABLE,"The operation could not be completed")))}),f(u.WebChannel.EventType.MESSAGE,function(e){if(!l){var t=e.data[0];g(!!t,"Got a webchannel message without data.");var n=t.error||t[0]&&t[0].error;if(n){p(na,"WebChannel received error:",n);var r=n.status,i=function(e){var t=br[r];if(void 0!==t)return Cr(t)}(),o=n.message;void 0===i&&(i=w.INTERNAL,o="Unknown error status: "+r+" with message "+n.message),l=!0,h.callOnClose(new C(i,o)),a.close()}else p(na,"WebChannel received:",t),h.callOnMessage(t)}}),setTimeout(function(){h.callOnOpen()},0),h},e.prototype.makeUrl=function(e){var t=ra[e];g(void 0!==t,"Unknown REST mapping for: "+e);var n=[this.baseUrl,"/","v1"];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(t),n.join("")},e}();function aa(e){e.INTERNAL.registerService("firestore",function(e){return new Ao(e)},function(e){g(e&&"object"==typeof e,"shallowCopy() expects object parameter.");var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}(Xo))}_.setPlatform(new(function(){function e(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return Object.defineProperty(e.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),e.prototype.loadConnection=function(e){return Promise.resolve(new oa(e))},e.prototype.newConnectivityMonitor=function(){return ea.isAvailable()?new ea:new $o},e.prototype.newSerializer=function(e){return new yi(e,{useProto3Json:!0})},e.prototype.formatJSON=function(e){return JSON.stringify(e)},e.prototype.atob=function(e){return atob(e)},e.prototype.btoa=function(e){return btoa(e)},e}())),aa(i),t.registerFirestore=aa},Wcq6:function(e,t,n){"use strict";var r,i=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r;e.exports=i},mrSG:function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",function(){return i}),n.d(t,"__assign",function(){return o}),n.d(t,"__rest",function(){return a}),n.d(t,"__decorate",function(){return s}),n.d(t,"__param",function(){return u}),n.d(t,"__metadata",function(){return c}),n.d(t,"__awaiter",function(){return l}),n.d(t,"__generator",function(){return h}),n.d(t,"__exportStar",function(){return f}),n.d(t,"__values",function(){return d}),n.d(t,"__read",function(){return p}),n.d(t,"__spread",function(){return y}),n.d(t,"__spreadArrays",function(){return v}),n.d(t,"__await",function(){return m}),n.d(t,"__asyncGenerator",function(){return g}),n.d(t,"__asyncDelegator",function(){return _}),n.d(t,"__asyncValues",function(){return b}),n.d(t,"__makeTemplateObject",function(){return w}),n.d(t,"__importStar",function(){return C}),n.d(t,"__importDefault",function(){return k});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})}function h(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function f(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function d(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function v(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function g(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{(n=i[e](t)).value instanceof m?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(r){l(o[0][3],r)}var n}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function _(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:m(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function b(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=d(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function k(e){return e&&e.__esModule?e:{default:e}}},"q/0M":function(e,t,n){"use strict";function r(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}n.r(t),n.d(t,"LogLevel",function(){return o}),n.d(t,"Logger",function(){return u}),n.d(t,"setLogLevel",function(){return c});var i=[],o=function(e){return e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",e}({}),a=o.INFO,s=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(t<e.logLevel)){var a=(new Date).toISOString();switch(t){case o.DEBUG:case o.VERBOSE:console.log.apply(console,r(["["+a+"]  "+e.name+":"],n));break;case o.INFO:console.info.apply(console,r(["["+a+"]  "+e.name+":"],n));break;case o.WARN:console.warn.apply(console,r(["["+a+"]  "+e.name+":"],n));break;case o.ERROR:console.error.apply(console,r(["["+a+"]  "+e.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}}},u=function(){function e(e){this.name=e,this._logLevel=a,this._logHandler=s,i.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in o))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,o.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,o.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,o.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,o.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,r([this,o.ERROR],e))},e}();function c(e){i.forEach(function(t){t.logLevel=e})}},wj3C:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n("mrSG"),o=n("zVF4"),a=n("q/0M"),s=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r),u=new o.ErrorFactory("app","Firebase",s),c="[DEFAULT]",l=function(){function e(e,t,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.services_={},this.tokenListeners_=[],this.analyticsEventRequests_=[],this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=o.deepCopy(e);var i=this;this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){r.tokenListeners_.push(e),setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(e){r.tokenListeners_=r.tokenListeners_.filter(function(t){return t!==e})},analytics:{logEvent:function(){i.analyticsEventRequests_.push(arguments)}}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(t){e.checkDestroyed_(),t()}).then(function(){e.firebase_.INTERNAL.removeApp(e.name_);for(var t=[],n=0,r=Object.keys(e.services_);n<r.length;n++)for(var i=r[n],o=0,a=Object.keys(e.services_[i]);o<a.length;o++)t.push(e.services_[i][a[o]]);return Promise.all(t.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()}))}).then(function(){e.isDeleted_=!0,e.services_={}})},e.prototype._getService=function(e,t){if(void 0===t&&(t=c),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){var n=t!==c?t:void 0,r=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.services_[e][t]=r}return this.services_[e][t]},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t=c),this.services_[e]&&this.services_[e][t]&&delete this.services_[e][t]},e.prototype.extendApp=function(e){if(o.deepExtend(this,e),e.INTERNAL){if(e.INTERNAL.addAuthTokenListener){for(var t=0,n=this.tokenListeners_;t<n.length;t++)this.INTERNAL.addAuthTokenListener(n[t]);this.tokenListeners_=[]}if(e.INTERNAL.analytics){for(var r=0,i=this.analyticsEventRequests_;r<i.length;r++)this.INTERNAL.analytics.logEvent.apply(void 0,i[r]);this.analyticsEventRequests_=[]}}},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw u.create("app-deleted",{appName:this.name_})},e}();l.prototype.name&&l.prototype.options||l.prototype.delete||console.log("dc");var h=new a.Logger("@firebase/app");if(o.isBrowser()&&void 0!==self.firebase){h.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var f=self.firebase.SDK_VERSION;f&&f.indexOf("LITE")>=0&&h.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var d=function e(){var t=function(e){var t={},n={},r={},i={__esModule:!0,initializeApp:function(n,r){void 0===r&&(r={}),"object"==typeof r&&null!==r||(r={name:r});var a=r;void 0===a.name&&(a.name=c);var s=a.name;if("string"!=typeof s||!s)throw u.create("bad-app-name",{appName:String(s)});if(o.contains(t,s))throw u.create("duplicate-app",{appName:s});var h=new e(n,a,i);return t[s]=h,l(h,"create"),h},app:a,apps:null,SDK_VERSION:"7.2.1",INTERNAL:{registerService:function(t,c,l,f,d){if(void 0===d&&(d=!1),n[t])return h.debug("There were multiple attempts to register service "+t+"."),i[t];function p(e){if(void 0===e&&(e=a()),"function"!=typeof e[t])throw u.create("invalid-app-argument",{appName:t});return e[t]()}return n[t]=c,f&&(r[t]=f,s().forEach(function(e){f("create",e)})),void 0!==l&&o.deepExtend(p,l),i[t]=p,e.prototype[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=this._getService.bind(this,t);return r.apply(this,d?e:[])},p},removeApp:function(e){l(t[e],"delete"),delete t[e]},factories:n,useAsService:f}};function a(e){if(!o.contains(t,e=e||c))throw u.create("no-app",{appName:e});return t[e]}function s(){return Object.keys(t).map(function(e){return t[e]})}function l(e,t){for(var i=0,o=Object.keys(n);i<o.length;i++){var a=f(0,o[i]);if(null===a)return;r[a]&&r[a](t,e)}}function f(e,t){return"serverAuth"===t?null:t}return i.default=i,Object.defineProperty(i,"apps",{get:s}),a.App=e,i}(l);return t.INTERNAL=i.__assign(i.__assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){o.deepExtend(t,e)},createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,deepExtend:o.deepExtend}),t}(),p=d.initializeApp;d.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.isNode()&&h.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),p.apply(void 0,e)};var y=d;t.default=y,t.firebase=y},x7I3:function(e,t,n){"use strict";n.r(t),n.d(t,"ErrorCode",function(){return sr}),n.d(t,"EventType",function(){return ur}),n.d(t,"WebChannel",function(){return cr}),n.d(t,"XhrIo",function(){return lr}),n.d(t,"createWebChannelTransport",function(){return ar});var r,i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=o||{},a=i;function s(e){return"string"==typeof e}function u(e){return"number"==typeof e}function c(e,t){e=e.split("."),t=t||a;for(var n=0;n<e.length;n++)if(null==(t=t[e[n]]))return null;return t}function l(){}function h(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}function f(e){return"array"==h(e)}function d(e){var t=h(e);return"array"==t||"object"==t&&"number"==typeof e.length}function p(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var y="closure_uid_"+(1e9*Math.random()>>>0),v=0;function m(e,t,n){return e.call.apply(e.bind,arguments)}function g(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function _(e,t,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:g).apply(null,arguments)}function b(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var w=Date.now||function(){return+new Date};function C(e,t){function n(){}n.prototype=t.prototype,e.N=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.yb=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function k(){this.j=this.j,this.i=this.i}k.prototype.j=!1,k.prototype.la=function(){!this.j&&(this.j=!0,this.G(),0)&&(this[y]||(this[y]=++v))},k.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var S=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(s(e))return s(t)&&1==t.length?e.indexOf(t,0):-1;for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},E=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=s(e)?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function T(e){return Array.prototype.concat.apply([],arguments)}function I(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function A(e){return/^[\s\xa0]*$/.test(e)}var D,N=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function R(e,t){return-1!=e.indexOf(t)}function x(e,t){return e<t?-1:e>t?1:0}e:{var O=a.navigator;if(O){var P=O.userAgent;if(P){D=P;break e}}D=""}function M(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function L(e){var t,n={};for(t in e)n[t]=e[t];return n}var V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<V.length;o++)n=V[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function U(e){return U[" "](e),e}U[" "]=l;var q,B,j=R(D,"Opera"),z=R(D,"Trident")||R(D,"MSIE"),Q=R(D,"Edge"),H=Q||z,W=R(D,"Gecko")&&!(R(D.toLowerCase(),"webkit")&&!R(D,"Edge"))&&!(R(D,"Trident")||R(D,"MSIE"))&&!R(D,"Edge"),G=R(D.toLowerCase(),"webkit")&&!R(D,"Edge");function K(){var e=a.document;return e?e.documentMode:void 0}e:{var Y="",Z=(B=D,W?/rv:([^\);]+)(\)|;)/.exec(B):Q?/Edge\/([\d\.]+)/.exec(B):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(B):G?/WebKit\/(\S+)/.exec(B):j?/(?:Version)[ \/]?(\S+)/.exec(B):void 0);if(Z&&(Y=Z?Z[1]:""),z){var J=K();if(null!=J&&J>parseFloat(Y)){q=String(J);break e}}q=Y}var X,$={};function ee(e){return function(e,t){var n=$;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t()}(e,function(){for(var t=0,n=N(String(q)).split("."),r=N(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=x(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||x(0==a[2].length,0==s[2].length)||x(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t})}var te=a.document;X=te&&z?K()||("CSS1Compat"==te.compatMode?parseInt(q,10):5):void 0;var ne=!z||9<=Number(X),re=z&&!ee("9"),ie=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{a.addEventListener("test",l,t),a.removeEventListener("test",l,t)}catch(n){}return e}();function oe(e,t){this.type=e,this.a=this.target=t,this.Ja=!0}function ae(e,t){if(oe.call(this,e?e.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.a=t,t=e.relatedTarget){if(W){e:{try{U(t.nodeName);var i=!0;break e}catch(o){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=s(e.pointerType)?e.pointerType:se[e.pointerType]||"",this.c=e,e.defaultPrevented&&this.b()}}oe.prototype.b=function(){this.Ja=!1},C(ae,oe);var se={2:"touch",3:"pen",4:"mouse"};ae.prototype.b=function(){ae.N.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,re)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(t){}};var ue="closure_listenable_"+(1e6*Math.random()|0),ce=0;function le(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.da=i,this.key=++ce,this.X=this.Z=!1}function he(e){e.X=!0,e.listener=null,e.proxy=null,e.src=null,e.da=null}function fe(e){this.src=e,this.a={},this.b=0}function de(e,t){var n=t.type;if(n in e.a){var r,i=e.a[n],o=S(i,t);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(he(t),0==e.a[n].length&&(delete e.a[n],e.b--))}}function pe(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.X&&o.listener==t&&o.capture==!!n&&o.da==r)return i}return-1}fe.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=pe(e,t,r,i);return-1<a?(t=e[a],n||(t.Z=!1)):((t=new le(t,this.src,o,!!r,i)).Z=n,e.push(t)),t};var ye="closure_lm_"+(1e6*Math.random()|0),ve={};function me(e,t,n,r,i){if(r&&r.once)return function e(t,n,r,i,o){if(f(n)){for(var a=0;a<n.length;a++)e(t,n[a],r,i,o);return null}return r=Se(r),t&&t[ue]?t.Ba(n,r,p(i)?!!i.capture:!!i,o):ge(t,n,r,!0,i,o)}(e,t,n,r,i);if(f(t)){for(var o=0;o<t.length;o++)me(e,t[o],n,r,i);return null}return n=Se(n),e&&e[ue]?e.Aa(t,n,p(r)?!!r.capture:!!r,i):ge(e,t,n,!1,r,i)}function ge(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=p(i)?!!i.capture:!!i;if(a&&!ne)return null;var s=Ce(e);if(s||(e[ye]=s=new fe(e)),(n=s.add(t,n,r,a,o)).proxy)return n;if(r=function(){var e=we,t=ne?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)ie||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(be(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function _e(e){if(!u(e)&&e&&!e.X){var t=e.src;if(t&&t[ue])de(t.c,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(be(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ce(t))?(de(n,e),0==n.b&&(n.src=null,t[ye]=null)):he(e)}}}function be(e){return e in ve?ve[e]:ve[e]="on"+e}function we(e,t){return!!e.X||function(e,t){var n=e.listener,r=e.da||e.src;return e.Z&&_e(e),n.call(r,t)}(e,ne?new ae(t,this):t=new ae(t||c("window.event"),this))}function Ce(e){return(e=e[ye])instanceof fe?e:null}var ke="__closure_events_fn_"+(1e9*Math.random()>>>0);function Se(e){return"function"==h(e)?e:(e[ke]||(e[ke]=function(t){return e.handleEvent(t)}),e[ke])}function Ee(){k.call(this),this.c=new fe(this),this.J=this,this.B=null}function Te(e,t,n,r){if(!(t=e.c.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&de(e.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ja}C(Ee,k),Ee.prototype[ue]=!0,(r=Ee.prototype).addEventListener=function(e,t,n,r){me(this,e,t,n,r)},r.removeEventListener=function(e,t,n,r){!function e(t,n,r,i,o){if(f(n))for(var a=0;a<n.length;a++)e(t,n[a],r,i,o);else i=p(i)?!!i.capture:!!i,r=Se(r),t&&t[ue]?(t=t.c,(n=String(n).toString())in t.a&&-1<(r=pe(a=t.a[n],r,i,o))&&(he(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete t.a[n],t.b--))):t&&(t=Ce(t))&&(n=t.a[n.toString()],t=-1,n&&(t=pe(n,r,i,o)),(r=-1<t?n[t]:null)&&_e(r))}(this,e,t,n,r)},r.dispatchEvent=function(e){var t,n=this.B;if(n)for(t=[];n;n=n.B)t.push(n);n=this.J;var r=e.type||e;if(s(e))e=new oe(e,n);else if(e instanceof oe)e.target=e.target||n;else{var i=e;F(e=new oe(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var a=e.a=t[o];i=Te(a,r,!0,e)&&i}if(i=Te(a=e.a=n,r,!0,e)&&i,i=Te(a,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=Te(a=e.a=t[o],r,!1,e)&&i;return i},r.G=function(){if(Ee.N.G.call(this),this.c){var e,t=this.c;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)he(n[r]);delete t.a[e],t.b--}}this.B=null},r.Aa=function(e,t,n,r){return this.c.add(String(e),t,!1,n,r)},r.Ba=function(e,t,n,r){return this.c.add(String(e),t,!0,n,r)};var Ie=a.JSON.stringify;function Ae(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function De(){this.b=this.a=null}Ae.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var Ne,Re=new Ae(function(){return new Oe},function(e){e.reset()});function xe(){var e=Ve,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function Oe(){this.next=this.b=this.a=null}function Pe(e){a.setTimeout(function(){throw e},0)}function Me(e,t){Ne||function(){var e=a.Promise.resolve(void 0);Ne=function(){e.then(Fe)}}(),Le||(Ne(),Le=!0),Ve.add(e,t)}De.prototype.add=function(e,t){var n=Re.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},Oe.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},Oe.prototype.reset=function(){this.next=this.b=this.a=null};var Le=!1,Ve=new De;function Fe(){for(var e;e=xe();){try{e.a.call(e.b)}catch(n){Pe(n)}var t=Re;t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}Le=!1}function Ue(e,t){Ee.call(this),this.b=e||1,this.a=t||a,this.f=_(this.gb,this),this.g=w()}function qe(e){e.ba=!1,e.L&&(e.a.clearTimeout(e.L),e.L=null)}function Be(e,t,n){if("function"==h(e))n&&(e=_(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=_(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function je(e,t,n){k.call(this),this.f=null!=n?_(e,n):e,this.c=t,this.b=_(this.ab,this),this.a=[]}function ze(e){e.U=Be(e.b,e.c),e.f.apply(null,e.a)}function Qe(e){k.call(this),this.b=e,this.a={}}C(Ue,Ee),(r=Ue.prototype).ba=!1,r.L=null,r.gb=function(){if(this.ba){var e=w()-this.g;0<e&&e<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-e):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(qe(this),this.start()))}},r.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=w())},r.G=function(){Ue.N.G.call(this),qe(this),delete this.a},C(je,k),(r=je.prototype).ea=!1,r.U=null,r.Ua=function(e){this.a=arguments,this.U?this.ea=!0:ze(this)},r.G=function(){je.N.G.call(this),this.U&&(a.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},r.ab=function(){this.U=null,this.ea&&(this.ea=!1,ze(this))},C(Qe,k);var He=[];function We(e,t,n,r){f(n)||(n&&(He[0]=n.toString()),n=He);for(var i=0;i<n.length;i++){var o=me(t,n[i],r||e.handleEvent,!1,e.b||e);if(!o)break;e.a[o.key]=o}}function Ge(e){M(e.a,function(e,t){this.a.hasOwnProperty(t)&&_e(e)},e),e.a={}}function Ke(){}Qe.prototype.G=function(){Qe.N.G.call(this),Ge(this)},Qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ye=new Ee;function Ze(e){oe.call(this,"serverreachability",e)}function Je(e){Ye.dispatchEvent(new Ze(Ye,e))}function Xe(e){oe.call(this,"statevent",e)}function $e(e){Ye.dispatchEvent(new Xe(Ye,e))}function et(e){oe.call(this,"timingevent",e)}function tt(e,t){if("function"!=h(e))throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){e()},t)}C(Ze,oe),C(Xe,oe),C(et,oe);var nt={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,Ma:7,TIMEOUT:8,sb:9},rt={jb:"complete",wb:"success",Na:"error",Ma:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function it(){}function ot(){}it.prototype.a=null;var at,st={OPEN:"a",ib:"b",Na:"c",rb:"d"};function ut(){oe.call(this,"d")}function ct(){oe.call(this,"c")}function lt(){}function ht(e,t,n){this.g=e,this.W=t,this.V=n||1,this.I=new Qe(this),this.O=ft,this.P=new Ue(e=H?125:void 0),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}C(ut,oe),C(ct,oe),C(lt,it),at=new lt;var ft=45e3,dt={},pt={};function yt(e,t,n){e.F=1,e.f=qt(Ot(t)),e.l=n,e.H=!0,mt(e,null)}function vt(e,t,n,r){e.F=1,e.f=qt(Ot(t)),e.l=null,e.H=n,mt(e,r)}function mt(e,t){e.v=w(),bt(e),e.D=Ot(e.f),Ut(e.D,"t",e.V),e.A=0,e.a=e.g.$(e.g.Y()?t:null),0<e.J&&(e.B=new je(_(e.Ka,e,e.a),e.J)),We(e.I,e.a,"readystatechange",e.eb),t=e.h?L(e.h):{},e.l?(e.w||(e.w="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.a.ca(e.D,e.w,e.l,t)):(e.w="GET",e.a.ca(e.D,e.w,null,t)),Je(1)}function gt(e,t,n){for(var r=!0;!e.m&&e.A<n.length;){var i=_t(e,n);if(i==pt){4==t&&(e.c=4,$e(14),r=!1);break}if(i==dt){e.c=4,$e(15),r=!1;break}Et(e,i)}4==t&&0==n.length&&(e.c=1,$e(16),r=!1),e.b=e.b&&r,r||(St(e),kt(e))}function _t(e,t){var n=e.A,r=t.indexOf("\n",n);return-1==r?pt:(n=Number(t.substring(n,r)),isNaN(n)?dt:(r+=1)+n>t.length?pt:(t=t.substr(r,n),e.A=r+n,t))}function bt(e){e.R=w()+e.O,wt(e,e.O)}function wt(e,t){if(null!=e.i)throw Error("WatchDog timer not null");e.i=tt(_(e.bb,e),t)}function Ct(e){e.i&&(a.clearTimeout(e.i),e.i=null)}function kt(e){e.g.Da()||e.m||e.g.na(e)}function St(e){Ct(e);var t=e.B;t&&"function"==typeof t.la&&t.la(),e.B=null,qe(e.P),Ge(e.I),e.a&&(t=e.a,e.a=null,t.abort(),t.la())}function Et(e,t){try{e.g.Ga(e,t),Je(4)}catch(n){}}function Tt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(d(e)||s(e))E(e,t,void 0);else{if(e.K&&"function"==typeof e.K)var n=e.K();else if(e.C&&"function"==typeof e.C)n=void 0;else if(d(e)||s(e)){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.C&&"function"==typeof e.C)return e.C();if(s(e))return e.split("");if(d(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function It(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof It)for(n=e.K(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function At(e,t){Nt(e.b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&Dt(e))}function Dt(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Nt(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)Nt(i,r=e.a[t])||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function Nt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(r=ht.prototype).setTimeout=function(e){this.O=e},r.eb=function(e){e=e.target;var t=this.B;t&&3==On(e)?t.Ua():this.Ka(e)},r.Ka=function(e){try{if(e==this.a)e:{var t=On(this.a),n=this.a.ya(),r=this.a.T();if(!(3>t||3==t&&!H&&!this.a.aa())){this.m||4!=t||7==n||Je(8==n||0>=r?3:2),Ct(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){t:{if(this.a){var a=Pn(this.a,"X-HTTP-Initial-Response");if(a&&!A(a)){var s=a;break t}}s=null}if(!s){this.b=!1,this.c=3,$e(12),St(this),kt(this);break e}this.s=!0,Et(this,s)}this.H?(gt(this,t,o),H&&this.b&&3==t&&(We(this.I,this.P,"tick",this.cb),this.P.start())):Et(this,o),4==t&&St(this),this.b&&!this.m&&(4==t?this.g.na(this):(this.b=!1,bt(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,$e(12)):(this.c=0,$e(13)),St(this),kt(this)}}}catch(u){}},r.cb=function(){if(this.a){var e=On(this.a),t=this.a.aa();this.A<t.length&&(Ct(this),gt(this,e,t),this.b&&4!=e&&bt(this))}},r.cancel=function(){this.m=!0,St(this)},r.bb=function(){this.i=null;var e=w();0<=e-this.R?(2!=this.F&&(Je(3),$e(17)),St(this),this.c=2,kt(this)):wt(this,this.R-e)},(r=It.prototype).C=function(){Dt(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},r.K=function(){return Dt(this),this.a.concat()},r.get=function(e,t){return Nt(this.b,e)?this.b[e]:t},r.set=function(e,t){Nt(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},r.forEach=function(e,t){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var Rt=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function xt(e,t){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,e instanceof xt?(this.h=void 0!==t?t:e.h,Pt(this,e.f),this.j=e.j,Mt(this,e.b),Lt(this,e.i),this.a=e.a,Vt(this,en(e.c)),this.g=e.g):e&&(n=String(e).match(Rt))?(this.h=!!t,Pt(this,n[1]||"",!0),this.j=Bt(n[2]||""),Mt(this,n[3]||"",!0),Lt(this,n[4]),this.a=Bt(n[5]||"",!0),Vt(this,n[6]||"",!0),this.g=Bt(n[7]||"")):(this.h=!!t,this.c=new Yt(null,this.h))}function Ot(e){return new xt(e)}function Pt(e,t,n){e.f=n?Bt(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function Mt(e,t,n){e.b=n?Bt(t,!0):t}function Lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.i=t}else e.i=null}function Vt(e,t,n){t instanceof Yt?(e.c=t,function(e,t){t&&!e.f&&(Zt(e),e.c=null,e.a.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Jt(this,t),$t(this,n,e))},e)),e.f=t}(e.c,e.h)):(n||(t=jt(t,Gt)),e.c=new Yt(t,e.h))}function Ft(e,t,n){e.c.set(t,n)}function Ut(e,t,n){f(n)||(n=[String(n)]),$t(e.c,t,n)}function qt(e){return Ft(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^w()).toString(36)),e}function Bt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function jt(e,t,n){return s(e)?(e=encodeURI(e).replace(t,zt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function zt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}xt.prototype.toString=function(){var e=[],t=this.f;t&&e.push(jt(t,Qt,!0),":");var n=this.b;return(n||"file"==t)&&(e.push("//"),(t=this.j)&&e.push(jt(t,Qt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&e.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&e.push("/"),e.push(jt(n,"/"==n.charAt(0)?Wt:Ht,!0))),(n=this.c.toString())&&e.push("?",n),(n=this.g)&&e.push("#",jt(n,Kt)),e.join("")},xt.prototype.resolve=function(e){var t=Ot(this),n=!!e.f;n?Pt(t,e.f):n=!!e.j,n?t.j=e.j:n=!!e.b,n?Mt(t,e.b):n=null!=e.i;var r=e.a;if(n)Lt(t,e.i);else if(n=!!e.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=t.a.lastIndexOf("/");-1!=i&&(r=t.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(R(i,"./")||R(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?t.a=r:n=""!==e.c.toString(),n?Vt(t,en(e.c)):n=!!e.g,n&&(t.g=e.g),t};var Qt=/[#\/\?@]/g,Ht=/[#\?:]/g,Wt=/[#\?]/g,Gt=/[#\?@]/g,Kt=/#/g;function Yt(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Zt(e){e.a||(e.a=new It,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Jt(e,t){Zt(e),t=tn(e,t),Nt(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,At(e.a,t))}function Xt(e,t){return Zt(e),t=tn(e,t),Nt(e.a.b,t)}function $t(e,t,n){Jt(e,t),0<n.length&&(e.c=null,e.a.set(tn(e,t),I(n)),e.b+=n.length)}function en(e){var t=new Yt;return t.c=e.c,e.a&&(t.a=new It(e.a),t.b=e.b),t}function tn(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function nn(e){this.a=e,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function rn(e){var t=e.a.F.a;if(null!=t)$e(4),t?($e(10),Wn(e.a,e,!1)):($e(11),Wn(e.a,e,!0));else{e.b=new ht(e,void 0,void 0),e.b.h=e.h,t=Jn(t=e.a,t.Y()?e.f:null,e.i),$e(4),Ut(t,"TYPE","xmlhttp");var n=e.a.j,r=e.a.I;n&&r&&Ft(t,n,r),vt(e.b,t,!1,e.f)}}function on(){this.a=this.b=null}function an(){this.a=new It}function sn(e){var t=typeof e;return"object"==t&&e||"function"==t?"o"+(e[y]||(e[y]=++v)):t.charAt(0)+e}function un(e,t){this.b=e,this.a=t}function cn(e){this.g=e||ln,e=a.PerformanceNavigationTiming?0<(e=a.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(a.ka&&a.ka.Ea&&a.ka.Ea()&&a.ka.Ea().zb),this.f=e?this.g:1,this.a=null,1<this.f&&(this.a=new an),this.b=null,this.c=[]}(r=Yt.prototype).add=function(e,t){Zt(this),this.c=null,e=tn(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},r.forEach=function(e,t){Zt(this),this.a.forEach(function(n,r){E(n,function(n){e.call(t,n,r,this)},this)},this)},r.K=function(){Zt(this);for(var e=this.a.C(),t=this.a.K(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},r.C=function(e){Zt(this);var t=[];if(s(e))Xt(this,e)&&(t=T(t,this.a.get(tn(this,e))));else{e=this.a.C();for(var n=0;n<e.length;n++)t=T(t,e[n])}return t},r.set=function(e,t){return Zt(this),this.c=null,Xt(this,e=tn(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},r.get=function(e,t){return e&&0<(e=this.C(e)).length?String(e[0]):t},r.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.K(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")},C(function(){},function(){}),(r=nn.prototype).M=null,r.$=function(e){return this.a.$(e)},r.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},r.Da=function(){return!1},r.Ga=function(e,t){if(this.c=e.o,0==this.M){if(!this.a.o&&(e=e.a)){var n=Pn(e,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(e=Pn(e,"X-HTTP-Session-Id"))&&(this.a.I=e)}if(t){try{var r=this.a.ja.a.parse(t)}catch(i){return(t=this.a).m=this.c,void Yn(t,2)}this.f=r[0]}else(t=this.a).m=this.c,Yn(t,2)}else 1==this.M&&(this.g?$e(6):"11111"==t?($e(5),this.g=!0,(!z||10<=Number(X))&&(this.c=200,this.b.cancel(),$e(11),Wn(this.a,this,!0))):($e(7),this.g=!1))},r.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,rn(this)):1==this.M&&(this.g?($e(11),Wn(this.a,this,!0)):($e(10),Wn(this.a,this,!1)));else{0==this.M?$e(8):1==this.M&&$e(9);var e=this.a;e.m=this.c,Yn(e,2)}},r.Y=function(){return this.a.Y()},r.ma=function(){return this.a.ma()},an.prototype.add=function(e){this.a.set(sn(e),e)},an.prototype.C=function(){return this.a.C()};var ln=10;function hn(e,t){!e.a&&(R(t,"spdy")||R(t,"quic")||R(t,"h2"))&&(e.f=e.g,e.a=new an,e.b&&(yn(e,e.b),e.b=null))}function fn(e){return!!e.b||!!e.a&&e.a.a.c>=e.f}function dn(e){return e.b?1:e.a?e.a.a.c:0}function pn(e,t){return e.b?e=e.b==t:e.a?(t=sn(t),e=Nt(e.a.a.b,t)):e=!1,e}function yn(e,t){e.a?e.a.add(t):e.b=t}function vn(e,t){var n;e.b&&e.b==t?e.b=null:((n=e.a)&&(n=sn(t),n=Nt(e.a.a.b,n)),n&&At(e.a.a,sn(t)))}function mn(e){if(null!=e.b)return e.c.concat(e.b.j);if(null!=e.a&&0!=e.a.a.c){var t=e.c;return E(e.a.C(),function(e){t=t.concat(e.j)}),t}return I(e.c)}function gn(){}function _n(){this.a=new gn}function bn(e,t,n){var r=n||"";try{Tt(e,function(e,n){var i=e;p(e)&&(i=Ie(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function wn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(o){}}cn.prototype.cancel=function(){this.c=mn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(E(this.a.C(),function(e){e.cancel()}),function(e){e.b={},e.a.length=0,e.c=0}(this.a.a))},gn.prototype.stringify=function(e){return a.JSON.stringify(e,void 0)},gn.prototype.parse=function(e){return a.JSON.parse(e,void 0)};var Cn=a.JSON.parse;function kn(e){Ee.call(this),this.headers=new It,this.H=e||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Sn,this.D=this.F=!1}C(kn,Ee);var Sn="",En=/^https?$/i,Tn=["POST","PUT"];function In(e){return"content-type"==e.toLowerCase()}function An(e,t){e.b=!1,e.a&&(e.g=!0,e.a.abort(),e.g=!1),e.f=t,e.h=5,Dn(e),Rn(e)}function Dn(e){e.v||(e.v=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function Nn(e){if(e.b&&void 0!==o&&(!e.s[1]||4!=On(e)||2!=e.T()))if(e.l&&4==On(e))Be(e.Fa,0,e);else if(e.dispatchEvent("readystatechange"),4==On(e)){e.b=!1;try{var t,n=e.T();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var s=String(e.A).match(Rt)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}i=!En.test(s?s.toLowerCase():"")}t=i}t?(e.dispatchEvent("complete"),e.dispatchEvent("success")):(e.h=6,e.f=e.za()+" ["+e.T()+"]",Dn(e))}finally{Rn(e)}}}function Rn(e,t){if(e.a){xn(e);var n=e.a,r=e.s[0]?l:null;e.a=null,e.s=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function xn(e){e.a&&e.D&&(e.a.ontimeout=null),e.m&&(a.clearTimeout(e.m),e.m=null)}function On(e){return e.a?e.a.readyState:0}function Pn(e,t){return e.a?e.a.getResponseHeader(t):null}function Mn(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}if(r)return e;if(n=function(e){var t="";return M(n,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(),s(e)){if(t=encodeURIComponent(String(t)),t+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=e.indexOf("#"))&&(n=e.length),0>(r=e.indexOf("?"))||r>n){r=n;var i=""}else i=e.substring(r+1,n);n=(e=[e.substr(0,r),i,e.substr(n)])[1],e[1]=t?n?n+"&"+t:t:n,e=e[0]+(e[1]?"?"+e[1]:"")+e[2]}return e}return Ft(e,t,n),e}function Ln(e){this.f=[],this.F=new on,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Ra=this.P=0,this.Pa=!!c("internalChannelParams.failFast",e),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Oa=c("internalChannelParams.baseRetryDelayMs",e)||5e3,this.Sa=c("internalChannelParams.retryDelaySeedMs",e)||1e4,this.Qa=c("internalChannelParams.forwardChannelMaxRetries",e)||2,this.qa=c("internalChannelParams.forwardChannelRequestTimeoutMs",e)||2e4,this.La=e&&e.Ab||void 0,this.D=void 0,this.R=e&&e.supportsCrossDomainXhr||!1,this.H="",this.b=new cn(e&&e.concurrentRequestLimit),this.ja=new _n,this.o=!e||void 0===e.backgroundChannelTest||e.backgroundChannelTest,(this.W=e&&e.fastHandshake||!1)&&!this.o&&(this.o=!0),e&&e.forceLongPolling&&(this.oa=!1),this.fa=void 0}function Vn(e){if(Fn(e),3==e.u){var t=e.P++,n=Ot(e.B);Ft(n,"SID",e.H),Ft(n,"RID",t),Ft(n,"TYPE","terminate"),jn(e,n),(t=new ht(e,t,void 0)).F=2,t.f=qt(Ot(n)),n=!1,a.navigator&&a.navigator.sendBeacon&&(n=a.navigator.sendBeacon(t.f.toString(),"")),!n&&a.Image&&((new Image).src=t.f,n=!0),n||(t.a=t.g.$(null),t.a.ca(t.f)),t.v=w(),bt(t)}Zn(e)}function Fn(e){e.w&&(e.w.abort(),e.w=null),e.a&&(e.a.cancel(),e.a=null),e.l&&(a.clearTimeout(e.l),e.l=null),Gn(e),e.b.cancel(),e.h&&(u(e.h)&&a.clearTimeout(e.h),e.h=null)}function Un(e,t){e.f.push(new un(e.Ra++,t)),3==e.u&&qn(e)}function qn(e){fn(e.b)||e.h||(e.h=!0,Me(e.Ia,e),e.A=0)}function Bn(e,t){var n;n=t?t.W:e.P++;var r=Ot(e.B);Ft(r,"SID",e.H),Ft(r,"RID",n),Ft(r,"AID",e.O),jn(e,r),e.g&&e.i&&Mn(r,e.g,e.i),n=new ht(e,n,e.A+1),null===e.g&&(n.h=e.i),t&&(e.f=t.j.concat(e.f)),t=zn(e,n,1e3),n.setTimeout(Math.round(.5*e.qa)+Math.round(.5*e.qa*Math.random())),yn(e.b,n),yt(n,r,t)}function jn(e,t){e.c&&Tt({},function(e,n){Ft(t,n,e)})}function zn(e,t,n){n=Math.min(e.f.length,n);var r=e.c?_(e.c.Ta,e.c,e):null;e:for(var i=e.f,o=-1;;){var a=["count="+n];-1==o?0<n?a.push("ofs="+(o=i[0].b)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),s=!1;else try{bn(l,a,"req"+c+"_")}catch(h){r&&r(l)}}if(s){r=a.join("&");break e}}return e=e.f.splice(0,n),t.j=e,r}function Qn(e){e.a||e.l||(e.S=1,Me(e.Ha,e),e.v=0)}function Hn(e){return!(e.a||e.l||3<=e.v||(e.S++,e.l=tt(_(e.Ha,e),Kn(e,e.v)),e.v++,0))}function Wn(e,t,n){var r=t.l;r&&hn(e.b,r),e.ia=e.oa&&n,e.m=t.c,e.B=Jn(e,null,e.ha),qn(e)}function Gn(e){null!=e.s&&(a.clearTimeout(e.s),e.s=null)}function Kn(e,t){var n=e.Oa+Math.floor(Math.random()*e.Sa);return e.ma()||(n*=2),n*t}function Yn(e,t){if(2==t){var n=null;e.c&&(n=null);var r=_(e.fb,e);n||(n=new xt("//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||Pt(n,"https"),qt(n)),function(e,t){var n=new Ke;if(a.Image){var r=new Image;r.onload=b(wn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=b(wn,n,r,"TestLoadImage: error",!1,t),r.onabort=b(wn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=b(wn,n,r,"TestLoadImage: timeout",!1,t),a.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else $e(2);e.u=0,e.c&&e.c.ta(t),Zn(e),Fn(e)}function Zn(e){e.u=0,e.m=-1,e.c&&(0==mn(e.b).length&&0==e.f.length||(e.b.c.length=0,I(e.f),e.f.length=0),e.c.sa())}function Jn(e,t,n){var r=function(e){return e instanceof xt?Ot(e):new xt(e,void 0)}(n);if(""!=r.b)t&&Mt(r,t+"."+r.b),Lt(r,r.i);else{var i=a.location;r=function(e,t,n,r){var i=new xt(null,void 0);return e&&Pt(i,e),t&&Mt(i,t),n&&Lt(i,n),r&&(i.a=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.V&&M(e.V,function(e,t){Ft(r,t,e)}),n=e.I,(t=e.j)&&n&&Ft(r,t,n),Ft(r,"VER",e.wa),jn(e,r),r}function Xn(){}function $n(){if(z&&!(10<=Number(X)))throw Error("Environmental error: no available transport.")}function er(e,t){Ee.call(this),this.a=new Ln(t),this.g=e,this.m=t&&t.testUrl?t.testUrl:function(e){for(var t=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf("/",0)?t=i:((r=""==t)||(r=0<=(r=t.length-1)&&t.indexOf("/",r)==r),t+=r?i:"/"+i)}return t}(this.g,"test"),this.b=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.a.i=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.xa&&(e?e["X-WebChannel-Client-Profile"]=t.xa:e={"X-WebChannel-Client-Profile":t.xa}),this.a.J=e,(e=t&&t.httpHeadersOverwriteParam)&&!A(e)&&(this.a.g=e),this.l=t&&t.supportsCrossDomainXhr||!1,this.h=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!A(t)&&(this.a.j=t,null!==(e=this.b)&&t in e&&t in(e=this.b)&&delete e[t]),this.f=new rr(this)}function tr(e){ut.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.c=e)?(e=this.c,this.data=null!==t&&e in t?t[e]:void 0):this.data=t}else this.data=e}function nr(){ct.call(this),this.status=1}function rr(e){this.a=e}(r=kn.prototype).ca=function(e,t,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+e);t=t?t.toUpperCase():"GET",this.A=e,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(e){var t;return(t=e.a)||(t=e.a={}),t}(this.H?this.H:at),this.a.onreadystatechange=_(this.Fa,this);try{this.w=!0,this.a.open(t,String(e),!0),this.w=!1}catch(o){return void An(this,o)}e=n||"";var i=new It(this.headers);r&&Tt(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=In,n=e.length,r=s(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:s(e)?e.charAt(t):e[t]}(i.K()),n=a.FormData&&e instanceof a.FormData,!(0<=S(Tn,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.a.setRequestHeader(t,e)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xn(this),0<this.o&&((this.D=function(e){return z&&ee(9)&&u(e.timeout)&&void 0!==e.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=_(this.Ca,this)):this.m=Be(this.Ca,this.o,this)),this.l=!0,this.a.send(e),this.l=!1}catch(o){An(this,o)}},r.Ca=function(){void 0!==o&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},r.abort=function(e){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=e||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Rn(this))},r.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Rn(this,!0)),kn.N.G.call(this)},r.Fa=function(){this.j||(this.w||this.l||this.g?Nn(this):this.$a())},r.$a=function(){Nn(this)},r.T=function(){try{return 2<On(this)?this.a.status:-1}catch(B){return-1}},r.za=function(){try{return 2<On(this)?this.a.statusText:""}catch(B){return""}},r.aa=function(){try{return this.a?this.a.responseText:""}catch(B){return""}},r.Va=function(e){if(this.a){var t=this.a.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Cn(t)}},r.ya=function(){return this.h},r.Ya=function(){return s(this.f)?this.f:String(this.f)},(r=Ln.prototype).wa=8,r.u=1,r.Da=function(){return 0==this.u},r.Ia=function(e){if(this.h)if(this.h=null,1==this.u){if(!e){this.P=Math.floor(1e5*Math.random());var t,n=new ht(this,e=this.P++,void 0),r=this.i;if(this.J&&(r?F(r=L(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)e:{for(var i=t=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&s(o=o.a.__data__)?o.length:void 0))break;if(4096<(t+=o)){t=i;break e}if(4096===t||i===this.f.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=zn(this,n,t),Ft(i=Ot(this.B),"RID",e),Ft(i,"CVER",22),this.o&&this.j&&Ft(i,"X-HTTP-Session-Id",this.j),jn(this,i),this.g&&r&&Mn(i,this.g,r),yn(this.b,n),this.W?(Ft(i,"$req",t),Ft(i,"SID","null"),n.S=!0,yt(n,i,null)):yt(n,i,t),this.u=2}}else 3==this.u&&(e?Bn(this,e):0==this.f.length||fn(this.b)||Bn(this))},r.Ha=function(){this.l=null,this.a=new ht(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var e=Ot(this.pa);Ft(e,"RID","rpc"),Ft(e,"SID",this.H),Ft(e,"CI",this.ia?"0":"1"),Ft(e,"AID",this.O),jn(this,e),Ft(e,"TYPE","xmlhttp"),this.g&&this.i&&Mn(e,this.g,this.i),this.D&&this.a.setTimeout(this.D),vt(this.a,e,!0,this.ga)},r.Ga=function(e,t){if(0!=this.u&&(this.a==e||pn(this.b,e)))if(this.m=e.o,!e.s&&pn(this.b,e)&&3==this.u){try{var n=this.ja.a.parse(t)}catch(o){n=null}if(f(n)&&3==n.length){if(0==(t=n)[0]){e:if(!this.l){if(this.a){if(!(this.a.v+3e3<e.v))break e;Gn(this),this.a.cancel(),this.a=null}Hn(this),$e(18)}}else this.ra=t[1],0<this.ra-this.O&&37500>t[2]&&this.ia&&0==this.v&&!this.s&&(this.s=tt(_(this.Za,this),6e3));if(1>=dn(this.b)&&this.fa){try{this.fa()}catch(o){}this.fa=void 0}}else Yn(this,11)}else if((e.s||this.a==e)&&Gn(this),!A(t))for(t=n=this.ja.a.parse(t),n=0;n<t.length;n++){var r=t[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&u(r)&&0<r&&(this.D=1.5*r),this.o&&(r=e.a)&&((i=Pn(r,"X-Client-Wire-Protocol"))&&hn(this.b,i),this.j&&(r=Pn(r,"X-HTTP-Session-Id")))&&(this.I=r,Ft(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=e,this.pa=Jn(this,this.Y()?this.ga:null,this.ha),r.s?(vn(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(Ct(r),bt(r)),this.a=r):Qn(this),0<this.f.length&&qn(this)}else"stop"!=r[0]&&"close"!=r[0]||Yn(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?Yn(this,7):Vn(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},r.Za=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,Hn(this),$e(19))},r.na=function(e){var t=null;if(this.a==e){Gn(this),this.a=null;var n=2}else{if(!pn(this.b,e))return;t=e.j,vn(this.b,e),n=1}if(this.m=e.o,0!=this.u)if(e.b)1==n?(t=w()-e.v,Ye.dispatchEvent(new et(Ye,e.l?e.l.length:0,t,this.A)),qn(this)):Qn(this);else{var r=e.c;if(3==r||0==r&&0<this.m||!(1==n&&function(e,t){return!(dn(e.b)>=e.b.f-(e.h?1:0)||(e.h?(e.f=t.j.concat(e.f),0):1==e.u||2==e.u||e.A>=(e.Pa?0:e.Qa)||(e.h=tt(_(e.Ia,e,t),Kn(e,e.A)),e.A++,0)))}(this,e)||2==n&&Hn(this)))switch(t&&0<t.length&&(e=this.b,e.c=e.c.concat(t)),r){case 1:Yn(this,5);break;case 4:Yn(this,10);break;case 3:Yn(this,6);break;default:Yn(this,2)}}},r.fb=function(e){$e(e?2:1)},r.$=function(e){if(e&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(this.La)).F=this.R,e},r.ma=function(){return!!this.c&&!0},r.Y=function(){return this.R},(r=Xn.prototype).va=function(){},r.ua=function(){},r.ta=function(){},r.sa=function(){},r.Ta=function(){},$n.prototype.a=function(e,t){return new er(e,t)},C(er,Ee),(r=er.prototype).addEventListener=function(e,t,n,r){er.N.addEventListener.call(this,e,t,n,r)},r.removeEventListener=function(e,t,n,r){er.N.removeEventListener.call(this,e,t,n,r)},r.Wa=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var e=this.a,t=this.m,n=this.g,r=this.b||void 0;$e(0),e.ha=n,e.V=r||{},e.o&&(e.F.b=[],e.F.a=!1),e.w=new nn(e),null===e.g&&(e.w.h=e.i),n=t,e.g&&e.i&&(n=Mn(t,e.g,e.i)),(e=e.w).i=n,t=Jn(e.a,null,e.i),$e(3),null!=(n=e.a.F.b)?(e.f=n[0],e.M=1,rn(e)):(Ut(t,"MODE","init"),!e.a.o&&e.a.j&&Ut(t,"X-HTTP-Session-Id",e.a.j),e.b=new ht(e,void 0,void 0),e.b.h=e.h,vt(e.b,t,!1,null),e.M=0)},r.close=function(){Vn(this.a)},r.Xa=function(e){if(s(e)){var t={};t.__data__=e,Un(this.a,t)}else this.h?((t={}).__data__=Ie(e),Un(this.a,t)):Un(this.a,e)},r.G=function(){this.a.c=null,delete this.f,Vn(this.a),delete this.a,er.N.G.call(this)},C(tr,ut),C(nr,ct),C(rr,Xn),rr.prototype.va=function(){this.a.dispatchEvent("a")},rr.prototype.ua=function(e){this.a.dispatchEvent(new tr(e))},rr.prototype.ta=function(e){this.a.dispatchEvent(new nr(e))},rr.prototype.sa=function(){this.a.dispatchEvent("b")};var ir=b(function(e,t){function n(){}n.prototype=e.prototype;var r=new n;return e.apply(r,Array.prototype.slice.call(arguments,1)),r},$n);$n.prototype.createWebChannel=$n.prototype.a,er.prototype.send=er.prototype.Xa,er.prototype.open=er.prototype.Wa,er.prototype.close=er.prototype.close,nt.NO_ERROR=0,nt.TIMEOUT=8,nt.HTTP_ERROR=6,rt.COMPLETE="complete",ot.EventType=st,st.OPEN="a",st.CLOSE="b",st.ERROR="c",st.MESSAGE="d",Ee.prototype.listen=Ee.prototype.Aa,kn.prototype.listenOnce=kn.prototype.Ba,kn.prototype.getLastError=kn.prototype.Ya,kn.prototype.getLastErrorCode=kn.prototype.ya,kn.prototype.getStatus=kn.prototype.T,kn.prototype.getStatusText=kn.prototype.za,kn.prototype.getResponseJson=kn.prototype.Va,kn.prototype.getResponseText=kn.prototype.aa,kn.prototype.send=kn.prototype.ca;var or={createWebChannelTransport:ir,ErrorCode:nt,EventType:rt,WebChannel:ot,XhrIo:kn},ar=or.createWebChannelTransport,sr=or.ErrorCode,ur=or.EventType,cr=or.WebChannel,lr=or.XhrIo;t.default=or},zUnb:function(e,t,n){"use strict";function r(e){return"function"==typeof e}n.r(t);var i=!1,o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else i&&console.log("RxJS: Back to a better error behavior. Thank you. <3");i=e},get useDeprecatedSynchronousErrorHandling(){return i}};function a(e){setTimeout(function(){throw e})}var s={closed:!0,next:function(e){},error:function(e){if(o.useDeprecatedSynchronousErrorHandling)throw e;a(e)},complete:function(){}},u=Array.isArray||function(e){return e&&"number"==typeof e.length};function c(e){return null!==e&&"object"==typeof e}function l(e){return Error.call(this),this.message=e?"".concat(e.length," errors occurred during unsubscription:\n").concat(e.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=e,this}l.prototype=Object.create(Error.prototype);var h,f=l,d=((h=function(){function e(t){_classCallCheck(this,e),this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return _createClass(e,[{key:"unsubscribe",value:function(){var e,t=!1;if(!this.closed){var n=this._parent,i=this._parents,o=this._unsubscribe,a=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,l=i?i.length:0;n;)n.remove(this),n=++s<l&&i[s]||null;if(r(o))try{o.call(this)}catch(d){t=!0,e=d instanceof f?p(d.errors):[d]}if(u(a))for(s=-1,l=a.length;++s<l;){var h=a[s];if(c(h))try{h.unsubscribe()}catch(d){t=!0,e=e||[],d instanceof f?e=e.concat(p(d.errors)):e.push(d)}}if(t)throw new f(e)}}},{key:"add",value:function(t){var n=t;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:if(!t)return e.EMPTY;throw new Error("unrecognized teardown "+t+" added to Subscription.")}if(n._addParent(this)){var i=this._subscriptions;i?i.push(n):this._subscriptions=[n]}return n}},{key:"remove",value:function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}}},{key:"_addParent",value:function(e){var t=this._parent,n=this._parents;return t!==e&&(t?n?-1===n.indexOf(e)&&(n.push(e),!0):(this._parents=[e],!0):(this._parent=e,!0))}}]),e}()).EMPTY=function(e){return e.closed=!0,e}(new h),h);function p(e){return e.reduce(function(e,t){return e.concat(t instanceof f?t.errors:t)},[])}var y="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),v=function(e){function t(e,n,r){var i;switch(_classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=s;break;case 1:if(!e){i.destination=s;break}if("object"==typeof e){e instanceof t?(i.syncErrorThrowable=e.syncErrorThrowable,i.destination=e,e.add(_assertThisInitialized(i))):(i.syncErrorThrowable=!0,i.destination=new m(_assertThisInitialized(i),e));break}default:i.syncErrorThrowable=!0,i.destination=new m(_assertThisInitialized(i),e,n,r)}return i}return _inherits(t,d),_createClass(t,[{key:y,value:function(){return this}},{key:"next",value:function(e){this.isStopped||this._next(e)}},{key:"error",value:function(e){this.isStopped||(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,_get(_getPrototypeOf(t.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var e=this._parent,t=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=e,this._parents=t,this}}],[{key:"create",value:function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i}}]),t}(),m=function(e){function t(e,n,i,o){var a,u;_classCallCheck(this,t),(a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._parentSubscriber=e;var c=_assertThisInitialized(a);return r(n)?u=n:n&&(u=n.next,i=n.error,o=n.complete,n!==s&&(r((c=Object.create(n)).unsubscribe)&&a.add(c.unsubscribe.bind(c)),c.unsubscribe=a.unsubscribe.bind(_assertThisInitialized(a)))),a._context=c,a._next=u,a._error=i,a._complete=o,a}return _inherits(t,v),_createClass(t,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber,n=o.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):a(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;a(e)}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),o.useDeprecatedSynchronousErrorHandling)throw n;a(n)}}},{key:"__tryOrSetError",value:function(e,t,n){if(!o.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(r){return o.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(a(r),!0)}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),t}(),g="function"==typeof Symbol&&Symbol.observable||"@@observable";function _(){}function b(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(t)}function w(e){return e?1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}:_}var C,k=((C=function(){function e(t){_classCallCheck(this,e),this._isScalar=!1,t&&(this._subscribe=t)}return _createClass(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this.operator,i=function(e,t,n){if(e){if(e instanceof v)return e;if(e[y])return e[y]()}return e||t||n?new v(e,t,n):new v(s)}(e,t,n);if(i.add(r?r.call(i,this.source):this.source||o.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),o.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){o.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,r=t.destination,i=t.isStopped;if(n||i)return!1;e=r&&r instanceof v?r:null}return!0}(e)?e.error(t):console.warn(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=S(t))(function(t,r){var i;i=n.subscribe(function(t){try{e(t)}catch(n){r(n),i&&i.unsubscribe()}},r,t)})}},{key:"_subscribe",value:function(e){var t=this.source;return t&&t.subscribe(e)}},{key:g,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?this:w(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=S(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}}]),e}()).create=function(e){return new C(e)},C);function S(e){if(e||(e=o.Promise||Promise),!e)throw new Error("no Promise impl found");return e}function E(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}E.prototype=Object.create(Error.prototype);var T,I=E,A=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).subject=e,r.subscriber=n,r.closed=!1,r}return _inherits(t,d),_createClass(t,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}}}]),t}(),D=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).destination=e,n}return _inherits(t,v),t}(),N=((T=function(e){function t(){var e;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return _inherits(t,k),_createClass(t,[{key:y,value:function(){return new D(this)}},{key:"lift",value:function(e){var t=new R(this,this);return t.operator=e,t}},{key:"next",value:function(e){if(this.closed)throw new I;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)}},{key:"error",value:function(e){if(this.closed)throw new I;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new I;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(e){if(this.closed)throw new I;return _get(_getPrototypeOf(t.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){if(this.closed)throw new I;return this.hasError?(e.error(this.thrownError),d.EMPTY):this.isStopped?(e.complete(),d.EMPTY):(this.observers.push(e),new A(this,e))}},{key:"asObservable",value:function(){var e=new k;return e.source=this,e}}]),t}()).create=function(e,t){return new R(e,t)},T),R=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).destination=e,r.source=n,r}return _inherits(t,N),_createClass(t,[{key:"next",value:function(e){var t=this.destination;t&&t.next&&t.next(e)}},{key:"error",value:function(e){var t=this.destination;t&&t.error&&this.destination.error(e)}},{key:"complete",value:function(){var e=this.destination;e&&e.complete&&this.destination.complete()}},{key:"_subscribe",value:function(e){return this.source?this.source.subscribe(e):d.EMPTY}}]),t}();function x(e){return e&&"function"==typeof e.schedule}var O=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).parent=e,i.outerValue=n,i.outerIndex=r,i.index=0,i}return _inherits(t,v),_createClass(t,[{key:"_next",value:function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}},{key:"_error",value:function(e){this.parent.notifyError(e,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),t}(),P=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.closed||t.complete()}},M=function(e){return function(t){return e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,a),t}};var L="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",V=function(e){return function(t){for(var n=e[L]();;){var r=n.next();if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add(function(){n.return&&n.return()}),t}},F=function(e){return function(t){var n=e[g]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(t)}},U=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function q(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var B=function(e){if(e instanceof k)return function(t){return e._isScalar?(t.next(e.value),void t.complete()):e.subscribe(t)};if(e&&"function"==typeof e[g])return F(e);if(U(e))return P(e);if(q(e))return M(e);if(e&&"function"==typeof e[L])return V(e);var t=c(e)?"an invalid object":"'".concat(e,"'");throw new TypeError("You provided ".concat(t," where a stream was expected.")+" You can provide an Observable, Promise, Array, or Iterable.")};function j(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new O(e,n,r);if(!i.closed)return B(t)(i)}var z=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,v),_createClass(t,[{key:"notifyNext",value:function(e,t,n,r,i){this.destination.next(t)}},{key:"notifyError",value:function(e,t){this.destination.error(e)}},{key:"notifyComplete",value:function(e){this.destination.complete()}}]),t}();function Q(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new H(e,t))}}var H=function(){function e(t,n){_classCallCheck(this,e),this.project=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new W(e,this.project,this.thisArg))}}]),e}(),W=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).project=n,i.count=0,i.thisArg=r||_assertThisInitialized(i),i}return _inherits(t,v),_createClass(t,[{key:"_next",value:function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),t}();function G(e,t){return new k(t?function(n){var r=new d,i=0;return r.add(t.schedule(function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()})),r}:P(e))}function K(e,t){if(!t)return e instanceof k?e:new k(B(e));if(null!=e){if(function(e){return e&&"function"==typeof e[g]}(e))return function(e,t){return new k(t?function(n){var r=new d;return r.add(t.schedule(function(){var i=e[g]();r.add(i.subscribe({next:function(e){r.add(t.schedule(function(){return n.next(e)}))},error:function(e){r.add(t.schedule(function(){return n.error(e)}))},complete:function(){r.add(t.schedule(function(){return n.complete()}))}}))})),r}:F(e))}(e,t);if(q(e))return function(e,t){return new k(t?function(n){var r=new d;return r.add(t.schedule(function(){return e.then(function(e){r.add(t.schedule(function(){n.next(e),r.add(t.schedule(function(){return n.complete()}))}))},function(e){r.add(t.schedule(function(){return n.error(e)}))})})),r}:M(e))}(e,t);if(U(e))return G(e,t);if(function(e){return e&&"function"==typeof e[L]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new k(t?function(n){var r,i=new d;return i.add(function(){r&&"function"==typeof r.return&&r.return()}),i.add(t.schedule(function(){r=e[L](),i.add(t.schedule(function(){if(!n.closed){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(o){return void n.error(o)}t?n.complete():(n.next(e),this.schedule())}}))})),i}:V(e))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}function Y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof t?function(r){return r.pipe(Y(function(n,r){return K(e(n,r)).pipe(Q(function(e,i){return t(n,e,r,i)}))},n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new Z(e,n))})}var Z=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;_classCallCheck(this,e),this.project=t,this.concurrent=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new J(e,this.project,this.concurrent))}}]),e}(),J=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).project=n,r.concurrent=i,r.hasCompleted=!1,r.buffer=[],r.active=0,r.index=0,r}return _inherits(t,z),_createClass(t,[{key:"_next",value:function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t,e,n)}},{key:"_innerSub",value:function(e,t,n){var r=new O(this,void 0,void 0);this.destination.add(r),j(this,e,t,n,r)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(e,t,n,r,i){this.destination.next(t)}},{key:"notifyComplete",value:function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),t}();function X(e){return e}function $(){return Y(X,arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY)}function ee(){return function(e){return e.lift(new te(e))}}var te=function(){function e(t){_classCallCheck(this,e),this.connectable=t}return _createClass(e,[{key:"call",value:function(e,t){var n=this.connectable;n._refCount++;var r=new ne(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i}}]),e}(),ne=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).connectable=n,r}return _inherits(t,v),_createClass(t,[{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null}}]),t}(),re=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return _inherits(t,k),_createClass(t,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new d).add(this.source.subscribe(new oe(this.getSubject(),this))),e.closed?(this._connection=null,e=d.EMPTY):this._connection=e),e}},{key:"refCount",value:function(){return ee()(this)}}]),t}().prototype,ie={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:re._subscribe},_isComplete:{value:re._isComplete,writable:!0},getSubject:{value:re.getSubject},connect:{value:re.connect},refCount:{value:re.refCount}},oe=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).connectable=n,r}return _inherits(t,D),_createClass(t,[{key:"_error",value:function(e){this._unsubscribe(),_get(_getPrototypeOf(t.prototype),"_error",this).call(this,e)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),_get(_getPrototypeOf(t.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}]),t}();function ae(){return new N}function se(){return function(e){return ee()((t=ae,function(e){var n;n="function"==typeof t?t:function(){return t};var r=Object.create(e,ie);return r.source=e,r.subjectFactory=n,r})(e));var t}}var ue="__parameters__";function ce(e,t,n){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var o=_construct(i,t);return a.annotation=o,a;function a(e,t,n){for(var r=e.hasOwnProperty(ue)?e[ue]:Object.defineProperty(e,ue,{value:[]})[ue];r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(o),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i}var le=ce("Inject",function(e){return{token:e}}),he=ce("Optional"),fe=ce("Self"),de=ce("SkipSelf"),pe=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});function ye(e){for(var t in e)if(e[t]===ye)return t;throw Error("Could not find renamed property on target object.")}function ve(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function me(e){var t=e[ge];return t&&t.token===e?t:null}var ge=ye({ngInjectableDef:ye});function _e(e){if("string"==typeof e)return e;if(e instanceof Array)return"["+e.map(_e).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}var be=ye({__forward_ref__:ye});function we(e){return e.__forward_ref__=we,e.toString=function(){return _e(this())},e}function Ce(e){var t=e;return"function"==typeof t&&t.hasOwnProperty(be)&&t.__forward_ref__===we?t():e}var ke,Se="undefined"!=typeof globalThis&&globalThis,Ee="undefined"!=typeof window&&window,Te="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ie="undefined"!=typeof global&&global,Ae=Se||Ie||Ee||Te,De=function(){function e(t,n){_classCallCheck(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.ngInjectableDef=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.ngInjectableDef=ve({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return _createClass(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),Ne=new De("INJECTOR",-1),Re=new Object,xe=/\n/gm,Oe="\u0275",Pe="__source",Me=ye({provide:String,useValue:ye}),Le=void 0;function Ve(e){var t=Le;return Le=e,t}function Fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pe.Default;return(ke||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pe.Default;if(void 0===Le)throw new Error("inject() must be called from an injection context");return null===Le?function(e,t,n){var r=me(e);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&pe.Optional)return null;throw new Error("Injector: NOT_FOUND [".concat(_e(e),"]"))}(e,0,t):Le.get(e,t&pe.Optional?null:void 0,t)})(e,t)}var Ue=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Re;if(t===Re){var n=new Error("NullInjectorError: No provider for ".concat(_e(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}();function qe(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&e.charAt(1)==Oe?e.substr(2):e;var i=_e(t);if(t instanceof Array)i=t.map(_e).join(" -> ");else if("object"==typeof t){var o=[];for(var a in t)if(t.hasOwnProperty(a)){var s=t[a];o.push(a+":"+("string"==typeof s?JSON.stringify(s):_e(s)))}i="{".concat(o.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(xe,"\n  "))}var Be=function e(){_classCallCheck(this,e)},je=function e(){_classCallCheck(this,e)};function ze(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function Qe(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}var He=function(){var e={Emulated:0,Native:1,None:2,ShadowDom:3};return e[e.Emulated]="Emulated",e[e.Native]="Native",e[e.None]="None",e[e.ShadowDom]="ShadowDom",e}(),We=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Ae),Ge="ngDebugContext",Ke="ngOriginalError",Ye="ngErrorLogger";function Ze(e){return e[Ge]}function Je(e){return e[Ke]}function Xe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var $e=function(){function e(){_classCallCheck(this,e),this._console=console}return _createClass(e,[{key:"handleError",value:function(e){var t=this._findOriginalError(e),n=this._findContext(e),r=function(e){return e[Ye]||Xe}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)}},{key:"_findContext",value:function(e){return e?Ze(e)?Ze(e):this._findContext(Je(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=Je(e);t&&Je(t);)t=Je(t);return t}}]),e}(),et=!0,tt=!1;function nt(){return tt=!0,et}var rt=function(){function e(t){if(_classCallCheck(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),this.inertBodyElement=this.inertDocument.body,null==this.inertBodyElement){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n),this.inertBodyElement=this.inertDocument.createElement("body"),n.appendChild(this.inertBodyElement)}this.inertBodyElement.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!this.inertBodyElement.querySelector||this.inertBodyElement.querySelector("svg")?(this.inertBodyElement.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=this.inertBodyElement.querySelector&&this.inertBodyElement.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(e){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}return _createClass(e,[{key:"getInertBodyElement_XHR",value:function(e){e="<body><remove></remove>"+e+"</body>";try{e=encodeURI(e)}catch(r){return null}var t=new XMLHttpRequest;t.responseType="document",t.open("GET","data:text/html;charset=utf-8,"+e,!1),t.send(void 0);var n=t.response.body;return n.removeChild(n.firstChild),n}},{key:"getInertBodyElement_DOMParser",value:function(e){e="<body><remove></remove>"+e+"</body>";try{var t=(new window.DOMParser).parseFromString(e,"text/html").body;return t.removeChild(t.firstChild),t}catch(n){return null}}},{key:"getInertBodyElement_InertDocument",value:function(e){var t=this.inertDocument.createElement("template");return"content"in t?(t.innerHTML=e,t):(this.inertBodyElement.innerHTML=e,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(this.inertBodyElement),this.inertBodyElement)}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;"xmlns:ns1"!==r&&0!==r.indexOf("ns1:")||e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),it=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,ot=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function at(e){return(e=String(e)).match(it)||e.match(ot)?e:(nt()&&console.warn("WARNING: sanitizing unsafe URL value ".concat(e," (see http://g.co/ng/security#xss)")),"unsafe:"+e)}function st(e){var t={},n=!0,r=!1,i=void 0;try{for(var o,a=e.split(",")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){t[o.value]=!0}}catch(s){r=!0,i=s}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}function ut(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];for(var s in a)a.hasOwnProperty(s)&&(e[s]=!0)}return e}var ct,lt=st("area,br,col,hr,img,wbr"),ht=st("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),ft=st("rp,rt"),dt=ut(ft,ht),pt=ut(lt,ut(ht,st("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ut(ft,st("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),dt),yt=st("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),vt=st("srcset"),mt=ut(yt,vt,st("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),st("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),gt=st("script,style,template"),_t=function(){function e(){_classCallCheck(this,e),this.sanitizedSomething=!1,this.buf=[]}return _createClass(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!pt.hasOwnProperty(t))return this.sanitizedSomething=!0,!gt.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n,r=e.attributes,i=0;i<r.length;i++){var o=r.item(i),a=o.name,s=a.toLowerCase();if(mt.hasOwnProperty(s)){var u=o.value;yt[s]&&(u=at(u)),vt[s]&&(n=u,u=(n=String(n)).split(",").map(function(e){return at(e.trim())}).join(", ")),this.buf.push(" ",a,'="',Ct(u),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();pt.hasOwnProperty(t)&&!lt.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(Ct(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),bt=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,wt=/([^\#-~ |!])/g;function Ct(e){return e.replace(/&/g,"&amp;").replace(bt,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(wt,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function kt(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var St=function(){var e={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return e[e.NONE]="NONE",e[e.HTML]="HTML",e[e.STYLE]="STYLE",e[e.SCRIPT]="SCRIPT",e[e.URL]="URL",e[e.RESOURCE_URL]="RESOURCE_URL",e}(),Et=function e(){_classCallCheck(this,e)},Tt=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),It=/^url\(([^)]+)\)$/,At=/([A-Z])/g;function Dt(e){try{return null!=e?e.toString().slice(0,30):e}catch(t){return"[ERROR] Exception while trying to serialize the value"}}var Nt=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Rt()},e}(),Rt=function(){},xt=new De("The presence of this token marks an injector as being the root injector."),Ot=function(e,t,n){return new Ut(e,t,n)},Pt=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?Ot(e,t,""):Ot(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=Re,e.NULL=new Ue,e.ngInjectableDef=ve({token:e,providedIn:"any",factory:function(){return Fe(Ne)}}),e.__NG_ELEMENT_ID__=-1,e}(),Mt=function(e){return e},Lt=[],Vt=Mt,Ft=function(){return Array.prototype.slice.call(arguments)},Ut=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pt.NULL,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;_classCallCheck(this,e),this.parent=n,this.source=r;var i=this._records=new Map;i.set(Pt,{token:Pt,fn:Mt,deps:Lt,value:this,useNew:!1}),i.set(Ne,{token:Ne,fn:Mt,deps:Lt,value:this,useNew:!1}),function e(t,n){if(n)if((n=Ce(n))instanceof Array)for(var r=0;r<n.length;r++)e(t,n[r]);else{if("function"==typeof n)throw Bt("Function/Class not supported",n);if(!n||"object"!=typeof n||!n.provide)throw Bt("Unexpected provider",n);var i=Ce(n.provide),o=function(e){var t=function(e){var t=Lt,n=e.deps;if(n&&n.length){t=[];for(var r=0;r<n.length;r++){var i=6,o=Ce(n[r]);if(o instanceof Array)for(var a=0,s=o;a<s.length;a++){var u=s[a];u instanceof he||u==he?i|=1:u instanceof de||u==de?i&=-3:u instanceof fe||u==fe?i&=-5:o=u instanceof le?u.token:Ce(u)}t.push({token:o,options:i})}}else if(e.useExisting)t=[{token:Ce(e.useExisting),options:6}];else if(!(n||Me in e))throw Bt("'deps' required",e);return t}(e),n=Mt,r=Lt,i=!1,o=Ce(e.provide);if(Me in e)r=e.useValue;else if(e.useFactory)n=e.useFactory;else if(e.useExisting);else if(e.useClass)i=!0,n=Ce(e.useClass);else{if("function"!=typeof o)throw Bt("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",e);i=!0,n=o}return{deps:t,fn:n,useNew:i,value:r}}(n);if(!0===n.multi){var a=t.get(i);if(a){if(a.fn!==Ft)throw qt(i)}else t.set(i,a={token:n.provide,deps:[],useNew:!1,fn:Ft,value:Lt});a.deps.push({token:i=n,options:6})}var s=t.get(i);if(s&&s.fn==Ft)throw qt(i);t.set(i,o)}}(i,t)}return _createClass(e,[{key:"get",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pe.Default,r=this._records.get(e);try{return function e(t,n,r,i,o,a){try{return function(t,n,r,i,o,a){var s;if(!n||a&pe.SkipSelf)a&pe.Self||(s=i.get(t,o,pe.Default));else{if((s=n.value)==Vt)throw Error("\u0275Circular dependency");if(s===Lt){n.value=Vt;var u=n.useNew,c=n.fn,l=n.deps,h=Lt;if(l.length){h=[];for(var f=0;f<l.length;f++){var d=l[f],p=d.options,y=2&p?r.get(d.token):void 0;h.push(e(d.token,y,r,y||4&p?i:Pt.NULL,1&p?null:Pt.THROW_IF_NOT_FOUND,pe.Default))}}n.value=s=u?_construct(c,_toConsumableArray(h)):c.apply(void 0,h)}}return s}(t,n,r,i,o,a)}catch(s){throw s instanceof Error||(s=new Error(s)),(s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(t),n&&n.value==Vt&&(n.value=Lt),s}}(e,r,this._records,this.parent,t,n)}catch(i){return function(e,t,n,r){var i=e.ngTempTokenPath;throw t[Pe]&&i.unshift(t[Pe]),e.message=qe("\n"+e.message,i,"StaticInjectorError",r),e.ngTokenPath=i,e.ngTempTokenPath=null,e}(i,e,0,this.source)}}},{key:"toString",value:function(){var e=[];return this._records.forEach(function(t,n){return e.push(_e(n))}),"StaticInjector[".concat(e.join(", "),"]")}}]),e}();function qt(e){return Bt("Cannot mix multi providers and regular providers",e)}function Bt(e,t){return new Error(qe(e,t,"StaticInjectorError"))}var jt=new De("AnalyzeForEntryComponents"),zt=null;function Qt(){if(!zt){var e=Ae.Symbol;if(e&&e.iterator)zt=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(zt=r)}}return zt}function Ht(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}function Wt(e,t){var n=Kt(e),r=Kt(t);return n&&r?function(e,t,n){for(var r=e[Qt()](),i=t[Qt()]();;){var o=r.next(),a=i.next();if(o.done&&a.done)return!0;if(o.done||a.done)return!1;if(!n(o.value,a.value))return!1}}(e,t,Wt):!(n||!(e&&("object"==typeof e||"function"==typeof e))||r||!(t&&("object"==typeof t||"function"==typeof t)))||Ht(e,t)}var Gt=function(){function e(t){_classCallCheck(this,e),this.wrapped=t}return _createClass(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function Kt(e){return!!Yt(e)&&(Array.isArray(e)||!(e instanceof Map)&&Qt()in e)}function Yt(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Zt(e){return!!e&&"function"==typeof e.then}function Jt(e){return!!e&&"function"==typeof e.subscribe}var Xt=function(){function e(t,n,r){_classCallCheck(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return _createClass(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}(),$t=function e(){_classCallCheck(this,e)},en=function e(){_classCallCheck(this,e)};function tn(e){var t=Error("No component factory found for ".concat(_e(e),". Did you add it to @NgModule.entryComponents?"));return t[nn]=e,t}var nn="ngComponent",rn=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"resolveComponentFactory",value:function(e){throw tn(e)}}]),e}(),on=function(){var e=function e(){_classCallCheck(this,e)};return e.NULL=new rn,e}(),an=function(){function e(t,n,r){_classCallCheck(this,e),this._parent=n,this._ngModule=r,this._factories=new Map;for(var i=0;i<t.length;i++){var o=t[i];this._factories.set(o.componentType,o)}}return _createClass(e,[{key:"resolveComponentFactory",value:function(e){var t=this._factories.get(e);if(!t&&this._parent&&(t=this._parent.resolveComponentFactory(e)),!t)throw tn(e);return new sn(t,this._ngModule)}}]),e}(),sn=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).factory=e,r.ngModule=n,r.selector=e.selector,r.componentType=e.componentType,r.ngContentSelectors=e.ngContentSelectors,r.inputs=e.inputs,r.outputs=e.outputs,r}return _inherits(t,en),_createClass(t,[{key:"create",value:function(e,t,n,r){return this.factory.create(e,t,n,r||this.ngModule)}}]),t}();function un(){}var cn=function(){var e=function e(t){_classCallCheck(this,e),this.nativeElement=t};return e.__NG_ELEMENT_ID__=function(){return ln(e)},e}(),ln=un,hn=function e(){_classCallCheck(this,e)},fn=function(){var e={Important:1,DashCase:2};return e[e.Important]="Important",e[e.DashCase]="DashCase",e}(),dn=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return pn()},e}(),pn=un,yn=new function e(t){_classCallCheck(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}("8.2.10"),vn=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return Kt(e)}},{key:"create",value:function(e){return new gn(e)}}]),e}(),mn=function(e,t){return t},gn=function(){function e(t){_classCallCheck(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||mn}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var o=!n||t&&t.currentIndex<Cn(n,r,i)?t:n,a=Cn(o,r,i),s=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{i||(i=[]);var u=a-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var h=l<i.length?i[l]:i[l]=0,f=h+l;c<=f&&f<u&&(i[l]=h+1)}i[o.previousIndex]=c-u}}a!==s&&e(o,a,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!Kt(e))throw new Error("Error trying to diff '".concat(_e(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,o=this._itHead,a=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)i=this._trackByFn(s,r=e[s]),null!==o&&Ht(o.trackById,i)?(a&&(o=this._verifyReinsertion(o,r,i,s)),Ht(o.item,r)||this._addIdentityChange(o,r)):(o=this._mismatch(o,r,i,s),a=!0),o=o._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[Qt()]();!(r=i.next()).done;)t(r.value)}(e,function(e){i=t._trackByFn(n,e),null!==o&&Ht(o.trackById,i)?(a&&(o=t._verifyReinsertion(o,e,i,n)),Ht(o.item,e)||t._addIdentityChange(o,e)):(o=t._mismatch(o,e,i,n),a=!0),o=o._next,n++}),this.length=n;return this._truncate(o),this.collection=e,this.isDirty}},{key:"_reset",value:function(){if(this.isDirty){var e,t;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=t)e.previousIndex=e.currentIndex,t=e._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Ht(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Ht(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):e=this._addAfter(new _n(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new wn),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t?e:(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e,e)}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new wn),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}}]),e}(),_n=function e(t,n){_classCallCheck(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},bn=function(){function e(){_classCallCheck(this,e),this._head=null,this._tail=null}return _createClass(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Ht(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),wn=function(){function e(){_classCallCheck(this,e),this.map=new Map}return _createClass(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new bn,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"clear",value:function(){this.map.clear()}},{key:"isEmpty",get:function(){return 0===this.map.size}}]),e}();function Cn(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var kn=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return e instanceof Map||Yt(e)}},{key:"create",value:function(){return new Sn}}]),e}(),Sn=function(){function e(){_classCallCheck(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||Yt(e)))throw new Error("Error trying to diff '".concat(_e(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var o=new En(e);return this._records.set(e,o),o.currentValue=t,this._addToAdditions(o),o}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Ht(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}}]),e}(),En=function e(t){_classCallCheck(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null},Tn=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t,n=this.factories.find(function(t){return t.supports(e)});if(null!=n)return n;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return e.create(t,n)},deps:[[e,new de,new he]]}}}]),e}();return e.ngInjectableDef=ve({token:e,providedIn:"root",factory:function(){return new e([new vn])}}),e}(),In=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return e.create(t,n)},deps:[[e,new de,new he]]}}}]),e}();return e.ngInjectableDef=ve({token:e,providedIn:"root",factory:function(){return new e([new kn])}}),e}(),An=[new kn],Dn=new Tn([new vn]),Nn=new In(An),Rn=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return xn(e,cn)},e}(),xn=un,On=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Pn(e,cn)},e}(),Pn=un;function Mn(e,t,n,r){var i="ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '".concat(t,"'. Current value: '").concat(n,"'.");return r&&(i+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),function(e,t){var n=new Error(e);return Ln(n,t),n}(i,e)}function Ln(e,t){e[Ge]=t,e[Ye]=t.logError.bind(t)}function Vn(e){return new Error("ViewDestroyedError: Attempt to use a destroyed view: ".concat(e))}function Fn(e,t,n){var r=e.state,i=1792&r;return i===t?(e.state=-1793&r|n,e.initIndex=-1,!0):i===n}function Un(e,t,n){return(1792&e.state)===t&&e.initIndex<=n&&(e.initIndex=n+1,!0)}function qn(e,t){return e.nodes[t]}function Bn(e,t){return e.nodes[t]}function jn(e,t){return e.nodes[t]}function zn(e,t){return e.nodes[t]}function Qn(e,t){return e.nodes[t]}var Hn={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0},Wn=function(){},Gn=new Map;function Kn(e){var t=Gn.get(e);return t||(t=_e(e)+"_"+Gn.size,Gn.set(e,t)),t}var Yn="$$undefined",Zn="$$empty";function Jn(e){return{id:Yn,styles:e.styles,encapsulation:e.encapsulation,data:e.data}}var Xn=0;function $n(e,t,n,r){return!(!(2&e.state)&&Ht(e.oldValues[t.bindingIndex+n],r))}function er(e,t,n,r){return!!$n(e,t,n,r)&&(e.oldValues[t.bindingIndex+n]=r,!0)}function tr(e,t,n,r){var i=e.oldValues[t.bindingIndex+n];if(1&e.state||!Wt(i,r)){var o=t.bindings[n].name;throw Mn(Hn.createDebugContext(e,t.nodeIndex),"".concat(o,": ").concat(i),"".concat(o,": ").concat(r),0!=(1&e.state))}}function nr(e){for(var t=e;t;)2&t.def.flags&&(t.state|=8),t=t.viewContainerParent||t.parent}function rr(e,t){for(var n=e;n&&n!==t;)n.state|=64,n=n.viewContainerParent||n.parent}function ir(e,t,n,r){try{return nr(33554432&e.def.nodes[t].flags?Bn(e,t).componentView:e),Hn.handleEvent(e,t,n,r)}catch(i){e.root.errorHandler.handleError(i)}}function or(e){return e.parent?Bn(e.parent,e.parentNodeDef.nodeIndex):null}function ar(e){return e.parent?e.parentNodeDef.parent:null}function sr(e,t){switch(201347067&t.flags){case 1:return Bn(e,t.nodeIndex).renderElement;case 2:return qn(e,t.nodeIndex).renderText}}function ur(e){return!!e.parent&&!!(32768&e.parentNodeDef.flags)}function cr(e){return!(!e.parent||32768&e.parentNodeDef.flags)}function lr(e){var t={},n=0,r={};return e&&e.forEach(function(e){var i=_slicedToArray(e,2),o=i[0],a=i[1];"number"==typeof o?(t[o]=a,n|=function(e){return 1<<e%32}(o)):r[o]=a}),{matchedQueries:t,references:r,matchedQueryIds:n}}function hr(e,t){return e.map(function(e){var n,r,i;return Array.isArray(e)?(i=(n=_slicedToArray(e,2))[0],r=n[1]):(i=0,r=e),r&&("function"==typeof r||"object"==typeof r)&&t&&Object.defineProperty(r,Pe,{value:t,configurable:!0}),{flags:i,token:r,tokenKey:Kn(r)}})}function fr(e,t,n){var r=n.renderParent;return r?0==(1&r.flags)||0==(33554432&r.flags)||r.element.componentRendererType&&r.element.componentRendererType.encapsulation===He.Native?Bn(e,n.renderParent.nodeIndex).renderElement:void 0:t}var dr=new WeakMap;function pr(e){var t=dr.get(e);return t||((t=e(function(){return Wn})).factory=e,dr.set(e,t)),t}function yr(e,t,n,r,i){3===t&&(n=e.renderer.parentNode(sr(e,e.def.lastRenderRootNode))),vr(e,t,0,e.def.nodes.length-1,n,r,i)}function vr(e,t,n,r,i,o,a){for(var s=n;s<=r;s++){var u=e.def.nodes[s];11&u.flags&&gr(e,u,t,i,o,a),s+=u.childCount}}function mr(e,t,n,r,i,o){for(var a=e;a&&!ur(a);)a=a.parent;for(var s=a.parent,u=ar(a),c=u.nodeIndex+u.childCount,l=u.nodeIndex+1;l<=c;l++){var h=s.def.nodes[l];h.ngContentIndex===t&&gr(s,h,n,r,i,o),l+=h.childCount}if(!s.parent){var f=e.root.projectableNodes[t];if(f)for(var d=0;d<f.length;d++)_r(e,f[d],n,r,i,o)}}function gr(e,t,n,r,i,o){if(8&t.flags)mr(e,t.ngContent.index,n,r,i,o);else{var a=sr(e,t);if(3===n&&33554432&t.flags&&48&t.bindingFlags?(16&t.bindingFlags&&_r(e,a,n,r,i,o),32&t.bindingFlags&&_r(Bn(e,t.nodeIndex).componentView,a,n,r,i,o)):_r(e,a,n,r,i,o),16777216&t.flags)for(var s=Bn(e,t.nodeIndex).viewContainer._embeddedViews,u=0;u<s.length;u++)yr(s[u],n,r,i,o);1&t.flags&&!t.element.name&&vr(e,n,t.nodeIndex+1,t.nodeIndex+t.childCount,r,i,o)}}function _r(e,t,n,r,i,o){var a=e.renderer;switch(n){case 1:a.appendChild(r,t);break;case 2:a.insertBefore(r,t,i);break;case 3:a.removeChild(r,t);break;case 0:o.push(t)}}var br=/^:([^:]+):(.+)$/;function wr(e){if(":"===e[0]){var t=e.match(br);return[t[1],t[2]]}return["",e]}function Cr(e){for(var t=0,n=0;n<e.length;n++)t|=e[n].flags;return t}var kr=new Object,Sr=Kn(Pt),Er=Kn(Ne),Tr=Kn(Be);function Ir(e,t,n,r){return n=Ce(n),{index:-1,deps:hr(r,_e(t)),flags:e,token:t,value:n}}function Ar(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pt.THROW_IF_NOT_FOUND,o=Ve(e);try{if(8&t.flags)return t.token;if(2&t.flags&&(i=null),1&t.flags)return e._parent.get(t.token,i);var a=t.tokenKey;switch(a){case Sr:case Er:case Tr:return e}var s,u=e._def.providersByKey[a];if(u){var c=e._providers[u.index];return void 0===c&&(c=e._providers[u.index]=Dr(e,u)),c===kr?void 0:c}if((s=me(t.token))&&(n=e,null!=(r=s).providedIn&&(function(e,t){return e._def.modules.indexOf(r.providedIn)>-1}(n)||"root"===r.providedIn&&n._def.isRoot))){var l=e._providers.length;return e._def.providers[l]=e._def.providersByKey[t.tokenKey]={flags:5120,value:s.factory,deps:[],index:l,token:t.token},e._providers[l]=kr,e._providers[l]=Dr(e,e._def.providersByKey[t.tokenKey])}return 4&t.flags?i:e._parent.get(t.token,i)}finally{Ve(o)}}function Dr(e,t){var n;switch(201347067&t.flags){case 512:n=function(e,t,n){var r=n.length;switch(r){case 0:return new t;case 1:return new t(Ar(e,n[0]));case 2:return new t(Ar(e,n[0]),Ar(e,n[1]));case 3:return new t(Ar(e,n[0]),Ar(e,n[1]),Ar(e,n[2]));default:for(var i=new Array(r),o=0;o<r;o++)i[o]=Ar(e,n[o]);return _construct(t,i)}}(e,t.value,t.deps);break;case 1024:n=function(e,t,n){var r=n.length;switch(r){case 0:return t();case 1:return t(Ar(e,n[0]));case 2:return t(Ar(e,n[0]),Ar(e,n[1]));case 3:return t(Ar(e,n[0]),Ar(e,n[1]),Ar(e,n[2]));default:for(var i=Array(r),o=0;o<r;o++)i[o]=Ar(e,n[o]);return t.apply(void 0,i)}}(e,t.value,t.deps);break;case 2048:n=Ar(e,t.deps[0]);break;case 256:n=t.value}return n===kr||null===n||"object"!=typeof n||131072&t.flags||"function"!=typeof n.ngOnDestroy||(t.flags|=131072),void 0===n?kr:n}function Nr(e,t){var n=e.viewContainer._embeddedViews;if((null==t||t>=n.length)&&(t=n.length-1),t<0)return null;var r=n[t];return r.viewContainerParent=null,Qe(n,t),Hn.dirtyParentQueries(r),xr(r),r}function Rr(e,t,n){var r=t?sr(t,t.def.lastRenderRootNode):e.renderElement,i=n.renderer.parentNode(r),o=n.renderer.nextSibling(r);yr(n,2,i,o,void 0)}function xr(e){yr(e,3,null,null,void 0)}var Or=new Object;function Pr(e,t,n,r,i,o){return new Mr(e,t,n,r,i,o)}var Mr=function(e){function t(e,n,r,i,o,a){var s;return _classCallCheck(this,t),(s=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).selector=e,s.componentType=n,s._inputs=i,s._outputs=o,s.ngContentSelectors=a,s.viewDefFactory=r,s}return _inherits(t,en),_createClass(t,[{key:"create",value:function(e,t,n,r){if(!r)throw new Error("ngModule should be provided");var i=pr(this.viewDefFactory),o=i.nodes[0].element.componentProvider.nodeIndex,a=Hn.createRootView(e,t||[],n,i,r,Or),s=jn(a,o).instance;return n&&a.renderer.setAttribute(Bn(a,0).renderElement,"ng-version",yn.full),new Lr(a,new qr(a),s)}},{key:"inputs",get:function(){var e=[],t=this._inputs;for(var n in t)e.push({propName:n,templateName:t[n]});return e}},{key:"outputs",get:function(){var e=[];for(var t in this._outputs)e.push({propName:t,templateName:this._outputs[t]});return e}}]),t}(),Lr=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._view=e,i._viewRef=n,i._component=r,i._elDef=i._view.def.nodes[0],i.hostView=n,i.changeDetectorRef=n,i.instance=r,i}return _inherits(t,$t),_createClass(t,[{key:"destroy",value:function(){this._viewRef.destroy()}},{key:"onDestroy",value:function(e){this._viewRef.onDestroy(e)}},{key:"location",get:function(){return new cn(Bn(this._view,this._elDef.nodeIndex).renderElement)}},{key:"injector",get:function(){return new Qr(this._view,this._elDef)}},{key:"componentType",get:function(){return this._component.constructor}}]),t}();function Vr(e,t,n){return new Fr(e,t,n)}var Fr=function(){function e(t,n,r){_classCallCheck(this,e),this._view=t,this._elDef=n,this._data=r,this._embeddedViews=[]}return _createClass(e,[{key:"clear",value:function(){for(var e=this._embeddedViews.length-1;e>=0;e--){var t=Nr(this._data,e);Hn.destroyView(t)}}},{key:"get",value:function(e){var t=this._embeddedViews[e];if(t){var n=new qr(t);return n.attachToViewContainerRef(this),n}return null}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var o=n||this.parentInjector;i||e instanceof sn||(i=o.get(Be));var a=e.create(o,r,void 0,i);return this.insert(a.hostView,t),a}},{key:"insert",value:function(e,t){if(e.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");var n,r,i,o,a,s=e;return n=this._view,r=this._data,i=t,o=s._view,a=r.viewContainer._embeddedViews,null==i&&(i=a.length),o.viewContainerParent=n,ze(a,i,o),function(e,t){var n=or(t);if(n&&n!==e&&!(16&t.state)){t.state|=16;var r=n.template._projectedViews;r||(r=n.template._projectedViews=[]),r.push(t),function(e,n){if(!(4&n.flags)){t.parent.def.nodeFlags|=4,n.flags|=4;for(var r=n.parent;r;)r.childFlags|=4,r=r.parent}}(0,t.parentNodeDef)}}(r,o),Hn.dirtyParentQueries(o),Rr(r,i>0?a[i-1]:null,o),s.attachToViewContainerRef(this),e}},{key:"move",value:function(e,t){if(e.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");var n,r,i,o,a=this._embeddedViews.indexOf(e._view);return n=this._data,r=t,i=n.viewContainer._embeddedViews,o=i[a],Qe(i,a),null==r&&(r=i.length),ze(i,r,o),Hn.dirtyParentQueries(o),xr(o),Rr(n,r>0?i[r-1]:null,o),e}},{key:"indexOf",value:function(e){return this._embeddedViews.indexOf(e._view)}},{key:"remove",value:function(e){var t=Nr(this._data,e);t&&Hn.destroyView(t)}},{key:"detach",value:function(e){var t=Nr(this._data,e);return t?new qr(t):null}},{key:"element",get:function(){return new cn(this._data.renderElement)}},{key:"injector",get:function(){return new Qr(this._view,this._elDef)}},{key:"parentInjector",get:function(){for(var e=this._view,t=this._elDef.parent;!t&&e;)t=ar(e),e=e.parent;return e?new Qr(e,t):new Qr(this._view,null)}},{key:"length",get:function(){return this._embeddedViews.length}}]),e}();function Ur(e){return new qr(e)}var qr=function(){function e(t){_classCallCheck(this,e),this._view=t,this._viewContainerRef=null,this._appRef=null}return _createClass(e,[{key:"markForCheck",value:function(){nr(this._view)}},{key:"detach",value:function(){this._view.state&=-5}},{key:"detectChanges",value:function(){var e=this._view.root.rendererFactory;e.begin&&e.begin();try{Hn.checkAndUpdateView(this._view)}finally{e.end&&e.end()}}},{key:"checkNoChanges",value:function(){Hn.checkNoChangesView(this._view)}},{key:"reattach",value:function(){this._view.state|=4}},{key:"onDestroy",value:function(e){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(e)}},{key:"destroy",value:function(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),Hn.destroyView(this._view)}},{key:"detachFromAppRef",value:function(){this._appRef=null,xr(this._view),Hn.dirtyParentQueries(this._view)}},{key:"attachToAppRef",value:function(e){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}},{key:"attachToViewContainerRef",value:function(e){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=e}},{key:"rootNodes",get:function(){return yr(this._view,0,void 0,void 0,e=[]),e;var e}},{key:"context",get:function(){return this._view.context}},{key:"destroyed",get:function(){return 0!=(128&this._view.state)}}]),e}();function Br(e,t){return new jr(e,t)}var jr=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._parentView=e,r._def=n,r}return _inherits(t,Rn),_createClass(t,[{key:"createEmbeddedView",value:function(e){return new qr(Hn.createEmbeddedView(this._parentView,this._def,this._def.element.template,e))}},{key:"elementRef",get:function(){return new cn(Bn(this._parentView,this._def.nodeIndex).renderElement)}}]),t}();function zr(e,t){return new Qr(e,t)}var Qr=function(){function e(t,n){_classCallCheck(this,e),this.view=t,this.elDef=n}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pt.THROW_IF_NOT_FOUND;return Hn.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:e,tokenKey:Kn(e)},t)}}]),e}();function Hr(e,t){var n=e.def.nodes[t];if(1&n.flags){var r=Bn(e,n.nodeIndex);return n.element.template?r.template:r.renderElement}if(2&n.flags)return qn(e,n.nodeIndex).renderText;if(20240&n.flags)return jn(e,n.nodeIndex).instance;throw new Error("Illegal state: read nodeValue for node index ".concat(t))}function Wr(e){return new Gr(e.renderer)}var Gr=function(){function e(t){_classCallCheck(this,e),this.delegate=t}return _createClass(e,[{key:"selectRootElement",value:function(e){return this.delegate.selectRootElement(e)}},{key:"createElement",value:function(e,t){var n=_slicedToArray(wr(t),2),r=n[0],i=n[1],o=this.delegate.createElement(i,r);return e&&this.delegate.appendChild(e,o),o}},{key:"createViewRoot",value:function(e){return e}},{key:"createTemplateAnchor",value:function(e){var t=this.delegate.createComment("");return e&&this.delegate.appendChild(e,t),t}},{key:"createText",value:function(e,t){var n=this.delegate.createText(t);return e&&this.delegate.appendChild(e,n),n}},{key:"projectNodes",value:function(e,t){for(var n=0;n<t.length;n++)this.delegate.appendChild(e,t[n])}},{key:"attachViewAfter",value:function(e,t){for(var n=this.delegate.parentNode(e),r=this.delegate.nextSibling(e),i=0;i<t.length;i++)this.delegate.insertBefore(n,t[i],r)}},{key:"detachView",value:function(e){for(var t=0;t<e.length;t++){var n=e[t],r=this.delegate.parentNode(n);this.delegate.removeChild(r,n)}}},{key:"destroyView",value:function(e,t){for(var n=0;n<t.length;n++)this.delegate.destroyNode(t[n])}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"listenGlobal",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"setElementProperty",value:function(e,t,n){this.delegate.setProperty(e,t,n)}},{key:"setElementAttribute",value:function(e,t,n){var r=_slicedToArray(wr(t),2),i=r[0],o=r[1];null!=n?this.delegate.setAttribute(e,o,n,i):this.delegate.removeAttribute(e,o,i)}},{key:"setBindingDebugInfo",value:function(e,t,n){}},{key:"setElementClass",value:function(e,t,n){n?this.delegate.addClass(e,t):this.delegate.removeClass(e,t)}},{key:"setElementStyle",value:function(e,t,n){null!=n?this.delegate.setStyle(e,t,n):this.delegate.removeStyle(e,t)}},{key:"invokeElementMethod",value:function(e,t,n){e[t].apply(e,n)}},{key:"setText",value:function(e,t){this.delegate.setValue(e,t)}},{key:"animate",value:function(){throw new Error("Renderer.animate is no longer supported!")}}]),e}();function Kr(e,t,n,r){return new Yr(e,t,n,r)}var Yr=function(){function e(t,n,r,i){_classCallCheck(this,e),this._moduleType=t,this._parent=n,this._bootstrapComponents=r,this._def=i,this._destroyListeners=[],this._destroyed=!1,this.injector=this,function(e){for(var t=e._def,n=e._providers=new Array(t.providers.length),r=0;r<t.providers.length;r++){var i=t.providers[r];4096&i.flags||void 0===n[r]&&(n[r]=Dr(e,i))}}(this)}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pt.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pe.Default,r=0;return n&pe.SkipSelf?r|=1:n&pe.Self&&(r|=4),Ar(this,{token:e,tokenKey:Kn(e),flags:r},t)}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The ng module ".concat(_e(this.instance.constructor)," has already been destroyed."));this._destroyed=!0,function(e,t){for(var n=e._def,r=new Set,i=0;i<n.providers.length;i++)if(131072&n.providers[i].flags){var o=e._providers[i];if(o&&o!==kr){var a=o.ngOnDestroy;"function"!=typeof a||r.has(o)||(a.apply(o),r.add(o))}}}(this),this._destroyListeners.forEach(function(e){return e()})}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"instance",get:function(){return this.get(this._moduleType)}},{key:"componentFactoryResolver",get:function(){return this.get(on)}}]),e}(),Zr=Kn(function e(){_classCallCheck(this,e)}),Jr=Kn(dn),Xr=Kn(cn),$r=Kn(On),ei=Kn(Rn),ti=Kn(Nt),ni=Kn(Pt),ri=Kn(Ne);function ii(e,t,n,r,i,o,a,s){var u=[];if(a)for(var c in a){var l=_slicedToArray(a[c],2),h=l[0],f=l[1];u[h]={flags:8,name:c,nonMinifiedName:f,ns:null,securityContext:null,suffix:null}}var d=[];if(s)for(var p in s)d.push({type:1,propName:p,target:null,eventName:s[p]});return ai(e,t|=16384,n,r,i,i,o,u,d)}function oi(e,t,n,r,i){return ai(-1,e,t,0,n,r,i)}function ai(e,t,n,r,i,o,a,s,u){var c=lr(n),l=c.matchedQueries,h=c.references,f=c.matchedQueryIds;u||(u=[]),s||(s=[]),o=Ce(o);var d=hr(a,_e(i));return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:t,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:l,matchedQueryIds:f,references:h,ngContentIndex:-1,childCount:r,bindings:s,bindingFlags:Cr(s),outputs:u,element:null,provider:{token:i,value:o,deps:d},text:null,query:null,ngContent:null}}function si(e,t){return hi(e,t)}function ui(e,t){for(var n=e;n.parent&&!ur(n);)n=n.parent;return fi(n.parent,ar(n),!0,t.provider.value,t.provider.deps)}function ci(e,t){var n=fi(e,t.parent,(32768&t.flags)>0,t.provider.value,t.provider.deps);if(t.outputs.length)for(var r=0;r<t.outputs.length;r++){var i=t.outputs[r],o=n[i.propName];if(!Jt(o))throw new Error("@Output ".concat(i.propName," not initialized in '").concat(n.constructor.name,"'."));var a=o.subscribe(li(e,t.parent.nodeIndex,i.eventName));e.disposables[t.outputIndex+r]=a.unsubscribe.bind(a)}return n}function li(e,t,n){return function(r){return ir(e,t,n,r)}}function hi(e,t){var n=(8192&t.flags)>0,r=t.provider;switch(201347067&t.flags){case 512:return fi(e,t.parent,n,r.value,r.deps);case 1024:return function(e,t,n,r,i){var o=i.length;switch(o){case 0:return r();case 1:return r(pi(e,t,n,i[0]));case 2:return r(pi(e,t,n,i[0]),pi(e,t,n,i[1]));case 3:return r(pi(e,t,n,i[0]),pi(e,t,n,i[1]),pi(e,t,n,i[2]));default:for(var a=Array(o),s=0;s<o;s++)a[s]=pi(e,t,n,i[s]);return r.apply(void 0,a)}}(e,t.parent,n,r.value,r.deps);case 2048:return pi(e,t.parent,n,r.deps[0]);case 256:return r.value}}function fi(e,t,n,r,i){var o=i.length;switch(o){case 0:return new r;case 1:return new r(pi(e,t,n,i[0]));case 2:return new r(pi(e,t,n,i[0]),pi(e,t,n,i[1]));case 3:return new r(pi(e,t,n,i[0]),pi(e,t,n,i[1]),pi(e,t,n,i[2]));default:for(var a=new Array(o),s=0;s<o;s++)a[s]=pi(e,t,n,i[s]);return _construct(r,a)}}var di={};function pi(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Pt.THROW_IF_NOT_FOUND;if(8&r.flags)return r.token;var o=e;2&r.flags&&(i=null);var a=r.tokenKey;a===ti&&(n=!(!t||!t.element.componentView)),t&&1&r.flags&&(n=!1,t=t.parent);for(var s=e;s;){if(t)switch(a){case Zr:return Wr(yi(s,t,n));case Jr:return yi(s,t,n).renderer;case Xr:return new cn(Bn(s,t.nodeIndex).renderElement);case $r:return Bn(s,t.nodeIndex).viewContainer;case ei:if(t.element.template)return Bn(s,t.nodeIndex).template;break;case ti:return Ur(yi(s,t,n));case ni:case ri:return zr(s,t);default:var u=(n?t.element.allProviders:t.element.publicProviders)[a];if(u){var c=jn(s,u.nodeIndex);return c||(c={instance:hi(s,u)},s.nodes[u.nodeIndex]=c),c.instance}}n=ur(s),t=ar(s),s=s.parent,4&r.flags&&(s=null)}var l=o.root.injector.get(r.token,di);return l!==di||i===di?l:o.root.ngModule.injector.get(r.token,i)}function yi(e,t,n){var r;if(n)r=Bn(e,t.nodeIndex).componentView;else for(r=e;r.parent&&!ur(r);)r=r.parent;return r}function vi(e,t,n,r,i,o){if(32768&n.flags){var a=Bn(e,n.parent.nodeIndex).componentView;2&a.def.flags&&(a.state|=8)}if(t.instance[n.bindings[r].name]=i,524288&n.flags){o=o||{};var s=Gt.unwrap(e.oldValues[n.bindingIndex+r]);o[n.bindings[r].nonMinifiedName]=new Xt(s,i,0!=(2&e.state))}return e.oldValues[n.bindingIndex+r]=i,o}function mi(e,t){if(e.def.nodeFlags&t)for(var n=e.def.nodes,r=0,i=0;i<n.length;i++){var o=n[i],a=o.parent;for(!a&&o.flags&t&&_i(e,i,o.flags&t,r++),0==(o.childFlags&t)&&(i+=o.childCount);a&&1&a.flags&&i===a.nodeIndex+a.childCount;)a.directChildFlags&t&&(r=gi(e,a,t,r)),a=a.parent}}function gi(e,t,n,r){for(var i=t.nodeIndex+1;i<=t.nodeIndex+t.childCount;i++){var o=e.def.nodes[i];o.flags&n&&_i(e,i,o.flags&n,r++),i+=o.childCount}return r}function _i(e,t,n,r){var i=jn(e,t);if(i){var o=i.instance;o&&(Hn.setCurrentNode(e,t),1048576&n&&Un(e,512,r)&&o.ngAfterContentInit(),2097152&n&&o.ngAfterContentChecked(),4194304&n&&Un(e,768,r)&&o.ngAfterViewInit(),8388608&n&&o.ngAfterViewChecked(),131072&n&&o.ngOnDestroy())}}var bi=new De("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return We}}),wi={},Ci=function(){var e={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencySymbol:15,CurrencyName:16,Currencies:17,PluralCase:18,ExtraData:19};return e[e.LocaleId]="LocaleId",e[e.DayPeriodsFormat]="DayPeriodsFormat",e[e.DayPeriodsStandalone]="DayPeriodsStandalone",e[e.DaysFormat]="DaysFormat",e[e.DaysStandalone]="DaysStandalone",e[e.MonthsFormat]="MonthsFormat",e[e.MonthsStandalone]="MonthsStandalone",e[e.Eras]="Eras",e[e.FirstDayOfWeek]="FirstDayOfWeek",e[e.WeekendRange]="WeekendRange",e[e.DateFormat]="DateFormat",e[e.TimeFormat]="TimeFormat",e[e.DateTimeFormat]="DateTimeFormat",e[e.NumberSymbols]="NumberSymbols",e[e.NumberFormats]="NumberFormats",e[e.CurrencySymbol]="CurrencySymbol",e[e.CurrencyName]="CurrencyName",e[e.Currencies]="Currencies",e[e.PluralCase]="PluralCase",e[e.ExtraData]="ExtraData",e}(),ki=void 0,Si=["en",[["a","p"],["AM","PM"],ki],[["AM","PM"],ki,ki],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ki,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ki,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ki,"{1} 'at' {0}",ki],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"$","US Dollar",{},function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],Ei="en-US";function Ti(e){null==e&&function(e){throw new Error("ASSERTION ERROR: ".concat("Expected localeId to be defined"))}(),"string"==typeof e&&e.toLowerCase().replace(/_/g,"-")}var Ii=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).__isAsync=n,e}return _inherits(t,N),_createClass(t,[{key:"emit",value:function(e){_get(_getPrototypeOf(t.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,n,r){var i,o=function(e){return null},a=function(){return null};e&&"object"==typeof e?(i=this.__isAsync?function(t){setTimeout(function(){return e.next(t)})}:function(t){e.next(t)},e.error&&(o=this.__isAsync?function(t){setTimeout(function(){return e.error(t)})}:function(t){e.error(t)}),e.complete&&(a=this.__isAsync?function(){setTimeout(function(){return e.complete()})}:function(){e.complete()})):(i=this.__isAsync?function(t){setTimeout(function(){return e(t)})}:function(t){e(t)},n&&(o=this.__isAsync?function(e){setTimeout(function(){return n(e)})}:function(e){n(e)}),r&&(a=this.__isAsync?function(){setTimeout(function(){return r()})}:function(){r()}));var s=_get(_getPrototypeOf(t.prototype),"subscribe",this).call(this,i,o,a);return e instanceof d&&e.add(s),s}}]),t}();function Ai(){return this._results[Qt()]()}var Di=function(){function e(){_classCallCheck(this,e),this.dirty=!0,this._results=[],this.changes=new Ii,this.length=0;var t=Qt(),n=e.prototype;n[t]||(n[t]=Ai)}return _createClass(e,[{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e){this._results=function e(t,n){void 0===n&&(n=t);for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?(n===t&&(n=t.slice(0,r)),e(i,n)):n!==t&&n.push(i)}return n}(e),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}},{key:"notifyOnChanges",value:function(){this.changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}(),Ni=new De("Application Initializer"),Ri=function(){function e(t){var n=this;_classCallCheck(this,e),this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return _createClass(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=0;r<this.appInits.length;r++){var i=this.appInits[r]();Zt(i)&&t.push(i)}Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}(),xi=new De("AppId");function Oi(){return"".concat(Pi()).concat(Pi()).concat(Pi())}function Pi(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var Mi=new De("Platform Initializer"),Li=new De("Platform ID"),Vi=new De("appBootstrapListener"),Fi=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}(),Ui=new De("LocaleId"),qi=!1;function Bi(){throw new Error("Runtime compiler is not loaded")}var ji,zi,Qi=Bi,Hi=Bi,Wi=Bi,Gi=Bi,Ki=function(){function e(){_classCallCheck(this,e),this.compileModuleSync=Qi,this.compileModuleAsync=Hi,this.compileModuleAndAllComponentsSync=Wi,this.compileModuleAndAllComponentsAsync=Gi}return _createClass(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}(),Yi=function e(){_classCallCheck(this,e)};var Zi,Ji=!(!(Zi=Ae.wtf)||!(ji=Zi.trace)||(zi=ji.events,0)),Xi=Ji?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return zi.createScope(e,t)}:function(e,t){return function(e,t){return null}},$i=Ji?function(e,t){return ji.leaveScope(e,t),t}:function(e,t){return t},eo=Promise.resolve(0);function to(e){"undefined"==typeof Zone?eo.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var no=function(){function e(t){var n,r=t.enableLongStackTrace,i=void 0!==r&&r;if(_classCallCheck(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ii(!1),this.onMicrotaskEmpty=new Ii(!1),this.onStable=new Ii(!1),this.onError=new Ii(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),(n=this)._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(e,t,r,i,o,a){try{return ao(n),e.invokeTask(r,i,o,a)}finally{so(n)}},onInvoke:function(e,t,r,i,o,a,s){try{return ao(n),e.invoke(r,i,o,a,s)}finally{so(n)}},onHasTask:function(e,t,r,i){e.hasTask(r,i),t===r&&("microTask"==i.change?(n.hasPendingMicrotasks=i.microTask,oo(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:function(e,t,r,i){return e.handleError(r,i),n.runOutsideAngular(function(){return n.onError.emit(i)}),!1}})}return _createClass(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,e,io,ro,ro);try{return i.runTask(o,t,n)}finally{i.cancelTask(o)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}();function ro(){}var io={};function oo(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function ao(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function so(e){e._nesting--,oo(e)}var uo,co=function(){function e(){_classCallCheck(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ii,this.onMicrotaskEmpty=new Ii,this.onStable=new Ii,this.onError=new Ii}return _createClass(e,[{key:"run",value:function(e){return e()}},{key:"runGuarded",value:function(e){return e()}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e){return e()}}]),e}(),lo=function(){function e(t){var n=this;_classCallCheck(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return _createClass(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){no.assertNotInAngularZone(),to(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())to(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout(function(){r._callbacks=r._callbacks.filter(function(e){return e.timeoutId!==i}),e(r._didWork,r.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}(),ho=function(){function e(){_classCallCheck(this,e),this._applications=new Map,fo.addToWindow(this)}return _createClass(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return fo.findTestabilityInTree(this,e,t)}}]),e}(),fo=new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),po=function(e,t,n){return e.get(Yi).createCompiler([t]).compileModuleAsync(n)},yo=new De("AllowMultipleToken"),vo=function e(t,n){_classCallCheck(this,e),this.name=t,this.token=n};function mo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new De(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=go();if(!o||o.injector.get(yo,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var a=n.concat(t).concat({provide:i,useValue:!0});!function(e){if(uo&&!uo.destroyed&&!uo.injector.get(yo,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");uo=e.get(_o);var t=e.get(Mi,null);t&&t.forEach(function(e){return e()})}(Pt.create({providers:a,name:r}))}return function(e){var t=go();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function go(){return uo&&!uo.destroyed?uo:null}var _o=function(){function e(t){_classCallCheck(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return _createClass(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n,r=this,i="noop"===(n=t?t.ngZone:void 0)?new co:("zone.js"===n?void 0:n)||new no({enableLongStackTrace:nt()}),o=[{provide:no,useValue:i}];return i.run(function(){var t=Pt.create({providers:o,parent:r.injector,name:e.moduleType.name}),n=e.create(t),a=n.injector.get($e,null);if(!a)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return qi&&Ti(n.injector.get(Ui,Ei)||Ei),n.onDestroy(function(){return ko(r._modules,n)}),i.runOutsideAngular(function(){return i.onError.subscribe({next:function(e){a.handleError(e)}})}),function(e,t,i){try{var o=((a=n.injector.get(Ri)).runInitializers(),a.donePromise.then(function(){return r._moduleDoBootstrap(n),n}));return Zt(o)?o.catch(function(n){throw t.runOutsideAngular(function(){return e.handleError(n)}),n}):o}catch(s){throw t.runOutsideAngular(function(){return e.handleError(s)}),s}var a}(a,i)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=bo({},n);return po(this.injector,r,e).then(function(e){return t.bootstrapModuleFactory(e,r)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(Co);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(_e(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. ')+"Please define one of these.");e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"injector",get:function(){return this._injector}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();function bo(e,t){return Array.isArray(t)?t.reduce(bo,e):Object.assign({},e,t)}var wo,Co=((wo=function(){function e(t,n,r,i,o,a){var s=this;_classCallCheck(this,e),this._zone=t,this._console=n,this._injector=r,this._exceptionHandler=i,this._componentFactoryResolver=o,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=nt(),this._zone.onMicrotaskEmpty.subscribe({next:function(){s._zone.run(function(){s.tick()})}});var u=new k(function(e){s._stable=s._zone.isStable&&!s._zone.hasPendingMacrotasks&&!s._zone.hasPendingMicrotasks,s._zone.runOutsideAngular(function(){e.next(s._stable),e.complete()})}),c=new k(function(e){var t;s._zone.runOutsideAngular(function(){t=s._zone.onStable.subscribe(function(){no.assertNotInAngularZone(),to(function(){s._stable||s._zone.hasPendingMacrotasks||s._zone.hasPendingMicrotasks||(s._stable=!0,e.next(!0))})})});var n=s._zone.onUnstable.subscribe(function(){no.assertInAngularZone(),s._stable&&(s._stable=!1,s._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Number.POSITIVE_INFINITY,i=null,o=t[t.length-1];return x(o)?(i=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(r=t.pop())):"number"==typeof o&&(r=t.pop()),null===i&&1===t.length&&t[0]instanceof k?t[0]:$(r)(G(t,i))}(u,c.pipe(se()))}return _createClass(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof en?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=n instanceof sn?null:this._injector.get(Be),o=n.create(Pt.NULL,[],t||n.selector,i);o.onDestroy(function(){r._unloadComponent(o)});var a=o.injector.get(lo,null);return a&&o.injector.get(ho).registerApplication(o.location.nativeElement,a),this._loadComponent(o),nt()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),o}},{key:"tick",value:function(){var t=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");var n=e._tickScope();try{this._runningTick=!0;var r=!0,i=!1,o=void 0;try{for(var a,s=this._views[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)a.value.detectChanges()}catch(d){i=!0,o=d}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}if(this._enforceNoNewChanges){var u=!0,c=!1,l=void 0;try{for(var h,f=this._views[Symbol.iterator]();!(u=(h=f.next()).done);u=!0)h.value.checkNoChanges()}catch(d){c=!0,l=d}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}}}catch(p){this._zone.runOutsideAngular(function(){return t._exceptionHandler.handleError(p)})}finally{this._runningTick=!1,$i(n)}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;ko(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(Vi,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"_unloadComponent",value:function(e){this.detachView(e.hostView),ko(this.components,e)}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()})}},{key:"viewCount",get:function(){return this._views.length}}]),e}())._tickScope=Xi("ApplicationRef#tick()"),wo);function ko(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var So=function e(){_classCallCheck(this,e)},Eo=function e(){_classCallCheck(this,e)},To={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},Io=function(){function e(t,n){_classCallCheck(this,e),this._compiler=t,this._config=n||To}return _createClass(e,[{key:"load",value:function(e){return!qi&&this._compiler instanceof Ki?this.loadFactory(e):this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,r=_slicedToArray(e.split("#"),2),i=r[0],o=r[1];return void 0===o&&(o="default"),n("zn8P")(i).then(function(e){return e[o]}).then(function(e){return Ao(e,i,o)}).then(function(e){return t._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var t=_slicedToArray(e.split("#"),2),r=t[0],i=t[1],o="NgFactory";return void 0===i&&(i="default",o=""),n("zn8P")(this._config.factoryPathPrefix+r+this._config.factoryPathSuffix).then(function(e){return e[i+o]}).then(function(e){return Ao(e,r,i)})}}]),e}();function Ao(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var Do=function e(t,n){_classCallCheck(this,e),this.name=t,this.callback=n},No=function(){function e(t,n,r){_classCallCheck(this,e),this.listeners=[],this.parent=null,this._debugContext=r,this.nativeNode=t,n&&n instanceof Ro&&n.addChild(this)}return _createClass(e,[{key:"injector",get:function(){return this._debugContext.injector}},{key:"componentInstance",get:function(){return this._debugContext.component}},{key:"context",get:function(){return this._debugContext.context}},{key:"references",get:function(){return this._debugContext.references}},{key:"providerTokens",get:function(){return this._debugContext.providerTokens}}]),e}(),Ro=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n,r))).properties={},i.attributes={},i.classes={},i.styles={},i.childNodes=[],i.nativeElement=e,i}return _inherits(t,No),_createClass(t,[{key:"addChild",value:function(e){e&&(this.childNodes.push(e),e.parent=this)}},{key:"removeChild",value:function(e){var t=this.childNodes.indexOf(e);-1!==t&&(e.parent=null,this.childNodes.splice(t,1))}},{key:"insertChildrenAfter",value:function(e,t){var n,r=this,i=this.childNodes.indexOf(e);-1!==i&&((n=this.childNodes).splice.apply(n,[i+1,0].concat(_toConsumableArray(t))),t.forEach(function(t){t.parent&&t.parent.removeChild(t),e.parent=r}))}},{key:"insertBefore",value:function(e,t){var n=this.childNodes.indexOf(e);-1===n?this.addChild(t):(t.parent&&t.parent.removeChild(t),t.parent=this,this.childNodes.splice(n,0,t))}},{key:"query",value:function(e){return this.queryAll(e)[0]||null}},{key:"queryAll",value:function(e){var n=[];return function e(n,r,i){n.childNodes.forEach(function(n){n instanceof t&&(r(n)&&i.push(n),e(n,r,i))})}(this,e,n),n}},{key:"queryAllNodes",value:function(e){var n=[];return function e(n,r,i){n instanceof t&&n.childNodes.forEach(function(n){r(n)&&i.push(n),n instanceof t&&e(n,r,i)})}(this,e,n),n}},{key:"triggerEventHandler",value:function(e,t){this.listeners.forEach(function(n){n.name==e&&n.callback(t)})}},{key:"children",get:function(){return this.childNodes.filter(function(e){return e instanceof t})}}]),t}(),xo=new Map,Oo=function(e){return xo.get(e)||null};function Po(e){xo.set(e.nativeNode,e)}var Mo=mo(null,"core",[{provide:Li,useValue:"unknown"},{provide:_o,deps:[Pt]},{provide:ho,deps:[]},{provide:Fi,deps:[]}]);function Lo(){return Dn}function Vo(){return Nn}function Fo(e){return e?(qi&&Ti(e),e):Ei}function Uo(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}var qo=function e(t){_classCallCheck(this,e)};function Bo(e,t,n,r,i,o){e|=1;var a=lr(t),s=a.matchedQueries,u=a.references;return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,flags:e,checkIndex:-1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:s,matchedQueryIds:a.matchedQueryIds,references:u,ngContentIndex:n,childCount:r,bindings:[],bindingFlags:0,outputs:[],element:{ns:null,name:null,attrs:null,template:o?pr(o):null,componentProvider:null,componentView:null,componentRendererType:null,publicProviders:null,allProviders:null,handleEvent:i||Wn},provider:null,text:null,query:null,ngContent:null}}function jo(e,t,n,r,i,o){var a,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],u=arguments.length>7?arguments[7]:void 0,c=arguments.length>8?arguments[8]:void 0,l=arguments.length>9?arguments[9]:void 0,h=arguments.length>10?arguments[10]:void 0,f=arguments.length>11?arguments[11]:void 0;l||(l=Wn);var d=lr(n),p=d.matchedQueries,y=d.references,v=d.matchedQueryIds,m=null,g=null;o&&(m=(a=_slicedToArray(wr(o),2))[0],g=a[1]),u=u||[];for(var _=new Array(u.length),b=0;b<u.length;b++){var w=_slicedToArray(u[b],3),C=w[0],k=w[1],S=w[2],E=_slicedToArray(wr(k),2),T=E[0],I=E[1],A=void 0,D=void 0;switch(15&C){case 4:D=S;break;case 1:case 8:A=S}_[b]={flags:C,ns:T,name:I,nonMinifiedName:I,securityContext:A,suffix:D}}c=c||[];for(var N=new Array(c.length),R=0;R<c.length;R++){var x=_slicedToArray(c[R],2),O=x[0],P=x[1];N[R]={type:0,target:O,eventName:P,propName:null}}var M=(s=s||[]).map(function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1],i=_slicedToArray(wr(n),2);return[i[0],i[1],r]});return f=function(e){if(e&&e.id===Yn){var t=null!=e.encapsulation&&e.encapsulation!==He.None||e.styles.length||Object.keys(e.data).length;e.id=t?"c".concat(Xn++):Zn}return e&&e.id===Zn&&(e=null),e||null}(f),h&&(t|=33554432),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:t|=1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:p,matchedQueryIds:v,references:y,ngContentIndex:r,childCount:i,bindings:_,bindingFlags:Cr(_),outputs:N,element:{ns:m,name:g,attrs:M,template:null,componentProvider:null,componentView:h||null,componentRendererType:f,publicProviders:null,allProviders:null,handleEvent:l||Wn},provider:null,text:null,query:null,ngContent:null}}function zo(e,t,n){var r,i=n.element,o=e.root.selectorOrNode,a=e.renderer;if(e.parent||!o){r=i.name?a.createElement(i.name,i.ns):a.createComment("");var s=fr(e,t,n);s&&a.appendChild(s,r)}else r=a.selectRootElement(o,!!i.componentRendererType&&i.componentRendererType.encapsulation===He.ShadowDom);if(i.attrs)for(var u=0;u<i.attrs.length;u++){var c=_slicedToArray(i.attrs[u],3),l=c[0],h=c[1],f=c[2];a.setAttribute(r,h,f,l)}return r}function Qo(e,t,n,r){for(var i=0;i<n.outputs.length;i++){var o=n.outputs[i],a=Ho(e,n.nodeIndex,(h=o.eventName,(l=o.target)?"".concat(l,":").concat(h):h)),s=o.target,u=e;"component"===o.target&&(s=null,u=t);var c=u.renderer.listen(s||r,o.eventName,a);e.disposables[n.outputIndex+i]=c}var l,h}function Ho(e,t,n){return function(r){return ir(e,t,n,r)}}function Wo(e,t,n,r){if(!er(e,t,n,r))return!1;var i=t.bindings[n],o=Bn(e,t.nodeIndex),a=o.renderElement,s=i.name;switch(15&i.flags){case 1:!function(e,t,n,r,i,o){var a=t.securityContext,s=a?e.root.sanitizer.sanitize(a,o):o;s=null!=s?s.toString():null;var u=e.renderer;null!=o?u.setAttribute(n,i,s,r):u.removeAttribute(n,i,r)}(e,i,a,i.ns,s,r);break;case 2:!function(e,t,n,r){var i=e.renderer;r?i.addClass(t,n):i.removeClass(t,n)}(e,a,s,r);break;case 4:!function(e,t,n,r,i){var o=e.root.sanitizer.sanitize(St.STYLE,i);if(null!=o){o=o.toString();var a=t.suffix;null!=a&&(o+=a)}else o=null;var s=e.renderer;null!=o?s.setStyle(n,r,o):s.removeStyle(n,r)}(e,i,a,s,r);break;case 8:!function(e,t,n,r,i){var o=t.securityContext,a=o?e.root.sanitizer.sanitize(o,i):i;e.renderer.setProperty(n,r,a)}(33554432&t.flags&&32&i.flags?o.componentView:e,i,a,s,r)}return!0}function Go(e){for(var t=e.def.nodeMatchedQueries;e.parent&&cr(e);){var n=e.parentNodeDef;e=e.parent;for(var r=n.nodeIndex+n.childCount,i=0;i<=r;i++){var o=e.def.nodes[i];67108864&o.flags&&536870912&o.flags&&(o.query.filterId&t)===o.query.filterId&&Qn(e,i).setDirty(),!(1&o.flags&&i+o.childCount<n.nodeIndex)&&67108864&o.childFlags&&536870912&o.childFlags||(i+=o.childCount)}}if(134217728&e.def.nodeFlags)for(var a=0;a<e.def.nodes.length;a++){var s=e.def.nodes[a];134217728&s.flags&&536870912&s.flags&&Qn(e,a).setDirty(),a+=s.childCount}}function Ko(e,t){var n=Qn(e,t.nodeIndex);if(n.dirty){var r,i=void 0;if(67108864&t.flags){var o=t.parent.parent;i=Yo(e,o.nodeIndex,o.nodeIndex+o.childCount,t.query,[]),r=jn(e,t.parent.nodeIndex).instance}else 134217728&t.flags&&(i=Yo(e,0,e.def.nodes.length-1,t.query,[]),r=e.component);n.reset(i);for(var a=t.query.bindings,s=!1,u=0;u<a.length;u++){var c=a[u],l=void 0;switch(c.bindingType){case 0:l=n.first;break;case 1:l=n,s=!0}r[c.propName]=l}s&&n.notifyOnChanges()}}function Yo(e,t,n,r,i){for(var o=t;o<=n;o++){var a=e.def.nodes[o],s=a.matchedQueries[r.id];if(null!=s&&i.push(Zo(e,a,s)),1&a.flags&&a.element.template&&(a.element.template.nodeMatchedQueries&r.filterId)===r.filterId){var u=Bn(e,o);if((a.childMatchedQueries&r.filterId)===r.filterId&&(Yo(e,o+1,o+a.childCount,r,i),o+=a.childCount),16777216&a.flags)for(var c=u.viewContainer._embeddedViews,l=0;l<c.length;l++){var h=c[l],f=or(h);f&&f===u&&Yo(h,0,h.def.nodes.length-1,r,i)}var d=u.template._projectedViews;if(d)for(var p=0;p<d.length;p++){var y=d[p];Yo(y,0,y.def.nodes.length-1,r,i)}}(a.childMatchedQueries&r.filterId)!==r.filterId&&(o+=a.childCount)}return i}function Zo(e,t,n){if(null!=n)switch(n){case 1:return Bn(e,t.nodeIndex).renderElement;case 0:return new cn(Bn(e,t.nodeIndex).renderElement);case 2:return Bn(e,t.nodeIndex).template;case 3:return Bn(e,t.nodeIndex).viewContainer;case 4:return jn(e,t.nodeIndex).instance}}function Jo(e,t,n){var r=fr(e,t,n);r&&mr(e,n.ngContent.index,1,r,null,void 0)}function Xo(e,t){for(var n=Object.keys(t),r=n.length,i=new Array(r),o=0;o<r;o++){var a=n[o];i[t[a]]=a}return function(e,t,n){for(var r=new Array(n.length),i=0;i<n.length;i++){var o=n[i];r[i]={flags:8,name:o,ns:null,nonMinifiedName:o,securityContext:null,suffix:null}}return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:64,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:-1,childCount:0,bindings:r,bindingFlags:Cr(r),outputs:[],element:null,provider:null,text:null,query:null,ngContent:null}}(0,e,i)}function $o(e,t,n){for(var r=new Array(n.length-1),i=1;i<n.length;i++)r[i-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:n[i]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:t,childCount:0,bindings:r,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:n[0]},query:null,ngContent:null}}function ea(e,t,n){var r,i=e.renderer;r=i.createText(n.text.prefix);var o=fr(e,t,n);return o&&i.appendChild(o,r),{renderText:r}}function ta(e,t){return(null!=e?e.toString():"")+t.suffix}function na(e,t,n,r){for(var i=0,o=0,a=0,s=0,u=0,c=null,l=null,h=!1,f=!1,d=null,p=0;p<t.length;p++){var y=t[p];if(y.nodeIndex=p,y.parent=c,y.bindingIndex=i,y.outputIndex=o,y.renderParent=l,a|=y.flags,u|=y.matchedQueryIds,y.element){var v=y.element;v.publicProviders=c?c.element.publicProviders:Object.create(null),v.allProviders=v.publicProviders,h=!1,f=!1,y.element.template&&(u|=y.element.template.nodeMatchedQueries)}if(ia(c,y,t.length),i+=y.bindings.length,o+=y.outputs.length,!l&&3&y.flags&&(d=y),20224&y.flags){h||(h=!0,c.element.publicProviders=Object.create(c.element.publicProviders),c.element.allProviders=c.element.publicProviders);var m=0!=(32768&y.flags);0==(8192&y.flags)||m?c.element.publicProviders[Kn(y.provider.token)]=y:(f||(f=!0,c.element.allProviders=Object.create(c.element.publicProviders)),c.element.allProviders[Kn(y.provider.token)]=y),m&&(c.element.componentProvider=y)}if(c?(c.childFlags|=y.flags,c.directChildFlags|=y.flags,c.childMatchedQueries|=y.matchedQueryIds,y.element&&y.element.template&&(c.childMatchedQueries|=y.element.template.nodeMatchedQueries)):s|=y.flags,y.childCount>0)c=y,ra(y)||(l=y);else for(;c&&p===c.nodeIndex+c.childCount;){var g=c.parent;g&&(g.childFlags|=c.childFlags,g.childMatchedQueries|=c.childMatchedQueries),l=(c=g)&&ra(c)?c.renderParent:c}}return{factory:null,nodeFlags:a,rootNodeFlags:s,nodeMatchedQueries:u,flags:e,nodes:t,updateDirectives:n||Wn,updateRenderer:r||Wn,handleEvent:function(e,n,r,i){return t[n].element.handleEvent(e,r,i)},bindingCount:i,outputCount:o,lastRenderRootNode:d}}function ra(e){return 0!=(1&e.flags)&&null===e.element.name}function ia(e,t,n){var r=t.element&&t.element.template;if(r){if(!r.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(r.lastRenderRootNode&&16777216&r.lastRenderRootNode.flags)throw new Error("Illegal State: Last root node of a template can't have embedded views, at index ".concat(t.nodeIndex,"!"))}if(20224&t.flags&&0==(1&(e?e.flags:0)))throw new Error("Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index ".concat(t.nodeIndex,"!"));if(t.query){if(67108864&t.flags&&(!e||0==(16384&e.flags)))throw new Error("Illegal State: Content Query nodes need to be children of directives, at index ".concat(t.nodeIndex,"!"));if(134217728&t.flags&&e)throw new Error("Illegal State: View Query nodes have to be top level nodes, at index ".concat(t.nodeIndex,"!"))}if(t.childCount){var i=e?e.nodeIndex+e.childCount:n-1;if(t.nodeIndex<=i&&t.nodeIndex+t.childCount>i)throw new Error("Illegal State: childCount of node leads outside of parent, at index ".concat(t.nodeIndex,"!"))}}function oa(e,t,n,r){var i=ua(e.root,e.renderer,e,t,n);return ca(i,e.component,r),la(i),i}function aa(e,t,n){var r=ua(e,e.renderer,null,null,t);return ca(r,n,n),la(r),r}function sa(e,t,n,r){var i,o=t.element.componentRendererType;return i=o?e.root.rendererFactory.createRenderer(r,o):e.root.renderer,ua(e.root,i,e,t.element.componentProvider,n)}function ua(e,t,n,r,i){var o=new Array(i.nodes.length),a=i.outputCount?new Array(i.outputCount):null;return{def:i,parent:n,viewContainerParent:null,parentNodeDef:r,context:null,component:null,nodes:o,state:13,root:e,renderer:t,oldValues:new Array(i.bindingCount),disposables:a,initIndex:-1}}function ca(e,t,n){e.component=t,e.context=n}function la(e){var t;ur(e)&&(t=Bn(e.parent,e.parentNodeDef.parent.nodeIndex).renderElement);for(var n=e.def,r=e.nodes,i=0;i<n.nodes.length;i++){var o=n.nodes[i],a=void 0;switch(Hn.setCurrentNode(e,i),201347067&o.flags){case 1:var s=zo(e,t,o),u=void 0;if(33554432&o.flags){var c=pr(o.element.componentView);u=Hn.createComponentView(e,o,c,s)}Qo(e,u,o,s),a={renderElement:s,componentView:u,viewContainer:null,template:o.element.template?Br(e,o):void 0},16777216&o.flags&&(a.viewContainer=Vr(e,o,a));break;case 2:a=ea(e,t,o);break;case 512:case 1024:case 2048:case 256:(a=r[i])||4096&o.flags||(a={instance:si(e,o)});break;case 16:a={instance:ui(e,o)};break;case 16384:(a=r[i])||(a={instance:ci(e,o)}),32768&o.flags&&ca(Bn(e,o.parent.nodeIndex).componentView,a.instance,a.instance);break;case 32:case 64:case 128:a={value:void 0};break;case 67108864:case 134217728:a=new Di;break;case 8:Jo(e,t,o),a=void 0}r[i]=a}_a(e,ga.CreateViewNodes),ka(e,201326592,268435456,0)}function ha(e){pa(e),Hn.updateDirectives(e,1),ba(e,ga.CheckNoChanges),Hn.updateRenderer(e,1),_a(e,ga.CheckNoChanges),e.state&=-97}function fa(e){1&e.state?(e.state&=-2,e.state|=2):e.state&=-3,Fn(e,0,256),pa(e),Hn.updateDirectives(e,0),ba(e,ga.CheckAndUpdate),ka(e,67108864,536870912,0);var t=Fn(e,256,512);mi(e,2097152|(t?1048576:0)),Hn.updateRenderer(e,0),_a(e,ga.CheckAndUpdate),ka(e,134217728,536870912,0),mi(e,8388608|((t=Fn(e,512,768))?4194304:0)),2&e.def.flags&&(e.state&=-9),e.state&=-97,Fn(e,768,1024)}function da(e,t,n,r,i,o,a,s,u,c,l,h,f){return 0===n?function(e,t,n,r,i,o,a,s,u,c,l,h){switch(201347067&t.flags){case 1:return function(e,t,n,r,i,o,a,s,u,c,l,h){var f=t.bindings.length,d=!1;return f>0&&Wo(e,t,0,n)&&(d=!0),f>1&&Wo(e,t,1,r)&&(d=!0),f>2&&Wo(e,t,2,i)&&(d=!0),f>3&&Wo(e,t,3,o)&&(d=!0),f>4&&Wo(e,t,4,a)&&(d=!0),f>5&&Wo(e,t,5,s)&&(d=!0),f>6&&Wo(e,t,6,u)&&(d=!0),f>7&&Wo(e,t,7,c)&&(d=!0),f>8&&Wo(e,t,8,l)&&(d=!0),f>9&&Wo(e,t,9,h)&&(d=!0),d}(e,t,n,r,i,o,a,s,u,c,l,h);case 2:return function(e,t,n,r,i,o,a,s,u,c,l,h){var f=!1,d=t.bindings,p=d.length;if(p>0&&er(e,t,0,n)&&(f=!0),p>1&&er(e,t,1,r)&&(f=!0),p>2&&er(e,t,2,i)&&(f=!0),p>3&&er(e,t,3,o)&&(f=!0),p>4&&er(e,t,4,a)&&(f=!0),p>5&&er(e,t,5,s)&&(f=!0),p>6&&er(e,t,6,u)&&(f=!0),p>7&&er(e,t,7,c)&&(f=!0),p>8&&er(e,t,8,l)&&(f=!0),p>9&&er(e,t,9,h)&&(f=!0),f){var y=t.text.prefix;p>0&&(y+=ta(n,d[0])),p>1&&(y+=ta(r,d[1])),p>2&&(y+=ta(i,d[2])),p>3&&(y+=ta(o,d[3])),p>4&&(y+=ta(a,d[4])),p>5&&(y+=ta(s,d[5])),p>6&&(y+=ta(u,d[6])),p>7&&(y+=ta(c,d[7])),p>8&&(y+=ta(l,d[8])),p>9&&(y+=ta(h,d[9]));var v=qn(e,t.nodeIndex).renderText;e.renderer.setValue(v,y)}return f}(e,t,n,r,i,o,a,s,u,c,l,h);case 16384:return function(e,t,n,r,i,o,a,s,u,c,l,h){var f=jn(e,t.nodeIndex),d=f.instance,p=!1,y=void 0,v=t.bindings.length;return v>0&&$n(e,t,0,n)&&(p=!0,y=vi(e,f,t,0,n,y)),v>1&&$n(e,t,1,r)&&(p=!0,y=vi(e,f,t,1,r,y)),v>2&&$n(e,t,2,i)&&(p=!0,y=vi(e,f,t,2,i,y)),v>3&&$n(e,t,3,o)&&(p=!0,y=vi(e,f,t,3,o,y)),v>4&&$n(e,t,4,a)&&(p=!0,y=vi(e,f,t,4,a,y)),v>5&&$n(e,t,5,s)&&(p=!0,y=vi(e,f,t,5,s,y)),v>6&&$n(e,t,6,u)&&(p=!0,y=vi(e,f,t,6,u,y)),v>7&&$n(e,t,7,c)&&(p=!0,y=vi(e,f,t,7,c,y)),v>8&&$n(e,t,8,l)&&(p=!0,y=vi(e,f,t,8,l,y)),v>9&&$n(e,t,9,h)&&(p=!0,y=vi(e,f,t,9,h,y)),y&&d.ngOnChanges(y),65536&t.flags&&Un(e,256,t.nodeIndex)&&d.ngOnInit(),262144&t.flags&&d.ngDoCheck(),p}(e,t,n,r,i,o,a,s,u,c,l,h);case 32:case 64:case 128:return function(e,t,n,r,i,o,a,s,u,c,l,h){var f=t.bindings,d=!1,p=f.length;if(p>0&&er(e,t,0,n)&&(d=!0),p>1&&er(e,t,1,r)&&(d=!0),p>2&&er(e,t,2,i)&&(d=!0),p>3&&er(e,t,3,o)&&(d=!0),p>4&&er(e,t,4,a)&&(d=!0),p>5&&er(e,t,5,s)&&(d=!0),p>6&&er(e,t,6,u)&&(d=!0),p>7&&er(e,t,7,c)&&(d=!0),p>8&&er(e,t,8,l)&&(d=!0),p>9&&er(e,t,9,h)&&(d=!0),d){var y,v=zn(e,t.nodeIndex);switch(201347067&t.flags){case 32:y=new Array(f.length),p>0&&(y[0]=n),p>1&&(y[1]=r),p>2&&(y[2]=i),p>3&&(y[3]=o),p>4&&(y[4]=a),p>5&&(y[5]=s),p>6&&(y[6]=u),p>7&&(y[7]=c),p>8&&(y[8]=l),p>9&&(y[9]=h);break;case 64:y={},p>0&&(y[f[0].name]=n),p>1&&(y[f[1].name]=r),p>2&&(y[f[2].name]=i),p>3&&(y[f[3].name]=o),p>4&&(y[f[4].name]=a),p>5&&(y[f[5].name]=s),p>6&&(y[f[6].name]=u),p>7&&(y[f[7].name]=c),p>8&&(y[f[8].name]=l),p>9&&(y[f[9].name]=h);break;case 128:var m=n;switch(p){case 1:y=m.transform(n);break;case 2:y=m.transform(r);break;case 3:y=m.transform(r,i);break;case 4:y=m.transform(r,i,o);break;case 5:y=m.transform(r,i,o,a);break;case 6:y=m.transform(r,i,o,a,s);break;case 7:y=m.transform(r,i,o,a,s,u);break;case 8:y=m.transform(r,i,o,a,s,u,c);break;case 9:y=m.transform(r,i,o,a,s,u,c,l);break;case 10:y=m.transform(r,i,o,a,s,u,c,l,h)}}v.value=y}return d}(e,t,n,r,i,o,a,s,u,c,l,h);default:throw"unreachable"}}(e,t,r,i,o,a,s,u,c,l,h,f):function(e,t,n){switch(201347067&t.flags){case 1:return function(e,t,n){for(var r=!1,i=0;i<n.length;i++)Wo(e,t,i,n[i])&&(r=!0);return r}(e,t,n);case 2:return function(e,t,n){for(var r=t.bindings,i=!1,o=0;o<n.length;o++)er(e,t,o,n[o])&&(i=!0);if(i){for(var a="",s=0;s<n.length;s++)a+=ta(n[s],r[s]);a=t.text.prefix+a;var u=qn(e,t.nodeIndex).renderText;e.renderer.setValue(u,a)}return i}(e,t,n);case 16384:return function(e,t,n){for(var r=jn(e,t.nodeIndex),i=r.instance,o=!1,a=void 0,s=0;s<n.length;s++)$n(e,t,s,n[s])&&(o=!0,a=vi(e,r,t,s,n[s],a));return a&&i.ngOnChanges(a),65536&t.flags&&Un(e,256,t.nodeIndex)&&i.ngOnInit(),262144&t.flags&&i.ngDoCheck(),o}(e,t,n);case 32:case 64:case 128:return function(e,t,n){for(var r=t.bindings,i=!1,o=0;o<n.length;o++)er(e,t,o,n[o])&&(i=!0);if(i){var a,s=zn(e,t.nodeIndex);switch(201347067&t.flags){case 32:a=n;break;case 64:a={};for(var u=0;u<n.length;u++)a[r[u].name]=n[u];break;case 128:var c=n[0],l=n.slice(1);a=c.transform.apply(c,_toConsumableArray(l))}s.value=a}return i}(e,t,n);default:throw"unreachable"}}(e,t,r)}function pa(e){var t=e.def;if(4&t.nodeFlags)for(var n=0;n<t.nodes.length;n++){var r=t.nodes[n];if(4&r.flags){var i=Bn(e,n).template._projectedViews;if(i)for(var o=0;o<i.length;o++){var a=i[o];a.state|=32,rr(a,e)}}else 0==(4&r.childFlags)&&(n+=r.childCount)}}function ya(e,t,n,r,i,o,a,s,u,c,l,h,f){return 0===n?function(e,t,n,r,i,o,a,s,u,c,l,h){var f=t.bindings.length;f>0&&tr(e,t,0,n),f>1&&tr(e,t,1,r),f>2&&tr(e,t,2,i),f>3&&tr(e,t,3,o),f>4&&tr(e,t,4,a),f>5&&tr(e,t,5,s),f>6&&tr(e,t,6,u),f>7&&tr(e,t,7,c),f>8&&tr(e,t,8,l),f>9&&tr(e,t,9,h)}(e,t,r,i,o,a,s,u,c,l,h,f):function(e,t,n){for(var r=0;r<n.length;r++)tr(e,t,r,n[r])}(e,t,r),!1}function va(e,t){if(Qn(e,t.nodeIndex).dirty)throw Mn(Hn.createDebugContext(e,t.nodeIndex),"Query ".concat(t.query.id," not dirty"),"Query ".concat(t.query.id," dirty"),0!=(1&e.state))}function ma(e){if(!(128&e.state)){if(ba(e,ga.Destroy),_a(e,ga.Destroy),mi(e,131072),e.disposables)for(var t=0;t<e.disposables.length;t++)e.disposables[t]();!function(e){if(16&e.state){var t=or(e);if(t){var n=t.template._projectedViews;n&&(Qe(n,n.indexOf(e)),Hn.dirtyParentQueries(e))}}}(e),e.renderer.destroyNode&&function(e){for(var t=e.def.nodes.length,n=0;n<t;n++){var r=e.def.nodes[n];1&r.flags?e.renderer.destroyNode(Bn(e,n).renderElement):2&r.flags?e.renderer.destroyNode(qn(e,n).renderText):(67108864&r.flags||134217728&r.flags)&&Qn(e,n).destroy()}}(e),ur(e)&&e.renderer.destroy(),e.state|=128}}var ga=function(){var e={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return e[e.CreateViewNodes]="CreateViewNodes",e[e.CheckNoChanges]="CheckNoChanges",e[e.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",e[e.CheckAndUpdate]="CheckAndUpdate",e[e.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",e[e.Destroy]="Destroy",e}();function _a(e,t){var n=e.def;if(33554432&n.nodeFlags)for(var r=0;r<n.nodes.length;r++){var i=n.nodes[r];33554432&i.flags?wa(Bn(e,r).componentView,t):0==(33554432&i.childFlags)&&(r+=i.childCount)}}function ba(e,t){var n=e.def;if(16777216&n.nodeFlags)for(var r=0;r<n.nodes.length;r++){var i=n.nodes[r];if(16777216&i.flags)for(var o=Bn(e,r).viewContainer._embeddedViews,a=0;a<o.length;a++)wa(o[a],t);else 0==(16777216&i.childFlags)&&(r+=i.childCount)}}function wa(e,t){var n=e.state;switch(t){case ga.CheckNoChanges:0==(128&n)&&(12==(12&n)?ha(e):64&n&&Ca(e,ga.CheckNoChangesProjectedViews));break;case ga.CheckNoChangesProjectedViews:0==(128&n)&&(32&n?ha(e):64&n&&Ca(e,t));break;case ga.CheckAndUpdate:0==(128&n)&&(12==(12&n)?fa(e):64&n&&Ca(e,ga.CheckAndUpdateProjectedViews));break;case ga.CheckAndUpdateProjectedViews:0==(128&n)&&(32&n?fa(e):64&n&&Ca(e,t));break;case ga.Destroy:ma(e);break;case ga.CreateViewNodes:la(e)}}function Ca(e,t){ba(e,t),_a(e,t)}function ka(e,t,n,r){if(e.def.nodeFlags&t&&e.def.nodeFlags&n)for(var i=e.def.nodes.length,o=0;o<i;o++){var a=e.def.nodes[o];if(a.flags&t&&a.flags&n)switch(Hn.setCurrentNode(e,a.nodeIndex),r){case 0:Ko(e,a);break;case 1:va(e,a)}a.childFlags&t&&a.childFlags&n||(o+=a.childCount)}}var Sa=!1;function Ea(e,t,n,r,i,o){var a=i.injector.get(hn);return aa(Ia(e,i,a,t,n),r,o)}function Ta(e,t,n,r,i,o){var a=i.injector.get(hn),s=Ia(e,i,new os(a),t,n),u=Va(r);return rs(Wa.create,aa,null,[s,u,o])}function Ia(e,t,n,r,i){var o=t.injector.get(Et),a=t.injector.get($e),s=n.createRenderer(null,null);return{ngModule:t,injector:e,projectableNodes:r,selectorOrNode:i,sanitizer:o,rendererFactory:n,renderer:s,errorHandler:a}}function Aa(e,t,n,r){var i=Va(n);return rs(Wa.create,oa,null,[e,t,i,r])}function Da(e,t,n,r){return n=Oa.get(t.element.componentProvider.provider.token)||Va(n),rs(Wa.create,sa,null,[e,t,n,r])}function Na(e,t,n,r){return Kr(e,t,n,function(e){var t=function(e){var t=!1,n=!1;return 0===Ra.size?{hasOverrides:t,hasDeprecatedOverrides:n}:(e.providers.forEach(function(e){var r=Ra.get(e.token);3840&e.flags&&r&&(t=!0,n=n||r.deprecatedBehavior)}),e.modules.forEach(function(e){xa.forEach(function(r,i){me(i).providedIn===e&&(t=!0,n=n||r.deprecatedBehavior)})}),{hasOverrides:t,hasDeprecatedOverrides:n})}(e),n=t.hasOverrides,r=t.hasDeprecatedOverrides;return n?(function(e){for(var t=0;t<e.providers.length;t++){var n=e.providers[t];r&&(n.flags|=4096);var i=Ra.get(n.token);i&&(n.flags=-3841&n.flags|i.flags,n.deps=hr(i.deps),n.value=i.value)}if(xa.size>0){var o=new Set(e.modules);xa.forEach(function(t,n){if(o.has(me(n).providedIn)){var i={token:n,flags:t.flags|(r?4096:0),deps:hr(t.deps),value:t.value,index:e.providers.length};e.providers.push(i),e.providersByKey[Kn(n)]=i}})}}(e=e.factory(function(){return Wn})),e):e}(r))}var Ra=new Map,xa=new Map,Oa=new Map;function Pa(e){var t;Ra.set(e.token,e),"function"==typeof e.token&&(t=me(e.token))&&"function"==typeof t.providedIn&&xa.set(e.token,e)}function Ma(e,t){var n=pr(t.viewDefFactory),r=pr(n.nodes[0].element.componentView);Oa.set(e,r)}function La(){Ra.clear(),xa.clear(),Oa.clear()}function Va(e){if(0===Ra.size)return e;var t=function(e){for(var t=[],n=null,r=0;r<e.nodes.length;r++){var i=e.nodes[r];1&i.flags&&(n=i),n&&3840&i.flags&&Ra.has(i.provider.token)&&(t.push(n.nodeIndex),n=null)}return t}(e);if(0===t.length)return e;e=e.factory(function(){return Wn});for(var n=0;n<t.length;n++)r(e,t[n]);return e;function r(e,t){for(var n=t+1;n<e.nodes.length;n++){var r=e.nodes[n];if(1&r.flags)return;if(3840&r.flags){var i=r.provider,o=Ra.get(i.token);o&&(r.flags=-3841&r.flags|o.flags,i.deps=hr(o.deps),i.value=o.value)}}}}function Fa(e,t,n,r,i,o,a,s,u,c,l,h,f){var d=e.def.nodes[t];return da(e,d,n,r,i,o,a,s,u,c,l,h,f),224&d.flags?zn(e,t).value:void 0}function Ua(e,t,n,r,i,o,a,s,u,c,l,h,f){var d=e.def.nodes[t];return ya(e,d,n,r,i,o,a,s,u,c,l,h,f),224&d.flags?zn(e,t).value:void 0}function qa(e){return rs(Wa.detectChanges,fa,null,[e])}function Ba(e){return rs(Wa.checkNoChanges,ha,null,[e])}function ja(e){return rs(Wa.destroy,ma,null,[e])}var za,Qa,Ha,Wa=function(){var e={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return e[e.create]="create",e[e.detectChanges]="detectChanges",e[e.checkNoChanges]="checkNoChanges",e[e.destroy]="destroy",e[e.handleEvent]="handleEvent",e}();function Ga(e,t){Qa=e,Ha=t}function Ka(e,t,n,r){return Ga(e,t),rs(Wa.handleEvent,e.def.handleEvent,null,[e,t,n,r])}function Ya(e,t){if(128&e.state)throw Vn(Wa[za]);return Ga(e,$a(e,0)),e.def.updateDirectives(function(e,n,r){for(var i=e.def.nodes[n],o=arguments.length,a=new Array(o>3?o-3:0),s=3;s<o;s++)a[s-3]=arguments[s];return 0===t?Ja(e,i,r,a):Xa(e,i,r,a),16384&i.flags&&Ga(e,$a(e,n)),224&i.flags?zn(e,i.nodeIndex).value:void 0},e)}function Za(e,t){if(128&e.state)throw Vn(Wa[za]);return Ga(e,es(e,0)),e.def.updateRenderer(function(e,n,r){for(var i=e.def.nodes[n],o=arguments.length,a=new Array(o>3?o-3:0),s=3;s<o;s++)a[s-3]=arguments[s];return 0===t?Ja(e,i,r,a):Xa(e,i,r,a),3&i.flags&&Ga(e,es(e,n)),224&i.flags?zn(e,i.nodeIndex).value:void 0},e)}function Ja(e,t,n,r){if(da.apply(void 0,[e,t,n].concat(_toConsumableArray(r)))){var i=1===n?r[0]:r;if(16384&t.flags){for(var o={},a=0;a<t.bindings.length;a++){var s=t.bindings[a],u=i[a];8&s.flags&&(o[(d=s.nonMinifiedName,p=void 0,p=d.replace(/[$@]/g,"_"),"ng-reflect-".concat(d=p.replace(At,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return"-"+t[1].toLowerCase()})))]=Dt(u))}var c=t.parent,l=Bn(e,c.nodeIndex).renderElement;if(c.element.name)for(var h in o){var f=o[h];null!=f?e.renderer.setAttribute(l,h,f):e.renderer.removeAttribute(l,h)}else e.renderer.setValue(l,"bindings=".concat(JSON.stringify(o,null,2)))}}var d,p}function Xa(e,t,n,r){ya.apply(void 0,[e,t,n].concat(_toConsumableArray(r)))}function $a(e,t){for(var n=t;n<e.def.nodes.length;n++){var r=e.def.nodes[n];if(16384&r.flags&&r.bindings&&r.bindings.length)return n}return null}function es(e,t){for(var n=t;n<e.def.nodes.length;n++){var r=e.def.nodes[n];if(3&r.flags&&r.bindings&&r.bindings.length)return n}return null}var ts=function(){function e(t,n){_classCallCheck(this,e),this.view=t,this.nodeIndex=n,null==n&&(this.nodeIndex=n=0),this.nodeDef=t.def.nodes[n];for(var r=this.nodeDef,i=t;r&&0==(1&r.flags);)r=r.parent;if(!r)for(;!r&&i;)r=ar(i),i=i.parent;this.elDef=r,this.elView=i}return _createClass(e,[{key:"logError",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,o;2&this.nodeDef.flags?(i=this.view.def,o=this.nodeDef.nodeIndex):(i=this.elView.def,o=this.elDef.nodeIndex);var a=function(e,t){for(var n=-1,r=0;r<=t;r++)3&e.nodes[r].flags&&n++;return n}(i,o),s=-1;i.factory(function(){var t;return++s===a?(t=e.error).bind.apply(t,[e].concat(n)):Wn}),s<a&&(e.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),e.error.apply(e,n))}},{key:"elOrCompView",get:function(){return Bn(this.elView,this.elDef.nodeIndex).componentView||this.view}},{key:"injector",get:function(){return zr(this.elView,this.elDef)}},{key:"component",get:function(){return this.elOrCompView.component}},{key:"context",get:function(){return this.elOrCompView.context}},{key:"providerTokens",get:function(){var e=[];if(this.elDef)for(var t=this.elDef.nodeIndex+1;t<=this.elDef.nodeIndex+this.elDef.childCount;t++){var n=this.elView.def.nodes[t];20224&n.flags&&e.push(n.provider.token),t+=n.childCount}return e}},{key:"references",get:function(){var e={};if(this.elDef){ns(this.elView,this.elDef,e);for(var t=this.elDef.nodeIndex+1;t<=this.elDef.nodeIndex+this.elDef.childCount;t++){var n=this.elView.def.nodes[t];20224&n.flags&&ns(this.elView,n,e),t+=n.childCount}}return e}},{key:"componentRenderElement",get:function(){var e=function(e){for(;e&&!ur(e);)e=e.parent;return e.parent?Bn(e.parent,ar(e).nodeIndex):null}(this.elOrCompView);return e?e.renderElement:void 0}},{key:"renderNode",get:function(){return 2&this.nodeDef.flags?sr(this.view,this.nodeDef):sr(this.elView,this.elDef)}}]),e}();function ns(e,t,n){for(var r in t.references)n[r]=Zo(e,t,t.references[r])}function rs(e,t,n,r){var i,o,a=za,s=Qa,u=Ha;try{za=e;var c=t.apply(n,r);return Qa=s,Ha=u,za=a,c}catch(l){if(Ze(l)||!Qa)throw l;throw i=l,o=is(),i instanceof Error||(i=new Error(i.toString())),Ln(i,o),i}}function is(){return Qa?new ts(Qa,Ha):null}var os=function(){function e(t){_classCallCheck(this,e),this.delegate=t}return _createClass(e,[{key:"createRenderer",value:function(e,t){return new as(this.delegate.createRenderer(e,t))}},{key:"begin",value:function(){this.delegate.begin&&this.delegate.begin()}},{key:"end",value:function(){this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)}}]),e}(),as=function(){function e(t){_classCallCheck(this,e),this.delegate=t,this.debugContextFactory=is,this.data=this.delegate.data}return _createClass(e,[{key:"createDebugContext",value:function(e){return this.debugContextFactory(e)}},{key:"destroyNode",value:function(e){var t=Oo(e);xo.delete(t.nativeNode),t instanceof No&&(t.listeners.length=0),this.delegate.destroyNode&&this.delegate.destroyNode(e)}},{key:"destroy",value:function(){this.delegate.destroy()}},{key:"createElement",value:function(e,t){var n=this.delegate.createElement(e,t),r=this.createDebugContext(n);if(r){var i=new Ro(n,null,r);i.name=e,Po(i)}return n}},{key:"createComment",value:function(e){var t=this.delegate.createComment(e),n=this.createDebugContext(t);return n&&Po(new No(t,null,n)),t}},{key:"createText",value:function(e){var t=this.delegate.createText(e),n=this.createDebugContext(t);return n&&Po(new No(t,null,n)),t}},{key:"appendChild",value:function(e,t){var n=Oo(e),r=Oo(t);n&&r&&n instanceof Ro&&n.addChild(r),this.delegate.appendChild(e,t)}},{key:"insertBefore",value:function(e,t,n){var r=Oo(e),i=Oo(t),o=Oo(n);r&&i&&r instanceof Ro&&r.insertBefore(o,i),this.delegate.insertBefore(e,t,n)}},{key:"removeChild",value:function(e,t){var n=Oo(e),r=Oo(t);n&&r&&n instanceof Ro&&n.removeChild(r),this.delegate.removeChild(e,t)}},{key:"selectRootElement",value:function(e,t){var n=this.delegate.selectRootElement(e,t),r=is();return r&&Po(new Ro(n,null,r)),n}},{key:"setAttribute",value:function(e,t,n,r){var i=Oo(e);i&&i instanceof Ro&&(i.attributes[r?r+":"+t:t]=n),this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){var r=Oo(e);r&&r instanceof Ro&&(r.attributes[n?n+":"+t:t]=null),this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){var n=Oo(e);n&&n instanceof Ro&&(n.classes[t]=!0),this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){var n=Oo(e);n&&n instanceof Ro&&(n.classes[t]=!1),this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){var i=Oo(e);i&&i instanceof Ro&&(i.styles[t]=n),this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){var r=Oo(e);r&&r instanceof Ro&&(r.styles[t]=null),this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){var r=Oo(e);r&&r instanceof Ro&&(r.properties[t]=n),this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){if("string"!=typeof e){var r=Oo(e);r&&r.listeners.push(new Do(t,n))}return this.delegate.listen(e,t,n)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setValue",value:function(e,t){return this.delegate.setValue(e,t)}}]),e}();var ss=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).moduleType=e,i._bootstrapComponents=n,i._ngModuleDefFactory=r,i}return _inherits(t,je),_createClass(t,[{key:"create",value:function(e){!function(){if(!Sa){Sa=!0;var e=nt()?{setCurrentNode:Ga,createRootView:Ta,createEmbeddedView:Aa,createComponentView:Da,createNgModuleRef:Na,overrideProvider:Pa,overrideComponentView:Ma,clearOverrides:La,checkAndUpdateView:qa,checkNoChangesView:Ba,destroyView:ja,createDebugContext:function(e,t){return new ts(e,t)},handleEvent:Ka,updateDirectives:Ya,updateRenderer:Za}:{setCurrentNode:function(){},createRootView:Ea,createEmbeddedView:oa,createComponentView:sa,createNgModuleRef:Kr,overrideProvider:Wn,overrideComponentView:Wn,clearOverrides:Wn,checkAndUpdateView:fa,checkNoChangesView:ha,destroyView:ma,createDebugContext:function(e,t){return new ts(e,t)},handleEvent:function(e,t,n,r){return e.def.handleEvent(e,t,n,r)},updateDirectives:function(e,t){return e.def.updateDirectives(0===t?Fa:Ua,e)},updateRenderer:function(e,t){return e.def.updateRenderer(0===t?Fa:Ua,e)}};Hn.setCurrentNode=e.setCurrentNode,Hn.createRootView=e.createRootView,Hn.createEmbeddedView=e.createEmbeddedView,Hn.createComponentView=e.createComponentView,Hn.createNgModuleRef=e.createNgModuleRef,Hn.overrideProvider=e.overrideProvider,Hn.overrideComponentView=e.overrideComponentView,Hn.clearOverrides=e.clearOverrides,Hn.checkAndUpdateView=e.checkAndUpdateView,Hn.checkNoChangesView=e.checkNoChangesView,Hn.destroyView=e.destroyView,Hn.resolveDep=pi,Hn.createDebugContext=e.createDebugContext,Hn.handleEvent=e.handleEvent,Hn.updateDirectives=e.updateDirectives,Hn.updateRenderer=e.updateRenderer,Hn.dirtyParentQueries=Go}}();var t=function(e){var t=Array.from(e.providers),n=Array.from(e.modules),r={};for(var i in e.providersByKey)r[i]=e.providersByKey[i];return{factory:e.factory,isRoot:e.isRoot,providers:t,modules:n,providersByKey:r}}(pr(this._ngModuleDefFactory));return Hn.createNgModuleRef(this.moduleType,e||Pt.NULL,this._bootstrapComponents,t)}}]),t}(),us=function e(){_classCallCheck(this,e)},cs=function e(){_classCallCheck(this,e),this.title="toolkit"},ls=function e(){_classCallCheck(this,e)},hs=new De("Location Initialized"),fs=function e(){_classCallCheck(this,e)},ds=new De("appBaseHref"),ps=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._subject=new Ii,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=e.stripTrailingSlash(ys(i)),this._platformStrategy.onPopState(function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})})}return _createClass(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(t+e.normalizeQueryParams(n))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,ys(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+e.normalizeQueryParams(n)),r)}},{key:"replaceState",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+e.normalizeQueryParams(n)),r)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)})}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(n){return n(e,t)})}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}],[{key:"normalizeQueryParams",value:function(e){return e&&"?"!==e[0]?"?"+e:e}},{key:"joinWithSlash",value:function(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}},{key:"stripTrailingSlash",value:function(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}}]),e}();function ys(e){return e.replace(/\/index.html$/,"")}var vs=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._platformLocation=e,r._baseHref="",null!=n&&(r._baseHref=n),r}return _inherits(t,fs),_createClass(t,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=ps.joinWithSlash(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+ps.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+ps.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),t}(),ms=function(e){function t(e,n){var r;if(_classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._platformLocation=e,null==n&&(n=r._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return r._baseHref=n,_possibleConstructorReturn(r)}return _inherits(t,fs),_createClass(t,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return ps.joinWithSlash(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+ps.normalizeQueryParams(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+ps.normalizeQueryParams(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+ps.normalizeQueryParams(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),t}(),gs=function(){var e={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return e[e.Zero]="Zero",e[e.One]="One",e[e.Two]="Two",e[e.Few]="Few",e[e.Many]="Many",e[e.Other]="Other",e}(),_s=new De("UseV4Plurals"),bs=function e(){_classCallCheck(this,e)},ws=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).locale=e,r.deprecatedPluralFn=n,r}return _inherits(t,bs),_createClass(t,[{key:"getPluralCategory",value:function(e,t){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(t||this.locale,e):function(e){return function(e){var t=e.toLowerCase().replace(/_/g,"-"),n=wi[t];if(n)return n;var r=t.split("-")[0];if(n=wi[r])return n;if("en"===r)return Si;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}(e)[Ci.PluralCase]}(t||this.locale)(e)){case gs.Zero:return"zero";case gs.One:return"one";case gs.Two:return"two";case gs.Few:return"few";case gs.Many:return"many";default:return"other"}}}]),t}(),Cs=function e(){_classCallCheck(this,e)},ks=function(){function e(t,n,r,i){_classCallCheck(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._initialClasses=[]}return _createClass(e,[{key:"getValue",value:function(){return null}},{key:"setClass",value:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"setNgClass",value:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Kt(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"applyChanges",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(_e(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}(),Ss=function(){var e=function(){function e(t){_classCallCheck(this,e),this._delegate=t}return _createClass(e,[{key:"getValue",value:function(){return this._delegate.getValue()}}]),e}();return e.ngDirectiveDef=void 0,e}(),Es=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,Ss),_createClass(t,[{key:"ngDoCheck",value:function(){this._delegate.applyChanges()}},{key:"klass",set:function(e){this._delegate.setClass(e)}},{key:"ngClass",set:function(e){this._delegate.setNgClass(e)}}]),t}(),Ts=function(){function e(t,n,r,i){_classCallCheck(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return _createClass(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),Is=function(){function e(t,n,r){_classCallCheck(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOfDirty=!0,this._differ=null}return _createClass(e,[{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(r){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'. NgFor only supports binding to Iterables such as Arrays."))}}var t;if(this._differ){var n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var o=t._viewContainer.createEmbeddedView(t._template,new Ts(null,t._ngForOf,-1,-1),null===i?void 0:i),a=new As(e,o);n.push(a)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new As(e,s);n.push(u)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,o=this._viewContainer.length;i<o;i++){var a=this._viewContainer.get(i);a.context.index=i,a.context.count=o,a.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}},{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",set:function(e){nt()&&null!=e&&"function"!=typeof e&&console&&console.warn&&console.warn("trackBy must be a function, but received ".concat(JSON.stringify(e),". ")+"See https://angular.io/docs/ts/latest/api/common/index/NgFor-directive.html#!#change-propagation for more information."),this._trackByFn=e},get:function(){return this._trackByFn}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}(),As=function e(t,n){_classCallCheck(this,e),this.record=t,this.view=n},Ds=function(){function e(t,n){_classCallCheck(this,e),this._viewContainer=t,this._context=new Ns,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return _createClass(e,[{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}},{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){Rs("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){Rs("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}}]),e}(),Ns=function e(){_classCallCheck(this,e),this.$implicit=null,this.ngIf=null};function Rs(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(_e(t),"'."))}var xs=function e(){_classCallCheck(this,e)},Os=new De("DocumentToken"),Ps="server";function Ms(e){return e===Ps}var Ls,Vs=((Ls=function e(){_classCallCheck(this,e)}).ngInjectableDef=ve({token:Ls,providedIn:"root",factory:function(){return new Fs(Fe(Os),window,Fe($e))}}),Ls),Fs=function(){function e(t,n,r){_classCallCheck(this,e),this.document=t,this.window=n,this.errorHandler=r,this.offset=function(){return[0,0]}}return _createClass(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportScrollRestoration()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportScrollRestoration()){e=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(e):e.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{var t=this.document.querySelector("#".concat(e));if(t)return void this.scrollToElement(t);var n=this.document.querySelector("[name='".concat(e,"']"));if(n)return void this.scrollToElement(n)}catch(r){this.errorHandler.handleError(r)}}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"supportScrollRestoration",value:function(){try{return!!this.window&&!!this.window.scrollTo}catch(e){return!1}}}]),e}(),Us=new k(function(e){return e.complete()});function qs(e){return e?function(e){return new k(function(t){return e.schedule(function(){return t.complete()})})}(e):Us}function Bs(e){var t=new k(function(t){t.next(e),t.complete()});return t._isScalar=!0,t.value=e,t}function js(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[t.length-1];switch(x(r)?t.pop():r=void 0,t.length){case 0:return qs(r);case 1:return r?G(t,r):Bs(t[0]);default:return G(t,r)}}var zs=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._value=e,n}return _inherits(t,N),_createClass(t,[{key:"_subscribe",value:function(e){var n=_get(_getPrototypeOf(t.prototype),"_subscribe",this).call(this,e);return n&&!n.closed&&e.next(this._value),n}},{key:"getValue",value:function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new I;return this._value}},{key:"next",value:function(e){_get(_getPrototypeOf(t.prototype),"next",this).call(this,this._value=e)}},{key:"value",get:function(){return this.getValue()}}]),t}();function Qs(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}Qs.prototype=Object.create(Error.prototype);var Hs=Qs,Ws={},Gs=function(){function e(t){_classCallCheck(this,e),this.resultSelector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Ks(e,this.resultSelector))}}]),e}(),Ks=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return _inherits(t,z),_createClass(t,[{key:"_next",value:function(e){this.values.push(Ws),this.observables.push(e)}},{key:"_complete",value:function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(j(this,r,r,n))}}}},{key:"notifyComplete",value:function(e){0==(this.active-=1)&&this.destination.complete()}},{key:"notifyNext",value:function(e,t,n,r,i){var o=this.values,a=this.toRespond?o[n]===Ws?--this.toRespond:this.toRespond:0;o[n]=t,0===a&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))}},{key:"_tryResultSelector",value:function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),t}();function Ys(e){return new k(function(t){var n;try{n=e()}catch(r){return void t.error(r)}return(n?K(n):qs()).subscribe(t)})}function Zs(){return $(1)}function Js(e,t){return function(n){return n.lift(new Xs(e,t))}}var Xs=function(){function e(t,n){_classCallCheck(this,e),this.predicate=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new $s(e,this.predicate,this.thisArg))}}]),e}(),$s=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).predicate=n,i.thisArg=r,i.count=0,i}return _inherits(t,v),_createClass(t,[{key:"_next",value:function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(e)}}]),t}();function eu(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}eu.prototype=Object.create(Error.prototype);var tu=eu;function nu(e){return function(t){return 0===e?qs():t.lift(new ru(e))}}var ru=function(){function e(t){if(_classCallCheck(this,e),this.total=t,this.total<0)throw new tu}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new iu(e,this.total))}}]),e}(),iu=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).total=n,r.ring=new Array,r.count=0,r}return _inherits(t,v),_createClass(t,[{key:"_next",value:function(e){var t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e}},{key:"_complete",value:function(){var e=this.destination,t=this.count;if(t>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=t++%n;e.next(r[o])}e.complete()}}]),t}();function ou(e,t,n){return function(r){return r.lift(new au(e,t,n))}}var au=function(){function e(t,n,r){_classCallCheck(this,e),this.nextOrObserver=t,this.error=n,this.complete=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new su(e,this.nextOrObserver,this.error,this.complete))}}]),e}(),su=function(e){function t(e,n,i,o){var a;return _classCallCheck(this,t),(a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e)))._tapNext=_,a._tapError=_,a._tapComplete=_,a._tapError=i||_,a._tapComplete=o||_,r(n)?(a._context=_assertThisInitialized(a),a._tapNext=n):n&&(a._context=n,a._tapNext=n.next||_,a._tapError=n.error||_,a._tapComplete=n.complete||_),a}return _inherits(t,v),_createClass(t,[{key:"_next",value:function(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}},{key:"_error",value:function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}},{key:"_complete",value:function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}]),t}(),uu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return new Hs};return ou({hasValue:!1,next:function(){this.hasValue=!0},complete:function(){if(!this.hasValue)throw e()}})};function cu(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(t){return t.lift(new lu(e))}}var lu=function(){function e(t){_classCallCheck(this,e),this.defaultValue=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new hu(e,this.defaultValue))}}]),e}(),hu=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).defaultValue=n,r.isEmpty=!0,r}return _inherits(t,v),_createClass(t,[{key:"_next",value:function(e){this.isEmpty=!1,this.destination.next(e)}},{key:"_complete",value:function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}]),t}();function fu(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Js(function(t,n){return e(t,n,r)}):X,nu(1),n?cu(t):uu(function(){return new Hs}))}}function du(e){return function(t){var n=new pu(e),r=t.lift(n);return n.caught=r}}var pu=function(){function e(t){_classCallCheck(this,e),this.selector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new yu(e,this.selector,this.caught))}}]),e}(),yu=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).selector=n,i.caught=r,i}return _inherits(t,z),_createClass(t,[{key:"error",value:function(e){if(!this.isStopped){var n;try{n=this.selector(e,this.caught)}catch(i){return void _get(_getPrototypeOf(t.prototype),"error",this).call(this,i)}this._unsubscribeAndRecycle();var r=new O(this,void 0,void 0);this.add(r),j(this,n,void 0,void 0,r)}}}]),t}();function vu(e){return function(t){return 0===e?qs():t.lift(new mu(e))}}var mu=function(){function e(t){if(_classCallCheck(this,e),this.total=t,this.total<0)throw new tu}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new gu(e,this.total))}}]),e}(),gu=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).total=n,r.count=0,r}return _inherits(t,v),_createClass(t,[{key:"_next",value:function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))}}]),t}();function _u(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Js(function(t,n){return e(t,n,r)}):X,vu(1),n?cu(t):uu(function(){return new Hs}))}}var bu=function(){function e(t,n,r){_classCallCheck(this,e),this.predicate=t,this.thisArg=n,this.source=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new wu(e,this.predicate,this.thisArg,this.source))}}]),e}(),wu=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).predicate=n,o.thisArg=r,o.source=i,o.index=0,o.thisArg=r||_assertThisInitialized(o),o}return _inherits(t,v),_createClass(t,[{key:"notifyComplete",value:function(e){this.destination.next(e),this.destination.complete()}},{key:"_next",value:function(e){var t=!1;try{t=this.predicate.call(this.thisArg,e,this.index++,this.source)}catch(n){return void this.destination.error(n)}t||this.notifyComplete(!1)}},{key:"_complete",value:function(){this.notifyComplete(!0)}}]),t}();function Cu(e,t){return"function"==typeof t?function(n){return n.pipe(Cu(function(n,r){return K(e(n,r)).pipe(Q(function(e,i){return t(n,e,r,i)}))}))}:function(t){return t.lift(new ku(e))}}var ku=function(){function e(t){_classCallCheck(this,e),this.project=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Su(e,this.project))}}]),e}(),Su=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).project=n,r.index=0,r}return _inherits(t,z),_createClass(t,[{key:"_next",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this._innerSub(t,e,n)}},{key:"_innerSub",value:function(e,t,n){var r=this.innerSubscription;r&&r.unsubscribe();var i=new O(this,void 0,void 0);this.destination.add(i),this.innerSubscription=j(this,e,t,n,i)}},{key:"_complete",value:function(){var e=this.innerSubscription;e&&!e.closed||_get(_getPrototypeOf(t.prototype),"_complete",this).call(this),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.innerSubscription=null}},{key:"notifyComplete",value:function(e){this.destination.remove(e),this.innerSubscription=null,this.isStopped&&_get(_getPrototypeOf(t.prototype),"_complete",this).call(this)}},{key:"notifyNext",value:function(e,t,n,r,i){this.destination.next(t)}}]),t}();function Eu(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Tu(e,t,n))}}var Tu=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.accumulator=t,this.seed=n,this.hasSeed=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Iu(e,this.accumulator,this.seed,this.hasSeed))}}]),e}(),Iu=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).accumulator=n,o._seed=r,o.hasSeed=i,o.index=0,o}return _inherits(t,v),_createClass(t,[{key:"_next",value:function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(r){this.destination.error(r)}this.seed=t,this.destination.next(t)}},{key:"seed",get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e}}]),t}();function Au(e,t){return Y(e,t,1)}var Du=function(){function e(t){_classCallCheck(this,e),this.callback=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Nu(e,this.callback))}}]),e}(),Nu=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).add(new d(n)),r}return _inherits(t,v),t}(),Ru=null;function xu(){return Ru}var Ou,Pu=function(){function e(){_classCallCheck(this,e),this.resourceLoaderType=null}return _createClass(e,[{key:"attrToPropMap",get:function(){return this._attrToPropMap},set:function(e){this._attrToPropMap=e}}]),e}(),Mu=function(e){function t(){var e;_classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._animationPrefix=null,e._transitionEnd=null;try{var n=e.createElement("div",document);if(null!=e.getStyle(n,"animationName"))e._animationPrefix="";else for(var r=["Webkit","Moz","O","ms"],i=0;i<r.length;i++)if(null!=e.getStyle(n,r[i]+"AnimationName")){e._animationPrefix="-"+r[i].toLowerCase()+"-";break}var o={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(o).forEach(function(t){null!=e.getStyle(n,t)&&(e._transitionEnd=o[t])})}catch(a){e._animationPrefix=null,e._transitionEnd=null}return e}return _inherits(t,Pu),_createClass(t,[{key:"getDistributedNodes",value:function(e){return e.getDistributedNodes()}},{key:"resolveAndSetHref",value:function(e,t,n){e.href=null==n?t:t+"/../"+n}},{key:"supportsDOMEvents",value:function(){return!0}},{key:"supportsNativeShadowDOM",value:function(){return"function"==typeof document.body.createShadowRoot}},{key:"getAnimationPrefix",value:function(){return this._animationPrefix?this._animationPrefix:""}},{key:"getTransitionEnd",value:function(){return this._transitionEnd?this._transitionEnd:""}},{key:"supportsAnimation",value:function(){return null!=this._animationPrefix&&null!=this._transitionEnd}}]),t}(),Lu={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},Vu={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Fu={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Uu=function(){if(Ae.Node)return Ae.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))}}(),qu=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,Mu),_createClass(t,[{key:"parse",value:function(e){throw new Error("parse not implemented")}},{key:"hasProperty",value:function(e,t){return t in e}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"getProperty",value:function(e,t){return e[t]}},{key:"invoke",value:function(e,t,n){e[t].apply(e,_toConsumableArray(n))}},{key:"logError",value:function(e){window.console&&(console.error?console.error(e):console.log(e))}},{key:"log",value:function(e){window.console&&window.console.log&&window.console.log(e)}},{key:"logGroup",value:function(e){window.console&&window.console.group&&window.console.group(e)}},{key:"logGroupEnd",value:function(){window.console&&window.console.groupEnd&&window.console.groupEnd()}},{key:"contains",value:function(e,t){return Uu.call(e,t)}},{key:"querySelector",value:function(e,t){return e.querySelector(t)}},{key:"querySelectorAll",value:function(e,t){return e.querySelectorAll(t)}},{key:"on",value:function(e,t,n){e.addEventListener(t,n,!1)}},{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"createMouseEvent",value:function(e){var t=this.getDefaultDocument().createEvent("MouseEvent");return t.initEvent(e,!0,!0),t}},{key:"createEvent",value:function(e){var t=this.getDefaultDocument().createEvent("Event");return t.initEvent(e,!0,!0),t}},{key:"preventDefault",value:function(e){e.preventDefault(),e.returnValue=!1}},{key:"isPrevented",value:function(e){return e.defaultPrevented||null!=e.returnValue&&!e.returnValue}},{key:"getInnerHTML",value:function(e){return e.innerHTML}},{key:"getTemplateContent",value:function(e){return"content"in e&&this.isTemplateElement(e)?e.content:null}},{key:"getOuterHTML",value:function(e){return e.outerHTML}},{key:"nodeName",value:function(e){return e.nodeName}},{key:"nodeValue",value:function(e){return e.nodeValue}},{key:"type",value:function(e){return e.type}},{key:"content",value:function(e){return this.hasProperty(e,"content")?e.content:e}},{key:"firstChild",value:function(e){return e.firstChild}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"parentElement",value:function(e){return e.parentNode}},{key:"childNodes",value:function(e){return e.childNodes}},{key:"childNodesAsList",value:function(e){for(var t=e.childNodes,n=new Array(t.length),r=0;r<t.length;r++)n[r]=t[r];return n}},{key:"clearNodes",value:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"removeChild",value:function(e,t){e.removeChild(t)}},{key:"replaceChild",value:function(e,t,n){e.replaceChild(t,n)}},{key:"remove",value:function(e){return e.parentNode&&e.parentNode.removeChild(e),e}},{key:"insertBefore",value:function(e,t,n){e.insertBefore(n,t)}},{key:"insertAllBefore",value:function(e,t,n){n.forEach(function(n){return e.insertBefore(n,t)})}},{key:"insertAfter",value:function(e,t,n){e.insertBefore(n,t.nextSibling)}},{key:"setInnerHTML",value:function(e,t){e.innerHTML=t}},{key:"getText",value:function(e){return e.textContent}},{key:"setText",value:function(e,t){e.textContent=t}},{key:"getValue",value:function(e){return e.value}},{key:"setValue",value:function(e,t){e.value=t}},{key:"getChecked",value:function(e){return e.checked}},{key:"setChecked",value:function(e,t){e.checked=t}},{key:"createComment",value:function(e){return this.getDefaultDocument().createComment(e)}},{key:"createTemplate",value:function(e){var t=this.getDefaultDocument().createElement("template");return t.innerHTML=e,t}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createElementNS",value:function(e,t,n){return(n=n||this.getDefaultDocument()).createElementNS(e,t)}},{key:"createTextNode",value:function(e,t){return(t=t||this.getDefaultDocument()).createTextNode(e)}},{key:"createScriptTag",value:function(e,t,n){var r=(n=n||this.getDefaultDocument()).createElement("SCRIPT");return r.setAttribute(e,t),r}},{key:"createStyleElement",value:function(e,t){var n=(t=t||this.getDefaultDocument()).createElement("style");return this.appendChild(n,this.createTextNode(e,t)),n}},{key:"createShadowRoot",value:function(e){return e.createShadowRoot()}},{key:"getShadowRoot",value:function(e){return e.shadowRoot}},{key:"getHost",value:function(e){return e.host}},{key:"clone",value:function(e){return e.cloneNode(!0)}},{key:"getElementsByClassName",value:function(e,t){return e.getElementsByClassName(t)}},{key:"getElementsByTagName",value:function(e,t){return e.getElementsByTagName(t)}},{key:"classList",value:function(e){return Array.prototype.slice.call(e.classList,0)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"hasClass",value:function(e,t){return e.classList.contains(t)}},{key:"setStyle",value:function(e,t,n){e.style[t]=n}},{key:"removeStyle",value:function(e,t){e.style[t]=""}},{key:"getStyle",value:function(e,t){return e.style[t]}},{key:"hasStyle",value:function(e,t,n){var r=this.getStyle(e,t)||"";return n?r==n:r.length>0}},{key:"tagName",value:function(e){return e.tagName}},{key:"attributeMap",value:function(e){for(var t=new Map,n=e.attributes,r=0;r<n.length;r++){var i=n.item(r);t.set(i.name,i.value)}return t}},{key:"hasAttribute",value:function(e,t){return e.hasAttribute(t)}},{key:"hasAttributeNS",value:function(e,t,n){return e.hasAttributeNS(t,n)}},{key:"getAttribute",value:function(e,t){return e.getAttribute(t)}},{key:"getAttributeNS",value:function(e,t,n){return e.getAttributeNS(t,n)}},{key:"setAttribute",value:function(e,t,n){e.setAttribute(t,n)}},{key:"setAttributeNS",value:function(e,t,n,r){e.setAttributeNS(t,n,r)}},{key:"removeAttribute",value:function(e,t){e.removeAttribute(t)}},{key:"removeAttributeNS",value:function(e,t,n){e.removeAttributeNS(t,n)}},{key:"templateAwareRoot",value:function(e){return this.isTemplateElement(e)?this.content(e):e}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"getBoundingClientRect",value:function(e){try{return e.getBoundingClientRect()}catch(t){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}}},{key:"getTitle",value:function(e){return e.title}},{key:"setTitle",value:function(e,t){e.title=t||""}},{key:"elementMatches",value:function(e,t){return!!this.isElementNode(e)&&(e.matches&&e.matches(t)||e.msMatchesSelector&&e.msMatchesSelector(t)||e.webkitMatchesSelector&&e.webkitMatchesSelector(t))}},{key:"isTemplateElement",value:function(e){return this.isElementNode(e)&&"TEMPLATE"===e.nodeName}},{key:"isTextNode",value:function(e){return e.nodeType===Node.TEXT_NODE}},{key:"isCommentNode",value:function(e){return e.nodeType===Node.COMMENT_NODE}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"hasShadowRoot",value:function(e){return null!=e.shadowRoot&&e instanceof HTMLElement}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"importIntoDoc",value:function(e){return document.importNode(this.templateAwareRoot(e),!0)}},{key:"adoptNode",value:function(e){return document.adoptNode(e)}},{key:"getHref",value:function(e){return e.getAttribute("href")}},{key:"getEventKey",value:function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&Fu.hasOwnProperty(t)&&(t=Fu[t]))}return Vu[t]||t}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getHistory",value:function(){return window.history}},{key:"getLocation",value:function(){return window.location}},{key:"getBaseHref",value:function(e){var t,n=Bu||(Bu=document.querySelector("base"))?Bu.getAttribute("href"):null;return null==n?null:(t=n,Ou||(Ou=document.createElement("a")),Ou.setAttribute("href",t),"/"===Ou.pathname.charAt(0)?Ou.pathname:"/"+Ou.pathname)}},{key:"resetBaseElement",value:function(){Bu=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"setData",value:function(e,t,n){this.setAttribute(e,"data-"+t,n)}},{key:"getData",value:function(e,t){return this.getAttribute(e,"data-"+t)}},{key:"getComputedStyle",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return getComputedStyle(e)})},{key:"supportsWebAnimation",value:function(){return"function"==typeof Element.prototype.animate}},{key:"performanceNow",value:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}},{key:"supportsCookies",value:function(){return!0}},{key:"getCookie",value:function(e){return function(e,t){t=encodeURIComponent(t);var n=!0,r=!1,i=void 0;try{for(var o,a=e.split(";")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.indexOf("="),c=_slicedToArray(-1==u?[s,""]:[s.slice(0,u),s.slice(u+1)],2),l=c[0],h=c[1];if(l.trim()===t)return decodeURIComponent(h)}}catch(f){r=!0,i=f}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return null}(document.cookie,e)}},{key:"setCookie",value:function(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)}},{key:"attrToPropMap",get:function(){return Lu}}],[{key:"makeCurrent",value:function(){var e;e=new t,Ru||(Ru=e)}}]),t}(),Bu=null;function ju(){return!!window.history.pushState}var zu=new De("TRANSITION_ID"),Qu=[{provide:Ni,useFactory:function(e,t,n){return function(){n.get(Ri).donePromise.then(function(){var n=xu();Array.prototype.slice.apply(n.querySelectorAll(t,"style[ng-transition]")).filter(function(t){return n.getAttribute(t,"ng-transition")===e}).forEach(function(e){return n.remove(e)})})}},deps:[zu,Os,Pt],multi:!0}],Hu=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){Ae.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Ae.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Ae.getAllAngularRootElements=function(){return e.getAllRootElements()},Ae.frameworkStabilizers||(Ae.frameworkStabilizers=[]),Ae.frameworkStabilizers.push(function(e){var t=Ae.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}},{key:"findTestabilityInTree",value:function(e,t,n){if(null==t)return null;var r=e.getTestability(t);return null!=r?r:n?xu().isShadowRoot(t)?this.findTestabilityInTree(e,xu().getHost(t),!0):this.findTestabilityInTree(e,xu().parentElement(t),!0):null}}],[{key:"init",value:function(){var t;t=new e,fo=t}}]),e}();function Wu(e,t){"undefined"!=typeof COMPILED&&COMPILED||((Ae.ng=Ae.ng||{})[e]=t)}var Gu={ApplicationRef:Co,NgZone:no};function Ku(e){return Oo(e)}var Yu=new De("EventManagerPlugins"),Zu=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=r}),this._plugins=t.slice().reverse()}return _createClass(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}(),Ju=function(){function e(t){_classCallCheck(this,e),this._doc=t}return _createClass(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=xu().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),Xu=function(){function e(){_classCallCheck(this,e),this._stylesSet=new Set}return _createClass(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}(),$u=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._doc=e,n._hostNodes=new Set,n._styleNodes=new Set,n._hostNodes.add(e.head),n}return _inherits(t,Xu),_createClass(t,[{key:"_addStylesToHost",value:function(e,t){var n=this;e.forEach(function(e){var r=n._doc.createElement("style");r.textContent=e,n._styleNodes.add(t.appendChild(r))})}},{key:"addHost",value:function(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}},{key:"removeHost",value:function(e){this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n){return t._addStylesToHost(e,n)})}},{key:"ngOnDestroy",value:function(){this._styleNodes.forEach(function(e){return xu().remove(e)})}}]),t}(),ec={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},tc=/%COMP%/g,nc="_nghost-%COMP%",rc="_ngcontent-%COMP%";function ic(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?ic(e,i,n):(i=i.replace(tc,e),n.push(i))}return n}function oc(e){return function(t){!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var ac=function(){function e(t,n,r){_classCallCheck(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new sc(t)}return _createClass(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case He.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new lc(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case He.Native:case He.ShadowDom:return new hc(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=ic(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}(),sc=function(){function e(t){_classCallCheck(this,e),this.eventManager=t,this.data=Object.create(null)}return _createClass(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(ec[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=ec[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=ec[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&fn.DashCase?e.style.setProperty(t,n,r&fn.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&fn.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){cc(t,"property"),e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return cc(t,"listener"),"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,oc(n)):this.eventManager.addEventListener(e,t,oc(n))}}]),e}(),uc="@".charCodeAt(0);function cc(e,t){if(e.charCodeAt(0)===uc)throw new Error("Found the synthetic ".concat(t," ").concat(e,'. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.'))}var lc=function(e){function t(e,n,r,i){var o;_classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).component=r;var a=ic(i+"-"+r.id,r.styles,[]);return n.addStyles(a),o.contentAttr=rc.replace(tc,i+"-"+r.id),o.hostAttr=nc.replace(tc,i+"-"+r.id),o}return _inherits(t,sc),_createClass(t,[{key:"applyToHost",value:function(e){_get(_getPrototypeOf(t.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,n){var r=_get(_getPrototypeOf(t.prototype),"createElement",this).call(this,e,n);return _get(_getPrototypeOf(t.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),t}(),hc=function(e){function t(e,n,r,i){var o;_classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).sharedStylesHost=n,o.hostEl=r,o.component=i,o.shadowRoot=i.encapsulation===He.ShadowDom?r.attachShadow({mode:"open"}):r.createShadowRoot(),o.sharedStylesHost.addHost(o.shadowRoot);for(var a=ic(i.id,i.styles,[]),s=0;s<a.length;s++){var u=document.createElement("style");u.textContent=a[s],o.shadowRoot.appendChild(u)}return o}return _inherits(t,sc),_createClass(t,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,n){return _get(_getPrototypeOf(t.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),n)}},{key:"insertBefore",value:function(e,n,r){return _get(_getPrototypeOf(t.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),n,r)}},{key:"removeChild",value:function(e,n){return _get(_getPrototypeOf(t.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),n)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(_get(_getPrototypeOf(t.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),t}(),fc="undefined"!=typeof Zone&&Zone.__symbol__||function(e){return"__zone_symbol__"+e},dc=fc("addEventListener"),pc=fc("removeEventListener"),yc={},vc="__zone_symbol__propagationStopped",mc=function(){var e="undefined"!=typeof Zone&&Zone[fc("BLACK_LISTED_EVENTS")];if(e){var t={};return e.forEach(function(e){t[e]=e}),t}}(),gc=function(e){return!!mc&&mc.hasOwnProperty(e)},_c=function(e){var t=yc[e.type];if(t){var n=this[t];if(n){var r=[e];if(1===n.length){var i=n[0];return i.zone!==Zone.current?i.zone.run(i.handler,this,r):i.handler.apply(this,r)}for(var o=n.slice(),a=0;a<o.length&&!0!==e[vc];a++){var s=o[a];s.zone!==Zone.current?s.zone.run(s.handler,this,r):s.handler.apply(this,r)}}}},bc=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).ngZone=n,r&&Ms(r)||i.patchEvent(),i}return _inherits(t,Ju),_createClass(t,[{key:"patchEvent",value:function(){if("undefined"!=typeof Event&&Event&&Event.prototype&&!Event.prototype.__zone_symbol__stopImmediatePropagation){var e=Event.prototype.__zone_symbol__stopImmediatePropagation=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[vc]=!0),e&&e.apply(this,arguments)}}}},{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this,i=n;if(!e[dc]||no.isInAngularZone()&&!gc(t))e.addEventListener(t,i,!1);else{var o=yc[t];o||(o=yc[t]=fc("ANGULAR"+t+"FALSE"));var a=e[o],s=a&&a.length>0;a||(a=e[o]=[]);var u=gc(t)?Zone.root:Zone.current;if(0===a.length)a.push({zone:u,handler:i});else{for(var c=!1,l=0;l<a.length;l++)if(a[l].handler===i){c=!0;break}c||a.push({zone:u,handler:i})}s||e[dc](t,_c,!1)}return function(){return r.removeEventListener(e,t,i)}}},{key:"removeEventListener",value:function(e,t,n){var r=e[pc];if(!r)return e.removeEventListener.apply(e,[t,n,!1]);var i=yc[t],o=i&&e[i];if(!o)return e.removeEventListener.apply(e,[t,n,!1]);for(var a=!1,s=0;s<o.length;s++)if(o[s].handler===n){a=!0,o.splice(s,1);break}a?0===o.length&&r.apply(e,[t,_c,!1]):e.removeEventListener.apply(e,[t,n,!1])}}]),t}(),wc={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},Cc=new De("HammerGestureConfig"),kc=new De("HammerLoader"),Sc=function(){function e(){_classCallCheck(this,e),this.events=[],this.overrides={}}return _createClass(e,[{key:"buildHammer",value:function(e){var t=new Hammer(e,this.options);for(var n in t.get("pinch").set({enable:!0}),t.get("rotate").set({enable:!0}),this.overrides)t.get(n).set(this.overrides[n]);return t}}]),e}(),Ec=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e)))._config=n,o.console=r,o.loader=i,o}return _inherits(t,Ju),_createClass(t,[{key:"supports",value:function(e){return!(!wc.hasOwnProperty(e.toLowerCase())&&!this.isCustomEvent(e)||!window.Hammer&&!this.loader&&(this.console.warn('The "'.concat(e,'" event cannot be bound because Hammer.JS is not ')+"loaded and no custom loader has been specified."),1))}},{key:"addEventListener",value:function(e,t,n){var r=this,i=this.manager.getZone();if(t=t.toLowerCase(),!window.Hammer&&this.loader){var o=!1,a=function(){o=!0};return this.loader().then(function(){if(!window.Hammer)return r.console.warn("The custom HAMMER_LOADER completed, but Hammer.JS is not present."),void(a=function(){});o||(a=r.addEventListener(e,t,n))}).catch(function(){r.console.warn('The "'.concat(t,'" event cannot be bound because the custom ')+"Hammer.JS loader failed."),a=function(){}}),function(){a()}}return i.runOutsideAngular(function(){var o=r._config.buildHammer(e),a=function(e){i.runGuarded(function(){n(e)})};return o.on(t,a),function(){o.off(t,a),"function"==typeof o.destroy&&o.destroy()}})}},{key:"isCustomEvent",value:function(e){return this._config.events.indexOf(e)>-1}}]),t}(),Tc=["alt","control","meta","shift"],Ic={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},Ac=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,Ju),_createClass(t,[{key:"supports",value:function(e){return null!=t.parseEventName(e)}},{key:"addEventListener",value:function(e,n,r){var i=t.parseEventName(n),o=t.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return xu().onAndCancel(e,i.domEventName,o)})}}],[{key:"parseEventName",value:function(e){var n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;var i=t._normalizeKey(n.pop()),o="";if(Tc.forEach(function(e){var t=n.indexOf(e);t>-1&&(n.splice(t,1),o+=e+".")}),o+=i,0!=n.length||0===i.length)return null;var a={};return a.domEventName=r,a.fullKey=o,a}},{key:"getEventFullKey",value:function(e){var t="",n=xu().getEventKey(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),Tc.forEach(function(r){r!=n&&(0,Ic[r])(e)&&(t+=r+".")}),t+=n}},{key:"eventCallback",value:function(e,n,r){return function(i){t.getEventFullKey(i)===e&&r.runGuarded(function(){return n(i)})}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),t}(),Dc=function e(){_classCallCheck(this,e)},Nc=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._doc=e,n}return _inherits(t,Dc),_createClass(t,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case St.NONE:return t;case St.HTML:return t instanceof xc?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"HTML"),function(e,t){var n=null;try{ct=ct||new rt(e);var r=t?String(t):"";n=ct.getInertBodyElement(r);var i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=n.innerHTML,n=ct.getInertBodyElement(r)}while(r!==o);var a=new _t,s=a.sanitizeChildren(kt(n)||n);return nt()&&a.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),s}finally{if(n)for(var u=kt(n)||n;u.firstChild;)u.removeChild(u.firstChild)}}(this._doc,String(t)));case St.STYLE:return t instanceof Oc?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"Style"),function(e){if(!(e=String(e).trim()))return"";var t=e.match(It);return t&&at(t[1])===t[1]||e.match(Tt)&&function(e){for(var t=!0,n=!0,r=0;r<e.length;r++){var i=e.charAt(r);"'"===i&&n?t=!t:'"'===i&&t&&(n=!n)}return t&&n}(e)?e:(nt()&&console.warn("WARNING: sanitizing unsafe style value ".concat(e," (see http://g.co/ng/security#xss).")),"unsafe")}(t));case St.SCRIPT:if(t instanceof Pc)return t.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(t,"Script"),new Error("unsafe value used in a script context");case St.URL:return t instanceof Lc||t instanceof Mc?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"URL"),at(String(t)));case St.RESOURCE_URL:if(t instanceof Lc)return t.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(t,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see http://g.co/ng/security#xss)"))}}},{key:"checkNotSafeValue",value:function(e,t){if(e instanceof Rc)throw new Error("Required a safe ".concat(t,", got a ").concat(e.getTypeName()," ")+"(see http://g.co/ng/security#xss)")}},{key:"bypassSecurityTrustHtml",value:function(e){return new xc(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return new Oc(e)}},{key:"bypassSecurityTrustScript",value:function(e){return new Pc(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return new Mc(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return new Lc(e)}}]),t}(),Rc=function(){function e(t){_classCallCheck(this,e),this.changingThisBreaksApplicationSecurity=t}return _createClass(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity)+" (see http://g.co/ng/security#xss)"}}]),e}(),xc=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,Rc),_createClass(t,[{key:"getTypeName",value:function(){return"HTML"}}]),t}(),Oc=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,Rc),_createClass(t,[{key:"getTypeName",value:function(){return"Style"}}]),t}(),Pc=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,Rc),_createClass(t,[{key:"getTypeName",value:function(){return"Script"}}]),t}(),Mc=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,Rc),_createClass(t,[{key:"getTypeName",value:function(){return"URL"}}]),t}(),Lc=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,Rc),_createClass(t,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),t}(),Vc=mo(Mo,"browser",[{provide:Li,useValue:"browser"},{provide:Mi,useValue:function(){qu.makeCurrent(),Hu.init()},multi:!0},{provide:ls,useClass:function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._doc=e,n._init(),n}return _inherits(t,ls),_createClass(t,[{key:"_init",value:function(){this.location=xu().getLocation(),this._history=xu().getHistory()}},{key:"getBaseHrefFromDOM",value:function(){return xu().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){xu().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",e,!1)}},{key:"onHashChange",value:function(e){xu().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",e,!1)}},{key:"pushState",value:function(e,t,n){ju()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){ju()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"getState",value:function(){return this._history.state}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}}]),t}(),deps:[Os]},{provide:Os,useFactory:function(){return document},deps:[]}]);function Fc(){return new $e}var Uc=function(){function e(t){if(_classCallCheck(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return _createClass(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:xi,useValue:t.appId},{provide:zu,useExisting:xi},Qu]}}}]),e}();"undefined"!=typeof window&&window;var qc=function e(t,n){_classCallCheck(this,e),this.id=t,this.url=n},Bc=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).navigationTrigger=i,r.restoredState=o,r}return _inherits(t,qc),_createClass(t,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),t}(),jc=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).urlAfterRedirects=r,i}return _inherits(t,qc),_createClass(t,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),t}(),zc=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).reason=r,i}return _inherits(t,qc),_createClass(t,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),t}(),Qc=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).error=r,i}return _inherits(t,qc),_createClass(t,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),t}(),Hc=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).urlAfterRedirects=r,o.state=i,o}return _inherits(t,qc),_createClass(t,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),t}(),Wc=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).urlAfterRedirects=r,o.state=i,o}return _inherits(t,qc),_createClass(t,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),t}(),Gc=function(e){function t(e,n,r,i,o){var a;return _classCallCheck(this,t),(a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).urlAfterRedirects=r,a.state=i,a.shouldActivate=o,a}return _inherits(t,qc),_createClass(t,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),t}(),Kc=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).urlAfterRedirects=r,o.state=i,o}return _inherits(t,qc),_createClass(t,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),t}(),Yc=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).urlAfterRedirects=r,o.state=i,o}return _inherits(t,qc),_createClass(t,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),t}(),Zc=function(){function e(t){_classCallCheck(this,e),this.route=t}return _createClass(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),Jc=function(){function e(t){_classCallCheck(this,e),this.route=t}return _createClass(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),Xc=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),$c=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),el=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),tl=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),nl=function(){function e(t,n,r){_classCallCheck(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return _createClass(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),rl=function e(){_classCallCheck(this,e)},il="primary",ol=function(){function e(t){_classCallCheck(this,e),this.params=t||{}}return _createClass(e,[{key:"has",value:function(e){return this.params.hasOwnProperty(e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function al(e){return new ol(e)}var sl="ngNavigationCancelingError";function ul(e){var t=Error("NavigationCancelingError: "+e);return t[sl]=!0,t}function cl(e,t,n){var r=n.path.split("/");if(r.length>e.length)return null;if("full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},o=0;o<r.length;o++){var a=r[o],s=e[o];if(a.startsWith(":"))i[a.substring(1)]=s;else if(a!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}var ll=function e(t,n){_classCallCheck(this,e),this.routes=t,this.module=n};function hl(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];fl(r,dl(t,r))}}function fl(e,t){if(!e)throw new Error("\n      Invalid configuration of route '".concat(t,"': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    "));if(Array.isArray(e))throw new Error("Invalid configuration of route '".concat(t,"': Array cannot be specified"));if(!e.component&&!e.children&&!e.loadChildren&&e.outlet&&e.outlet!==il)throw new Error("Invalid configuration of route '".concat(t,"': a componentless route without children or loadChildren cannot have a named outlet set"));if(e.redirectTo&&e.children)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and children cannot be used together"));if(e.redirectTo&&e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and loadChildren cannot be used together"));if(e.children&&e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"': children and loadChildren cannot be used together"));if(e.redirectTo&&e.component)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and component cannot be used together"));if(e.path&&e.matcher)throw new Error("Invalid configuration of route '".concat(t,"': path and matcher cannot be used together"));if(void 0===e.redirectTo&&!e.component&&!e.children&&!e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"'. One of the following must be provided: component, redirectTo, children or loadChildren"));if(void 0===e.path&&void 0===e.matcher)throw new Error("Invalid configuration of route '".concat(t,"': routes must have either a path or a matcher specified"));if("string"==typeof e.path&&"/"===e.path.charAt(0))throw new Error("Invalid configuration of route '".concat(t,"': path cannot start with a slash"));if(""===e.path&&void 0!==e.redirectTo&&void 0===e.pathMatch)throw new Error("Invalid configuration of route '{path: \"".concat(t,'", redirectTo: "').concat(e.redirectTo,"\"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'."));if(void 0!==e.pathMatch&&"full"!==e.pathMatch&&"prefix"!==e.pathMatch)throw new Error("Invalid configuration of route '".concat(t,"': pathMatch can only be set to 'prefix' or 'full'"));e.children&&hl(e.children,t)}function dl(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function pl(e){var t=e.children&&e.children.map(pl),n=t?Object.assign({},e,{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==il&&(n.component=rl),n}function yl(e,t){var n,r=Object.keys(e),i=Object.keys(t);if(!r||!i||r.length!=i.length)return!1;for(var o=0;o<r.length;o++)if(e[n=r[o]]!==t[n])return!1;return!0}function vl(e){return Array.prototype.concat.apply([],e)}function ml(e){return e.length>0?e[e.length-1]:null}function gl(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function _l(e){return Jt(e)?e:Zt(e)?K(Promise.resolve(e)):js(e)}function bl(e,t,n){return n?function(e,t){return yl(e,t)}(e.queryParams,t.queryParams)&&function e(t,n){if(!Sl(t.segments,n.segments))return!1;if(t.numberOfChildren!==n.numberOfChildren)return!1;for(var r in n.children){if(!t.children[r])return!1;if(!e(t.children[r],n.children[r]))return!1}return!0}(e.root,t.root):function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(n){return t[n]===e[n]})}(e.queryParams,t.queryParams)&&function e(t,n){return function t(n,r,i){if(n.segments.length>i.length)return!!Sl(n.segments.slice(0,i.length),i)&&!r.hasChildren();if(n.segments.length===i.length){if(!Sl(n.segments,i))return!1;for(var o in r.children){if(!n.children[o])return!1;if(!e(n.children[o],r.children[o]))return!1}return!0}var a=i.slice(0,n.segments.length),s=i.slice(n.segments.length);return!!Sl(n.segments,a)&&!!n.children[il]&&t(n.children[il],r,s)}(t,n,n.segments)}(e.root,t.root)}var wl=function(){function e(t,n,r){_classCallCheck(this,e),this.root=t,this.queryParams=n,this.fragment=r}return _createClass(e,[{key:"toString",value:function(){return Al.serialize(this)}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=al(this.queryParams)),this._queryParamMap}}]),e}(),Cl=function(){function e(t,n){var r=this;_classCallCheck(this,e),this.segments=t,this.children=n,this.parent=null,gl(n,function(e,t){return e.parent=r})}return _createClass(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"toString",value:function(){return Dl(this)}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}}]),e}(),kl=function(){function e(t,n){_classCallCheck(this,e),this.path=t,this.parameters=n}return _createClass(e,[{key:"toString",value:function(){return Ml(this)}},{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=al(this.parameters)),this._parameterMap}}]),e}();function Sl(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}function El(e,t){var n=[];return gl(e.children,function(e,r){r===il&&(n=n.concat(t(e,r)))}),gl(e.children,function(e,r){r!==il&&(n=n.concat(t(e,r)))}),n}var Tl=function e(){_classCallCheck(this,e)},Il=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"parse",value:function(e){var t=new ql(e);return new wl(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t,n,r;return"".concat("/".concat(function e(t,n){if(!t.hasChildren())return Dl(t);if(n){var r=t.children[il]?e(t.children[il],!1):"",i=[];return gl(t.children,function(t,n){n!==il&&i.push("".concat(n,":").concat(e(t,!1)))}),i.length>0?"".concat(r,"(").concat(i.join("//"),")"):r}var o=El(t,function(n,r){return r===il?[e(t.children[il],!1)]:["".concat(r,":").concat(e(n,!1))]});return"".concat(Dl(t),"/(").concat(o.join("//"),")")}(e.root,!0)),(n=e.queryParams,r=Object.keys(n).map(function(e){var t=n[e];return Array.isArray(t)?t.map(function(t){return"".concat(Rl(e),"=").concat(Rl(t))}).join("&"):"".concat(Rl(e),"=").concat(Rl(t))}),r.length?"?".concat(r.join("&")):"")).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),Al=new Il;function Dl(e){return e.segments.map(function(e){return Ml(e)}).join("/")}function Nl(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Rl(e){return Nl(e).replace(/%3B/gi,";")}function xl(e){return Nl(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ol(e){return decodeURIComponent(e)}function Pl(e){return Ol(e.replace(/\+/g,"%20"))}function Ml(e){return"".concat(xl(e.path)).concat((t=e.parameters,Object.keys(t).map(function(e){return";".concat(xl(e),"=").concat(xl(t[e]))}).join("")));var t}var Ll=/^[^\/()?;=#]+/;function Vl(e){var t=e.match(Ll);return t?t[0]:""}var Fl=/^[^=?&#]+/,Ul=/^[^?&#]+/,ql=function(){function e(t){_classCallCheck(this,e),this.url=t,this.remaining=t}return _createClass(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Cl([],{}):new Cl([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[il]=new Cl(e,t)),n}},{key:"parseSegment",value:function(){var e=Vl(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new kl(Ol(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=Vl(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=Vl(this.remaining);r&&this.capture(n=r)}e[Ol(t)]=Ol(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(Fl);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(Ul);return t?t[0]:""}(this.remaining);r&&this.capture(n=r)}var i=Pl(t),o=Pl(n);if(e.hasOwnProperty(i)){var a=e[i];Array.isArray(a)||(e[i]=a=[a]),a.push(o)}else e[i]=o}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=Vl(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=il);var o=this.parseChildren();t[i]=1===Object.keys(o).length?o[il]:new Cl([],o),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),Bl=function(){function e(t){_classCallCheck(this,e),this._root=t}return _createClass(e,[{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=jl(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=jl(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=zl(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return zl(e,this._root).map(function(e){return e.value})}},{key:"root",get:function(){return this._root.value}}]),e}();function jl(e,t){if(e===t.value)return t;var n=!0,r=!1,i=void 0;try{for(var o,a=t.children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=jl(e,o.value);if(s)return s}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return null}function zl(e,t){if(e===t.value)return[t];var n=!0,r=!1,i=void 0;try{for(var o,a=t.children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=zl(e,o.value);if(s.length)return s.unshift(t),s}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return[]}var Ql=function(){function e(t,n){_classCallCheck(this,e),this.value=t,this.children=n}return _createClass(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function Hl(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var Wl=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).snapshot=n,Xl(_assertThisInitialized(r),e),r}return _inherits(t,Bl),_createClass(t,[{key:"toString",value:function(){return this.snapshot.toString()}}]),t}();function Gl(e,t){var n=function(e,t){var n=new Zl([],{},{},"",{},il,t,null,e.root,-1,{});return new Jl("",new Ql(n,[]))}(e,t),r=new zs([new kl("",{})]),i=new zs({}),o=new zs({}),a=new zs({}),s=new zs(""),u=new Kl(r,i,a,s,o,il,t,n.root);return u.snapshot=n.root,new Wl(new Ql(u,[]),n)}var Kl=function(){function e(t,n,r,i,o,a,s,u){_classCallCheck(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=s,this._futureSnapshot=u}return _createClass(e,[{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}},{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(Q(function(e){return al(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Q(function(e){return al(e)}))),this._queryParamMap}}]),e}();function Yl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],o=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(o.component)break;r--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign({},e.params,t.params),data:Object.assign({},e.data,t.data),resolve:Object.assign({},e.resolve,t._resolvedData)}},{params:{},data:{},resolve:{}})}(n.slice(r))}var Zl=function(){function e(t,n,r,i,o,a,s,u,c,l,h){_classCallCheck(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=h}return _createClass(e,[{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=al(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=al(this.queryParams)),this._queryParamMap}}]),e}(),Jl=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n))).url=e,Xl(_assertThisInitialized(r),n),r}return _inherits(t,Bl),_createClass(t,[{key:"toString",value:function(){return $l(this._root)}}]),t}();function Xl(e,t){t.value._routerState=e,t.children.forEach(function(t){return Xl(e,t)})}function $l(e){var t=e.children.length>0?" { ".concat(e.children.map($l).join(", ")," } "):"";return"".concat(e.value).concat(t)}function eh(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,yl(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),yl(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!yl(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),yl(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function th(e,t){var n,r;return yl(e.params,t.params)&&Sl(n=e.url,r=t.url)&&n.every(function(e,t){return yl(e.parameters,r[t].parameters)})&&!(!e.parent!=!t.parent)&&(!e.parent||th(e.parent,t.parent))}function nh(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function rh(e,t,n,r,i){var o={};return r&&gl(r,function(e,t){o[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new wl(n.root===e?t:function e(t,n,r){var i={};return gl(t.children,function(t,o){i[o]=t===n?r:e(t,n,r)}),new Cl(t.segments,i)}(n.root,e,t),o,i)}var ih=function(){function e(t,n,r){if(_classCallCheck(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&nh(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find(function(e){return"object"==typeof e&&null!=e&&e.outlets});if(i&&i!==ml(r))throw new Error("{outlets:{}} has to be the last command")}return _createClass(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),oh=function e(t,n,r){_classCallCheck(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r};function ah(e){return"object"==typeof e&&null!=e&&e.outlets?e.outlets[il]:"".concat(e)}function sh(e,t,n){if(e||(e=new Cl([],{})),0===e.segments.length&&e.hasChildren())return uh(e,t,n);var r=function(e,t,n){for(var r=0,i=t,o={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return o;var a=e.segments[i],s=ah(n[r]),u=r<n.length-1?n[r+1]:null;if(i>0&&void 0===s)break;if(s&&u&&"object"==typeof u&&void 0===u.outlets){if(!fh(s,u,a))return o;r+=2}else{if(!fh(s,{},a))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var o=new Cl(e.segments.slice(0,r.pathIndex),{});return o.children[il]=new Cl(e.segments.slice(r.pathIndex),e.children),uh(o,0,i)}return r.match&&0===i.length?new Cl(e.segments,{}):r.match&&!e.hasChildren()?ch(e,t,n):r.match?uh(e,0,i):ch(e,t,n)}function uh(e,t,n){if(0===n.length)return new Cl(e.segments,{});var r=function(e){return"object"!=typeof e[0]?_defineProperty({},il,e):void 0===e[0].outlets?_defineProperty({},il,e):e[0].outlets}(n),i={};return gl(r,function(n,r){null!==n&&(i[r]=sh(e.children[r],t,n))}),gl(e.children,function(e,t){void 0===r[t]&&(i[t]=e)}),new Cl(e.segments,i)}function ch(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){if("object"==typeof n[i]&&void 0!==n[i].outlets){var o=lh(n[i].outlets);return new Cl(r,o)}if(0===i&&nh(n[0]))r.push(new kl(e.segments[t].path,n[0])),i++;else{var a=ah(n[i]),s=i<n.length-1?n[i+1]:null;a&&s&&nh(s)?(r.push(new kl(a,hh(s))),i+=2):(r.push(new kl(a,{})),i++)}}return new Cl(r,{})}function lh(e){var t={};return gl(e,function(e,n){null!==e&&(t[n]=ch(new Cl([],{}),0,e))}),t}function hh(e){var t={};return gl(e,function(e,n){return t[n]="".concat(e)}),t}function fh(e,t,n){return e==n.path&&yl(t,n.parameters)}var dh=function(){function e(t,n,r,i){_classCallCheck(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return _createClass(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),eh(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=Hl(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),gl(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){var n=this,r=t.getContext(e.value.outlet);if(r){var i=Hl(e),o=e.value.component?r.children:t;gl(i,function(e,t){return n.deactivateRouteAndItsChildren(e,o)}),r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated())}}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=Hl(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new tl(e.value.snapshot))}),e.children.length&&this.forwardEvent(new $c(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(eh(r),r===i)if(r.component){var o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var a=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),a.children.onOutletReAttached(s.contexts),a.attachRef=s.componentRef,a.route=s.route.value,a.outlet&&a.outlet.attach(s.componentRef,s.route.value),ph(s.route)}else{var u=function(e){for(var t=r.snapshot.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(),c=u?u.module.componentFactoryResolver:null;a.attachRef=null,a.route=r,a.resolver=c,a.outlet&&a.outlet.activateWith(r,c),this.activateChildRoutes(e,null,a.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function ph(e){eh(e.value),e.children.forEach(ph)}function yh(e){return"function"==typeof e}function vh(e){return e instanceof wl}var mh=function e(t){_classCallCheck(this,e),this.segmentGroup=t||null},gh=function e(t){_classCallCheck(this,e),this.urlTree=t};function _h(e){return new k(function(t){return t.error(new mh(e))})}function bh(e){return new k(function(t){return t.error(new gh(e))})}function wh(e){return new k(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var Ch=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=o,this.allowRedirects=!0,this.ngModule=t.get(Be)}return _createClass(e,[{key:"apply",value:function(){var e=this;return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,il).pipe(Q(function(t){return e.createUrlTree(t,e.urlTree.queryParams,e.urlTree.fragment)})).pipe(du(function(t){if(t instanceof gh)return e.allowRedirects=!1,e.match(t.urlTree);if(t instanceof mh)throw e.noMatchError(t);throw t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,il).pipe(Q(function(n){return t.createUrlTree(n,e.queryParams,e.fragment)})).pipe(du(function(e){if(e instanceof mh)throw t.noMatchError(e);throw e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new Cl([],_defineProperty({},il,e)):e;return new wl(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(Q(function(e){return new Cl([],e)})):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){var r=this;return function(n,i){if(0===Object.keys(n).length)return js({});var o=[],a=[],s={};return gl(n,function(n,i){var u,c,l=(u=i,c=n,r.expandSegmentGroup(e,t,c,u)).pipe(Q(function(e){return s[i]=e}));i===il?o.push(l):a.push(l)}),js.apply(null,o.concat(a)).pipe(Zs(),fu(),Q(function(){return s}))}(n.children)}},{key:"expandSegment",value:function(e,t,n,r,i,o){var a=this;return js.apply(void 0,_toConsumableArray(n)).pipe(Q(function(s){return a.expandSegmentAgainstRoute(e,t,n,s,r,i,o).pipe(du(function(e){if(e instanceof mh)return js(null);throw e}))}),Zs(),_u(function(e){return!!e}),du(function(e,n){if(e instanceof Hs||"EmptyError"===e.name){if(a.noLeftoversInUrl(t,r,i))return js(new Cl([],{}));throw new mh(t)}throw e}))}},{key:"noLeftoversInUrl",value:function(e,t,n){return 0===t.length&&!e.children[n]}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,o,a){return Th(r)!==o?_h(t):void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,o):_h(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,o)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,o=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?bh(o):this.lineralizeSegments(n,o).pipe(Y(function(n){var o=new Cl(n,{});return i.expandSegment(e,o,t,n,r,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,o){var a=this,s=kh(t,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,h=s.positionalParamSegments;if(!u)return _h(t);var f=this.applyRedirectCommands(c,r.redirectTo,h);return r.redirectTo.startsWith("/")?bh(f):this.lineralizeSegments(r,f).pipe(Y(function(r){return a.expandSegment(e,t,n,r.concat(i.slice(l)),o,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r){var i=this;if("**"===n.path)return n.loadChildren?this.configLoader.load(e.injector,n).pipe(Q(function(e){return n._loadedConfig=e,new Cl(r,{})})):js(new Cl(r,{}));var o=kh(t,n,r),a=o.matched,s=o.consumedSegments,u=o.lastChild;if(!a)return _h(t);var c=r.slice(u);return this.getChildConfig(e,n,r).pipe(Y(function(e){var n=e.module,r=e.routes,o=function(e,t,n,r){return n.length>0&&function(e,t,n){return r.some(function(n){return Eh(e,t,n)&&Th(n)!==il})}(e,n)?{segmentGroup:Sh(new Cl(t,function(e,t){var n={};n[il]=t;var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;""===u.path&&Th(u)!==il&&(n[Th(u)]=new Cl([],{}))}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(r,new Cl(n,e.children)))),slicedSegments:[]}:0===n.length&&function(e,t,n){return r.some(function(n){return Eh(e,t,n)})}(e,n)?{segmentGroup:Sh(new Cl(e.segments,function(e,t,n,r){var i={},o=!0,a=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;Eh(e,t,l)&&!r[Th(l)]&&(i[Th(l)]=new Cl([],{}))}}catch(h){a=!0,s=h}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return Object.assign({},r,i)}(e,n,r,e.children))),slicedSegments:n}:{segmentGroup:e,slicedSegments:n}}(t,s,c,r),a=o.segmentGroup,u=o.slicedSegments;return 0===u.length&&a.hasChildren()?i.expandChildren(n,r,a).pipe(Q(function(e){return new Cl(s,e)})):0===r.length&&0===u.length?js(new Cl(s,{})):i.expandSegment(n,a,r,u,il,!0).pipe(Q(function(e){return new Cl(s.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?js(new ll(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?js(t._loadedConfig):function(e,t,n){var r,i=t.canLoad;return i&&0!==i.length?K(i).pipe(Q(function(r){var i,o=e.get(r);if(function(e){return e&&yh(e.canLoad)}(o))i=o.canLoad(t,n);else{if(!yh(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return _l(i)})).pipe(Zs(),(r=function(e){return!0===e},function(e){return e.lift(new bu(r,void 0,e))})):js(!0)}(e.injector,t,n).pipe(Y(function(n){return n?r.configLoader.load(e.injector,t).pipe(Q(function(e){return t._loadedConfig=e,e})):function(e){return new k(function(t){return t.error(ul("Cannot load children because the guard of the route \"path: '".concat(e.path,"'\" returned false")))})}(t)})):js(new ll([],e))}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return js(n);if(r.numberOfChildren>1||!r.children[il])return wh(e.redirectTo);r=r.children[il]}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new wl(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return gl(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,o=this.createSegments(e,t.segments,n,r),a={};return gl(t.children,function(t,o){a[o]=i.createSegmentGroup(e,t,n,r)}),new Cl(o,a)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n=0,r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u.path===e.path)return t.splice(n),u;n++}}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return e}}]),e}();function kh(e,t,n){if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};var r=(t.matcher||cl)(n,e,t);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function Sh(e){if(1===e.numberOfChildren&&e.children[il]){var t=e.children[il];return new Cl(e.segments.concat(t.segments),t.children)}return e}function Eh(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function Th(e){return e.outlet||il}var Ih=function e(t){_classCallCheck(this,e),this.path=t,this.route=this.path[this.path.length-1]},Ah=function e(t,n){_classCallCheck(this,e),this.component=t,this.route=n};function Dh(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function Nh(e,t,n){var r=Hl(e),i=e.value;gl(r,function(e,r){Nh(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new Ah(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var Rh=Symbol("INITIAL_VALUE");function xh(){return Cu(function(e){return(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=null,i=null;return x(t[t.length-1])&&(i=t.pop()),"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&u(t[0])&&(t=t[0]),G(t,i).lift(new Gs(r))}).apply(void 0,_toConsumableArray(e.map(function(e){return e.pipe(vu(1),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var n=t[t.length-1];x(n)?t.pop():n=null;var r=t.length;return function(){return Zs()(js.apply(void 0,arguments))}(1!==r||n?r>0?G(t,n):qs(n):Bs(t[0]),e)}}(Rh))}))).pipe(Eu(function(e,t){var n=!1;return t.reduce(function(e,r,i){if(e!==Rh)return e;if(r===Rh&&(n=!0),!n){if(!1===r)return r;if(i===t.length-1||vh(r))return r}return e},e)},Rh),Js(function(e){return e!==Rh}),Q(function(e){return vh(e)?e:!0===e}),vu(1))})}function Oh(e,t){return null!==e&&t&&t(new el(e)),js(!0)}function Ph(e,t){return null!==e&&t&&t(new Xc(e)),js(!0)}function Mh(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;return r&&0!==r.length?js(r.map(function(r){return Ys(function(){var i,o=Dh(r,t,n);if(function(e){return e&&yh(e.canActivate)}(o))i=_l(o.canActivate(t,e));else{if(!yh(o))throw new Error("Invalid CanActivate guard");i=_l(o(t,e))}return i.pipe(_u())})})).pipe(xh()):js(!0)}function Lh(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return Ys(function(){return js(t.guards.map(function(i){var o,a=Dh(i,t.node,n);if(function(e){return e&&yh(e.canActivateChild)}(a))o=_l(a.canActivateChild(r,e));else{if(!yh(a))throw new Error("Invalid CanActivateChild guard");o=_l(a(r,e))}return o.pipe(_u())})).pipe(xh())})});return js(i).pipe(xh())}var Vh=function e(){_classCallCheck(this,e)},Fh=function(){function e(t,n,r,i,o,a){_classCallCheck(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=a}return _createClass(e,[{key:"recognize",value:function(){try{var e=Bh(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,il),n=new Zl([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},il,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Ql(n,t),i=new Jl(this.url,r);return this.inheritParamsAndData(i._root),js(i)}catch(o){return new k(function(e){return e.error(o)})}}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=Yl(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){var n,r=this,i=El(t,function(t,n){return r.processSegmentGroup(e,t,n)});return n={},i.forEach(function(e){var t=n[e.value.outlet];if(t){var r=t.url.map(function(e){return e.toString()}).join("/"),i=e.value.url.map(function(e){return e.toString()}).join("/");throw new Error("Two segments cannot have the same outlet name: '".concat(r,"' and '").concat(i,"'."))}n[e.value.outlet]=e.value}),i.sort(function(e,t){return e.value.outlet===il?-1:t.value.outlet===il?1:e.value.outlet.localeCompare(t.value.outlet)}),i}},{key:"processSegment",value:function(e,t,n,r){var i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;try{return this.processSegmentAgainstRoute(c,t,n,r)}catch(l){if(!(l instanceof Vh))throw l}}}catch(h){o=!0,a=h}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}if(this.noLeftoversInUrl(t,n,r))return[];throw new Vh}},{key:"noLeftoversInUrl",value:function(e,t,n){return 0===t.length&&!e.children[n]}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo)throw new Vh;if((e.outlet||il)!==r)throw new Vh;var i,o=[],a=[];if("**"===e.path){var s=n.length>0?ml(n).parameters:{};i=new Zl(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Qh(e),r,e.component,e,Uh(t),qh(t)+n.length,Hh(e))}else{var u=function(e,t,n){if(""===t.path){if("full"===t.pathMatch&&(e.hasChildren()||n.length>0))throw new Vh;return{consumedSegments:[],lastChild:0,parameters:{}}}var r=(t.matcher||cl)(n,e,t);if(!r)throw new Vh;var i={};gl(r.posParams,function(e,t){i[t]=e.path});var o=r.consumed.length>0?Object.assign({},i,r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o}}(t,e,n);o=u.consumedSegments,a=n.slice(u.lastChild),i=new Zl(o,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Qh(e),r,e.component,e,Uh(t),qh(t)+o.length,Hh(e))}var c=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),l=Bh(t,o,a,c,this.relativeLinkResolution),h=l.segmentGroup,f=l.slicedSegments;if(0===f.length&&h.hasChildren()){var d=this.processChildren(c,h);return[new Ql(i,d)]}if(0===c.length&&0===f.length)return[new Ql(i,[])];var p=this.processSegment(c,h,f,il);return[new Ql(i,p)]}}]),e}();function Uh(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function qh(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function Bh(e,t,n,r,i){if(n.length>0&&function(e,t,n){return r.some(function(n){return jh(e,t,n)&&zh(n)!==il})}(e,n)){var o=new Cl(t,function(e,t,n,r){var i={};i[il]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var o=!0,a=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;if(""===l.path&&zh(l)!==il){var h=new Cl([],{});h._sourceSegment=e,h._segmentIndexShift=t.length,i[zh(l)]=h}}}catch(f){a=!0,s=f}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return i}(e,t,r,new Cl(n,e.children)));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return r.some(function(n){return jh(e,t,n)})}(e,n)){var a=new Cl(e.segments,function(e,t,n,r,i,o){var a={},s=!0,u=!1,c=void 0;try{for(var l,h=r[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;if(jh(e,n,f)&&!i[zh(f)]){var d=new Cl([],{});d._sourceSegment=e,d._segmentIndexShift="legacy"===o?e.segments.length:t.length,a[zh(f)]=d}}}catch(p){u=!0,c=p}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}return Object.assign({},i,a)}(e,t,n,r,e.children,i));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:n}}var s=new Cl(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function jh(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function zh(e){return e.outlet||il}function Qh(e){return e.data||{}}function Hh(e){return e.resolve||{}}function Wh(e,t,n,r){var i=Dh(e,t,r);return _l(i.resolve?i.resolve(t,n):i(t,n))}function Gh(e){return function(t){return t.pipe(Cu(function(t){var n=e(t);return n?K(n).pipe(Q(function(){return t})):K([t])}))}}var Kh=function e(){_classCallCheck(this,e)},Yh=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}(),Zh=new De("ROUTES"),Jh=function(){function e(t,n,r,i){_classCallCheck(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return _createClass(e,[{key:"load",value:function(e,t){var n=this;return this.onLoadStartListener&&this.onLoadStartListener(t),this.loadModuleFactory(t.loadChildren).pipe(Q(function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new ll(vl(i.injector.get(Zh)).map(pl),i)}))}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?K(this.loader.load(e)):_l(e()).pipe(Y(function(e){return e instanceof je?js(e):K(t.compiler.compileModuleAsync(e))}))}}]),e}(),Xh=function e(){_classCallCheck(this,e)},$h=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function ef(e){throw e}function tf(e,t,n){return t.parse("/")}function nf(e,t){return js(null)}var rf=function(){function e(t,n,r,i,o,a,s,u){var c=this;_classCallCheck(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new N,this.errorHandler=ef,this.malformedUriErrorHandler=tf,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:nf,afterPreactivation:nf},this.urlHandlingStrategy=new $h,this.routeReuseStrategy=new Yh,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=o.get(Be),this.console=o.get(Fi);var l=o.get(no);this.isNgZoneEnabled=l instanceof no,this.resetConfig(u),this.currentUrlTree=new wl(new Cl([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Jh(a,s,function(e){return c.triggerEvent(new Zc(e))},function(e){return c.triggerEvent(new Jc(e))}),this.routerState=Gl(this.currentUrlTree,this.rootComponentType),this.transitions=new zs({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return _createClass(e,[{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(Js(function(e){return 0!==e.id}),Q(function(e){return Object.assign({},e,{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),Cu(function(e){var r,i,o,a=!1,s=!1;return js(e).pipe(ou(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign({},t.lastSuccessfulNavigation,{previousNavigation:null}):null}}),Cu(function(e){var r,i,o,a,s=!t.navigated||e.extractedUrl.toString()!==t.browserUrlTree.toString();if(("reload"===t.onSameUrlNavigation||s)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return js(e).pipe(Cu(function(e){var r=t.transitions.getValue();return n.next(new Bc(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?Us:[e]}),Cu(function(e){return Promise.resolve(e)}),(r=t.ngModule.injector,i=t.configLoader,o=t.urlSerializer,a=t.config,function(e){return e.pipe(Cu(function(e){return function(t,n,r,i,o){return new Ch(t,n,r,e.extractedUrl,o).apply()}(r,i,o,0,a).pipe(Q(function(t){return Object.assign({},e,{urlAfterRedirects:t})}))}))}),ou(function(e){t.currentNavigation=Object.assign({},t.currentNavigation,{finalUrl:e.urlAfterRedirects})}),function(e,n,r,i,o){return function(r){return r.pipe(Y(function(r){return function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";return new Fh(e,t,n,r,i,o).recognize()}(e,n,r.urlAfterRedirects,(a=r.urlAfterRedirects,t.serializeUrl(a)),i,o).pipe(Q(function(e){return Object.assign({},r,{targetSnapshot:e})}));var a}))}}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),ou(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)}),ou(function(e){var r=new Hc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)}));if(s&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var u=e.id,c=e.extractedUrl,l=e.source,h=e.restoredState,f=e.extras,d=new Bc(u,t.serializeUrl(c),l,h);n.next(d);var p=Gl(c,t.rootComponentType).snapshot;return js(Object.assign({},e,{targetSnapshot:p,urlAfterRedirects:c,extras:Object.assign({},f,{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),Us}),Gh(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,o=e.rawUrl,a=e.extras,s=a.skipLocationChange,u=a.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:o,skipLocationChange:!!s,replaceUrl:!!u})}),ou(function(e){var n=new Wc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),Q(function(e){return Object.assign({},e,{guards:(n=e.targetSnapshot,r=e.currentSnapshot,i=t.rootContexts,o=n._root,function e(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=Hl(n);return t.children.forEach(function(t){!function(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=t.value,s=n?n.value:null,u=r?r.getContext(t.value.outlet):null;if(s&&a.routeConfig===s.routeConfig){var c=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!Sl(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Sl(e.url,t.url)||!yl(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!th(e,t)||!yl(e.queryParams,t.queryParams);case"paramsChange":default:return!th(e,t)}}(s,a,a.routeConfig.runGuardsAndResolvers);c?o.canActivateChecks.push(new Ih(i)):(a.data=s.data,a._resolvedData=s._resolvedData),e(t,n,a.component?u?u.children:null:r,i,o),c&&o.canDeactivateChecks.push(new Ah(u&&u.outlet&&u.outlet.component||null,s))}else s&&Nh(n,u,o),o.canActivateChecks.push(new Ih(i)),e(t,null,a.component?u?u.children:null:r,i,o)}(t,a[t.value.outlet],r,i.concat([t.value]),o),delete a[t.value.outlet]}),gl(a,function(e,t){return Nh(e,r.getContext(t),o)}),o}(o,r?r._root:null,i,[o.value]))});var n,r,i,o}),(i=t.ngModule.injector,o=function(e){return t.triggerEvent(e)},function(e){return e.pipe(Y(function(e){var t=e.targetSnapshot,n=e.currentSnapshot,r=e.guards,a=r.canActivateChecks,s=r.canDeactivateChecks;return 0===s.length&&0===a.length?js(Object.assign({},e,{guardsResult:!0})):function(e,t,n,r){return K(s).pipe(Y(function(e){return function(e,t,n,r,i){var o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return o&&0!==o.length?js(o.map(function(o){var a,s=Dh(o,t,i);if(function(e){return e&&yh(e.canDeactivate)}(s))a=_l(s.canDeactivate(e,t,n,r));else{if(!yh(s))throw new Error("Invalid CanDeactivate guard");a=_l(s(e,t,n,r))}return a.pipe(_u())})).pipe(xh()):js(!0)}(e.component,e.route,n,t,r)}),_u(function(e){return!0!==e},!0))}(0,t,n,i).pipe(Y(function(e){return e&&"boolean"==typeof e?function(e,t,n,r){return K(a).pipe(Au(function(t){return K([Ph(t.route.parent,r),Oh(t.route,r),Lh(e,t.path,n),Mh(e,t.route,n)]).pipe(Zs(),_u(function(e){return!0!==e},!0))}),_u(function(e){return!0!==e},!0))}(t,0,i,o):js(e)}),Q(function(t){return Object.assign({},e,{guardsResult:t})}))}))}),ou(function(e){if(vh(e.guardsResult)){var n=ul('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}}),ou(function(e){var n=new Gc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(n)}),Js(function(e){if(!e.guardsResult){t.resetUrlToCurrentUrlTree();var r=new zc(e.id,t.serializeUrl(e.extractedUrl),"");return n.next(r),e.resolve(!1),!1}return!0}),Gh(function(e){if(e.guards.canActivateChecks.length)return js(e).pipe(ou(function(e){var n=new Kc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),function(e,t){return function(n){return n.pipe(Y(function(n){var r=n.targetSnapshot,i=n.guards.canActivateChecks;return i.length?K(i).pipe(Au(function(n){return function(e,t,n,i){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return js({});if(1===i.length){var o=i[0];return Wh(e[o],t,n,r).pipe(Q(function(e){return _defineProperty({},o,e)}))}var a={};return K(i).pipe(Y(function(i){return Wh(e[i],t,n,r).pipe(Q(function(e){return a[i]=e,e}))})).pipe(fu(),Q(function(){return a}))}(e._resolve,e,r,i).pipe(Q(function(t){return e._resolvedData=t,e.data=Object.assign({},e.data,Yl(e,n).resolve),null}))}(n.route,0,e,t)}),function(e,t){return arguments.length>=2?function(n){return b(Eu(e,t),nu(1),cu(t))(n)}:function(t){return b(Eu(function(t,n,r){return e(t,n,r+1)}),nu(1))(t)}}(function(e,t){return e}),Q(function(e){return n})):js(n)}))}}(t.paramsInheritanceStrategy,t.ngModule.injector),ou(function(e){var n=new Yc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}))}),Gh(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,o=e.rawUrl,a=e.extras,s=a.skipLocationChange,u=a.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:o,skipLocationChange:!!s,replaceUrl:!!u})}),Q(function(e){var n,r,i,o,a=(n=t.routeReuseStrategy,r=e.targetSnapshot,i=e.currentRouterState,o=function e(t,n,r){if(r&&t.shouldReuseRoute(n.value,r.value.snapshot)){var i=r.value;i._futureSnapshot=n.value;var o=function(t,n,r){return n.children.map(function(n){var i=!0,o=!1,a=void 0;try{for(var s,u=r.children[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;if(t.shouldReuseRoute(c.value.snapshot,n.value))return e(t,n,c)}}catch(l){o=!0,a=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return e(t,n)})}(t,n,r);return new Ql(i,o)}var a=t.retrieve(n.value);if(a){var s=a.route;return function e(t,n){if(t.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=t.value;for(var r=0;r<t.children.length;++r)e(t.children[r],n.children[r])}(n,s),s}var u,c=new Kl(new zs((u=n.value).url),new zs(u.params),new zs(u.queryParams),new zs(u.fragment),new zs(u.data),u.outlet,u.component,u),l=n.children.map(function(n){return e(t,n)});return new Ql(c,l)}(n,r._root,i?i._root:void 0),new Wl(o,r));return Object.assign({},e,{targetRouterState:a})}),ou(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(t.currentUrlTree,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)}),function(e,t,n){return Q(function(r){return new dh(t,r.targetRouterState,r.currentRouterState,n).activate(e),r})}(t.rootContexts,t.routeReuseStrategy,function(e){return t.triggerEvent(e)}),ou({next:function(){a=!0},complete:function(){a=!0}}),(r=function(){if(!a&&!s){t.resetUrlToCurrentUrlTree();var r=new zc(e.id,t.serializeUrl(e.extractedUrl),"Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId));n.next(r),e.resolve(!1)}t.currentNavigation=null},function(e){return e.lift(new Du(r))}),du(function(r){if(s=!0,r&&r[sl]){var i=vh(r.url);i||(t.navigated=!0,t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl));var o=new zc(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),e.resolve(!1),i&&t.navigateByUrl(r.url)}else{t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl);var a=new Qc(e.id,t.serializeUrl(e.extractedUrl),r);n.next(a);try{e.resolve(t.errorHandler(r))}catch(u){e.reject(u)}}return Us}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign({},this.getTransition(),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var n=e.parseUrl(t.url),r="popstate"===t.type?"popstate":"hashchange",i=t.state&&t.state.navigationId?t.state:null;setTimeout(function(){e.scheduleNavigation(n,r,i,{replaceUrl:!0})},0)}))}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){hl(e),this.config=e.map(pl),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,o=t.preserveQueryParams,a=t.queryParamsHandling,s=t.preserveFragment;nt()&&o&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");var u=n||this.routerState.root,c=s?this.currentUrlTree.fragment:i,l=null;if(a)switch(a){case"merge":l=Object.assign({},this.currentUrlTree.queryParams,r);break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=r||null}else l=o?this.currentUrlTree.queryParams:r||null;return null!==l&&(l=this.removeEmptyProps(l)),function(e,t,n,r,i){if(0===n.length)return rh(t.root,t.root,t,r,i);var o=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new ih(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var o={};return gl(r.outlets,function(e,t){o[t]="string"==typeof e?e.split("/"):e}),[].concat(_toConsumableArray(e),[{outlets:o}])}if(r.segmentPath)return[].concat(_toConsumableArray(e),[r.segmentPath])}return"string"!=typeof r?[].concat(_toConsumableArray(e),[r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[].concat(_toConsumableArray(e),[r])},[]);return new ih(n,t,r)}(n);if(o.toRoot())return rh(t.root,new Cl([],{}),t,r,i);var a=function(e,n,r){if(e.isAbsolute)return new oh(t.root,!0,0);if(-1===r.snapshot._lastPathIndex)return new oh(r.snapshot._urlSegment,!0,0);var i=nh(e.commands[0])?0:1;return function(t,n,o){for(var a=r.snapshot._urlSegment,s=r.snapshot._lastPathIndex+i,u=e.numberOfDoubleDots;u>s;){if(u-=s,!(a=a.parent))throw new Error("Invalid number of '../'");s=a.segments.length}return new oh(a,!1,s-u)}()}(o,0,e),s=a.processChildren?uh(a.segmentGroup,a.index,o.commands):sh(a.segmentGroup,a.index,o.commands);return rh(a.segmentGroup,s,t,r,i)}(u,this.currentUrlTree,e,l,c)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};nt()&&this.isNgZoneEnabled&&!no.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");var n=vh(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){if(vh(e))return bl(this.currentUrlTree,e,t);var n=this.parseUrl(e);return bl(this.currentUrlTree,n,t)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!=r&&(t[n]=r),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.events.next(new jc(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,e.currentNavigation=null,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ")})}},{key:"scheduleNavigation",value:function(e,t,n,r){var i=this.getTransition();if(i&&"imperative"!==t&&"imperative"===i.source&&i.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(i&&"hashchange"==t&&"popstate"===i.source&&i.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(i&&"popstate"==t&&"hashchange"===i.source&&i.rawUrl.toString()===e.toString())return Promise.resolve(!0);var o=null,a=null,s=new Promise(function(e,t){o=e,a=t}),u=++this.navigationId;return this.setTransition({id:u,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:o,reject:a,promise:s,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),s.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t,n,r){var i=this.urlSerializer.serialize(e);r=r||{},this.location.isCurrentPathEqualTo(i)||t?this.location.replaceState(i,"",Object.assign({},r,{navigationId:n})):this.location.go(i,"",Object.assign({},r,{navigationId:n}))}},{key:"resetStateAndUrl",value:function(e,t,n){this.routerState=e,this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}}]),e}(),of=function(){function e(t,n,r){var i=this;_classCallCheck(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.subscription=t.events.subscribe(function(e){e instanceof jc&&i.updateTargetUrlAndHref()})}return _createClass(e,[{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref()}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r){if(0!==e||t||n||r)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;var i={skipLocationChange:af(this.skipLocationChange),replaceUrl:af(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,i),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"preserveQueryParams",set:function(e){nt()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead."),this.preserve=e}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:af(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:af(this.preserveFragment)})}}]),e}();function af(e){return""===e||!!e}var sf=function e(){_classCallCheck(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new uf,this.attachRef=null},uf=function(){function e(){_classCallCheck(this,e),this.contexts=new Map}return _createClass(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new sf,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),cf=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new Ii,this.deactivateEvents=new Ii,this.name=i||il,t.onChildOutletCreated(this.name,this)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new lf(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}}]),e}(),lf=function(){function e(t,n,r){_classCallCheck(this,e),this.route=t,this.childContexts=n,this.parent=r}return _createClass(e,[{key:"get",value:function(e,t){return e===Kl?this.route:e===uf?this.childContexts:this.parent.get(e,t)}}]),e}(),hf=function e(){_classCallCheck(this,e)},ff=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"preload",value:function(e,t){return t().pipe(du(function(){return js(null)}))}}]),e}(),df=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"preload",value:function(e,t){return js(null)}}]),e}(),pf=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.router=t,this.injector=i,this.preloadingStrategy=o,this.loader=new Jh(n,r,function(e){return t.triggerEvent(new Zc(e))},function(e){return t.triggerEvent(new Jc(e))})}return _createClass(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(Js(function(e){return e instanceof jc}),Au(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(Be);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u.loadChildren&&!u.canLoad&&u._loadedConfig){var c=u._loadedConfig;n.push(this.processRoutes(c.module,c.routes))}else u.loadChildren&&!u.canLoad?n.push(this.preloadConfig(e,u)):u.children&&n.push(this.processRoutes(e,u.children))}}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return K(n).pipe($(),Q(function(e){}))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){return n.loader.load(e.injector,t).pipe(Y(function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)}))})}}]),e}(),yf=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return _createClass(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof Bc?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof jc&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof nl&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new nl(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}(),vf=new De("ROUTER_CONFIGURATION"),mf=new De("ROUTER_FORROOT_GUARD"),gf=[ps,{provide:Tl,useClass:Il},{provide:rf,useFactory:Ef,deps:[Co,Tl,uf,ps,Pt,So,Ki,Zh,vf,[Xh,new he],[Kh,new he]]},uf,{provide:Kl,useFactory:Tf,deps:[rf]},{provide:So,useClass:Io},pf,df,ff,{provide:vf,useValue:{enableTracing:!1}}];function _f(){return new vo("Router",rf)}var bf=function(){function e(t,n){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[gf,Sf(t),{provide:mf,useFactory:kf,deps:[[rf,new he,new de]]},{provide:vf,useValue:n||{}},{provide:fs,useFactory:Cf,deps:[ls,[new le(ds),new he],vf]},{provide:yf,useFactory:wf,deps:[rf,Vs,vf]},{provide:hf,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:df},{provide:vo,multi:!0,useFactory:_f},[If,{provide:Ni,multi:!0,useFactory:Af,deps:[If]},{provide:Nf,useFactory:Df,deps:[If]},{provide:Vi,multi:!0,useExisting:Nf}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[Sf(t)]}}}]),e}();function wf(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new yf(e,t,n)}function Cf(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).useHash?new vs(e,t):new ms(e,t)}function kf(e){if(e)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Sf(e){return[{provide:jt,multi:!0,useValue:e},{provide:Zh,multi:!0,useValue:e}]}function Ef(e,t,n,r,i,o,a,s){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:{},c=arguments.length>9?arguments[9]:void 0,l=arguments.length>10?arguments[10]:void 0,h=new rf(null,t,n,r,i,o,a,vl(s));if(c&&(h.urlHandlingStrategy=c),l&&(h.routeReuseStrategy=l),u.errorHandler&&(h.errorHandler=u.errorHandler),u.malformedUriErrorHandler&&(h.malformedUriErrorHandler=u.malformedUriErrorHandler),u.enableTracing){var f=xu();h.events.subscribe(function(e){f.logGroup("Router Event: ".concat(e.constructor.name)),f.log(e.toString()),f.log(e),f.logGroupEnd()})}return u.onSameUrlNavigation&&(h.onSameUrlNavigation=u.onSameUrlNavigation),u.paramsInheritanceStrategy&&(h.paramsInheritanceStrategy=u.paramsInheritanceStrategy),u.urlUpdateStrategy&&(h.urlUpdateStrategy=u.urlUpdateStrategy),u.relativeLinkResolution&&(h.relativeLinkResolution=u.relativeLinkResolution),h}function Tf(e){return e.routerState.root}var If=function(){function e(t){_classCallCheck(this,e),this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new N}return _createClass(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(hs,Promise.resolve(null)).then(function(){var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(rf),i=e.injector.get(vf);if(e.isLegacyDisabled(i)||e.isLegacyEnabled(i))t(!0);else if("disabled"===i.initialNavigation)r.setUpLocationChangeListener(),t(!0);else{if("enabled"!==i.initialNavigation)throw new Error("Invalid initialNavigation options: '".concat(i.initialNavigation,"'"));r.hooks.afterPreactivation=function(){return e.initNavigation?js(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()}return n})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(vf),n=this.injector.get(pf),r=this.injector.get(yf),i=this.injector.get(rf),o=this.injector.get(Co);e===o.components[0]&&(this.isLegacyEnabled(t)?i.initialNavigation():this.isLegacyDisabled(t)&&i.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),i.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"isLegacyEnabled",value:function(e){return"legacy_enabled"===e.initialNavigation||!0===e.initialNavigation||void 0===e.initialNavigation}},{key:"isLegacyDisabled",value:function(e){return"legacy_disabled"===e.initialNavigation||!1===e.initialNavigation}}]),e}();function Af(e){return e.appInitializer.bind(e)}function Df(e){return e.bootstrapListener.bind(e)}var Nf=new De("Router Initializer"),Rf=Jn({encapsulation:2,styles:[],data:{}});function xf(e){return na(0,[(e()(),jo(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),ii(1,212992,null,0,cf,[uf,On,on,[8,null],Nt],null,null)],function(e,t){e(t,1,0)},null)}var Of=Pr("ng-component",rl,function(e){return na(0,[(e()(),jo(0,0,null,null,1,"ng-component",[],null,null,null,xf,Rf)),ii(1,49152,null,0,rl,[],null,null)],null,null)},{},{},[]),Pf=function(){function e(){_classCallCheck(this,e),this.isLoading=!1}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}(),Mf=Jn({encapsulation:0,styles:[[".relative-container[_ngcontent-%COMP%]{position:relative}.relative-overlay[_ngcontent-%COMP%]{display:flex;align-items:center;background:grey;opacity:.5;position:absolute;left:0;right:0;top:0;bottom:0;z-index:9999}.relative-overlay[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin:0 auto}"]],data:{}});function Lf(e){return na(0,[(e()(),jo(0,0,null,null,1,"div",[["class","relative-overlay"]],null,null,null,null,null)),(e()(),jo(1,0,null,null,0,"i",[["class","fa fa-cog fa-spin fa-2x fa-fw"]],null,null,null,null,null))],null,null)}function Vf(e){return na(0,[(e()(),jo(0,0,null,null,3,"div",[["class","relative-container"]],null,null,null,null,null)),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:8,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:null,childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:null,ngContent:{index:0}},(e()(),Bo(16777216,null,null,1,null,Lf)),ii(3,16384,null,0,Ds,[On,Rn],{ngIf:[0,"ngIf"]},null)],function(e,t){e(t,3,0,t.component.isLoading)},null)}var Ff=function(){function e(t){_classCallCheck(this,e),this.router=t,this.iconSet=["fas fa-adjust","fas fa-brush","fas fa-crop-alt","fas fa-cut","fas fa-edit"],this.widgets=[new Uf("Check Out the To Do List","This list is meant to be a simple tool for taking notes throughout the day as a dev.","fas fa-list-ul","Navigate",this.navigateToDo.bind(this)),new Uf("Test Loading Widget","This is a test widget and there are more to come! Give the button a click for a sample loading animation.",this.getRandomIcon(),"Load Widget",this.testLoading),new Uf("Test 2","This is a test widget and there are more to come!",this.getRandomIcon(),"Load Widget",this.testLoading),new Uf("Test 3","This is a test widget and there are more to come!",this.getRandomIcon(),"Load Widget",this.testLoading),new Uf("Test 4","This is a test widget and there are more to come!",this.getRandomIcon(),"Load Widget",this.testLoading)]}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"testLoading",value:function(e){e.isLoading=!0,setTimeout(function(){e.isLoading=!1},4e3)}},{key:"navigateToDo",value:function(e){this.router.navigate([e.route])}},{key:"getRandomIcon",value:function(){return this.iconSet[Math.floor(Math.random()*this.iconSet.length)]}}]),e}(),Uf=function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Submit",o=arguments.length>4?arguments[4]:void 0;_classCallCheck(this,e),this.isLoading=!1,this.route="todo",this.title=t,this.description=n,this.icon=r,this.buttonText=i,this.callback=o},qf=Jn({encapsulation:0,styles:[[".p15-right[_ngcontent-%COMP%]{padding-right:15px}"]],data:{}});function Bf(e){return na(0,[(e()(),jo(0,0,null,null,15,"div",[["class","form-group col-sm-4"]],null,null,null,null,null)),(e()(),jo(1,0,null,null,14,"app-loading-container",[],null,null,null,Vf,Mf)),ii(2,114688,null,0,Pf,[],{isLoading:[0,"isLoading"]},null),(e()(),jo(3,0,null,0,12,"div",[["class","card"]],null,null,null,null,null)),(e()(),jo(4,0,null,null,5,"div",[["class","card-header"]],null,null,null,null,null)),(e()(),jo(5,0,null,null,4,"h5",[],null,null,null,null,null)),(e()(),jo(6,0,null,null,2,"i",[["class","p15-right"]],null,null,null,null,null)),oi(512,null,Cs,ks,[Tn,In,cn,dn]),ii(8,278528,null,0,Es,[Cs],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(e()(),$o(9,null,[""," "])),(e()(),jo(10,0,null,null,2,"div",[["class","card-body"]],null,null,null,null,null)),(e()(),jo(11,0,null,null,1,"p",[],null,null,null,null,null)),(e()(),$o(12,null,["",""])),(e()(),jo(13,0,null,null,2,"div",[["class","card-footer"]],null,null,null,null,null)),(e()(),jo(14,0,null,null,1,"button",[],null,[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.context.$implicit.callback(e.context.$implicit)&&r),r},null,null)),(e()(),$o(15,null,["",""]))],function(e,t){e(t,2,0,t.context.$implicit.isLoading),e(t,8,0,"p15-right",t.context.$implicit.icon)},function(e,t){e(t,9,0,t.context.$implicit.title),e(t,12,0,t.context.$implicit.description),e(t,15,0,t.context.$implicit.buttonText)})}function jf(e){return na(0,[(e()(),jo(0,0,null,null,1,"h1",[],null,null,null,null,null)),(e()(),$o(-1,null,["Laz's Personal Angular Toolkit"])),(e()(),jo(2,0,null,null,1,"p",[["class","lead"]],null,null,null,null,null)),(e()(),$o(-1,null,[" This page is a demo of various web components I am building.\n"])),(e()(),jo(4,0,null,null,2,"div",[["class","row"]],null,null,null,null,null)),(e()(),Bo(16777216,null,null,1,null,Bf)),ii(6,278528,null,0,Is,[On,Rn,Tn],{ngForOf:[0,"ngForOf"]},null)],function(e,t){e(t,6,0,t.component.widgets)},null)}var zf=Pr("app-homepage",Ff,function(e){return na(0,[(e()(),jo(0,0,null,null,1,"app-homepage",[],null,null,null,jf,qf)),ii(1,114688,null,0,Ff,[rf],null,null)],function(e,t){e(t,1,0)},null)},{},{},[]),Qf=function(e){function t(e,n){var r;_classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).sources=n,r.completed=0,r.haveValues=0;var i=n.length;r.values=new Array(i);for(var o=0;o<i;o++){var a=j(_assertThisInitialized(r),n[o],null,o);a&&r.add(a)}return r}return _inherits(t,z),_createClass(t,[{key:"notifyNext",value:function(e,t,n,r,i){this.values[n]=t,i._hasValue||(i._hasValue=!0,this.haveValues++)}},{key:"notifyComplete",value:function(e){var t=this.destination,n=this.haveValues,r=this.values,i=r.length;e._hasValue?(this.completed++,this.completed===i&&(n===i&&t.next(r),t.complete())):t.complete()}}]),t}(),Hf=new De("NgValueAccessor"),Wf=function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"checked",e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}(),Gf=new De("CompositionEventMode"),Kf=function(){function e(t,n,r){var i;_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._compositionMode=r,this.onChange=function(e){},this.onTouched=function(){},this._composing=!1,null==this._compositionMode&&(this._compositionMode=(i=xu()?xu().getUserAgent():"",!/android (\d+)/.test(i.toLowerCase())))}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),e}(),Yf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}},{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}}]),e}(),Zf=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,Yf),_createClass(t,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),t}();function Jf(){throw new Error("unimplemented")}var Xf=function(e){function t(){var e;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments)))._parent=null,e.name=null,e.valueAccessor=null,e._rawValidators=[],e._rawAsyncValidators=[],e}return _inherits(t,Yf),_createClass(t,[{key:"validator",get:function(){return Jf()}},{key:"asyncValidator",get:function(){return Jf()}}]),t}(),$f=function(){function e(t){_classCallCheck(this,e),this._cd=t}return _createClass(e,[{key:"ngClassUntouched",get:function(){return!!this._cd.control&&this._cd.control.untouched}},{key:"ngClassTouched",get:function(){return!!this._cd.control&&this._cd.control.touched}},{key:"ngClassPristine",get:function(){return!!this._cd.control&&this._cd.control.pristine}},{key:"ngClassDirty",get:function(){return!!this._cd.control&&this._cd.control.dirty}},{key:"ngClassValid",get:function(){return!!this._cd.control&&this._cd.control.valid}},{key:"ngClassInvalid",get:function(){return!!this._cd.control&&this._cd.control.invalid}},{key:"ngClassPending",get:function(){return!!this._cd.control&&this._cd.control.pending}}]),e}(),ed=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))}return _inherits(t,$f),t}();function td(e){return null==e||0===e.length}var nd=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,rd=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"min",value:function(e){return function(t){if(td(t.value)||td(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}},{key:"max",value:function(e){return function(t){if(td(t.value)||td(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}},{key:"required",value:function(e){return td(e.value)?{required:!0}:null}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return td(e.value)?null:nd.test(e.value)?null:{email:!0}}},{key:"minLength",value:function(e){return function(t){if(td(t.value))return null;var n=t.value?t.value.length:0;return n<e?{minlength:{requiredLength:e,actualLength:n}}:null}}},{key:"maxLength",value:function(e){return function(t){var n=t.value?t.value.length:0;return n>e?{maxlength:{requiredLength:e,actualLength:n}}:null}}},{key:"pattern",value:function(t){return t?("string"==typeof t?(r="","^"!==t.charAt(0)&&(r+="^"),r+=t,"$"!==t.charAt(t.length-1)&&(r+="$"),n=new RegExp(r)):(r=t.toString(),n=t),function(e){if(td(e.value))return null;var t=e.value;return n.test(t)?null:{pattern:{requiredPattern:r,actualValue:t}}}):e.nullValidator;var n,r}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){if(!e)return null;var t=e.filter(id);return 0==t.length?null:function(e){return ad(function(e,n){return t.map(function(t){return t(e)})}(e))}}},{key:"composeAsync",value:function(e){if(!e)return null;var t=e.filter(id);return 0==t.length?null:function(e){return function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i;return"function"==typeof n[n.length-1]&&(i=n.pop()),1===n.length&&u(n[0])&&(n=n[0]),0===n.length?Us:i?e(n).pipe(Q(function(e){return i.apply(void 0,_toConsumableArray(e))})):new k(function(e){return new Qf(e,n)})}(function(e,n){return t.map(function(t){return t(e)})}(e).map(od)).pipe(Q(ad))}}}]),e}();function id(e){return null!=e}function od(e){var t=Zt(e)?K(e):e;if(!Jt(t))throw new Error("Expected validator to return Promise or Observable.");return t}function ad(e){var t=e.reduce(function(e,t){return null!=t?Object.assign({},e,t):e},{});return 0===Object.keys(t).length?null:t}function sd(e){return e.validate?function(t){return e.validate(t)}:e}function ud(e){return e.validate?function(t){return e.validate(t)}:e}var cd=function(){function e(){_classCallCheck(this,e),this._accessors=[]}return _createClass(e,[{key:"add",value:function(e,t){this._accessors.push([e,t])}},{key:"remove",value:function(e){for(var t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)}},{key:"select",value:function(e){var t=this;this._accessors.forEach(function(n){t._isSameGroup(n,e)&&n[1]!==e&&n[1].fireUncheck(e.value)})}},{key:"_isSameGroup",value:function(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name}}]),e}(),ld='\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',hd='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',fd='\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>',dd='\n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  ';function pd(e,t){return[].concat(_toConsumableArray(t.path),[e])}function yd(e,t){e||md(t,"Cannot find control with"),t.valueAccessor||md(t,"No value accessor for form control with"),e.validator=rd.compose([e.validator,t.validator]),e.asyncValidator=rd.composeAsync([e.asyncValidator,t.asyncValidator]),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&vd(e,t)})}(e,t),function(e,t){e.registerOnChange(function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&vd(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),t.valueAccessor.setDisabledState&&e.registerOnDisabledChange(function(e){t.valueAccessor.setDisabledState(e)}),t._rawValidators.forEach(function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange(function(){return e.updateValueAndValidity()})}),t._rawAsyncValidators.forEach(function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange(function(){return e.updateValueAndValidity()})})}function vd(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function md(e,t){var n;throw n=e.path.length>1?"path: '".concat(e.path.join(" -> "),"'"):e.path[0]?"name: '".concat(e.path,"'"):"unspecified name attribute",new Error("".concat(t," ").concat(n))}function gd(e){return null!=e?rd.compose(e.map(sd)):null}function _d(e){return null!=e?rd.composeAsync(e.map(ud)):null}var bd=[Wf,function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}(),function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}(),function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._optionMap=new Map,this._idCounter=0,this.onChange=function(e){},this.onTouched=function(){},this._compareWith=Ht}return _createClass(e,[{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);var n=function(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}(t,e);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}},{key:"compareWith",set:function(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received ".concat(JSON.stringify(e)));this._compareWith=e}}]),e}(),function(){function e(t,n){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._optionMap=new Map,this._idCounter=0,this.onChange=function(e){},this.onTouched=function(){},this._compareWith=Ht}return _createClass(e,[{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(n.hasOwnProperty("selectedOptions"))for(var i=n.selectedOptions,o=0;o<i.length;o++){var a=i.item(o),s=t._getOptionValue(a.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var h=t._getOptionValue(l.value);r.push(h)}}t.value=r,e(r)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}},{key:"compareWith",set:function(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received ".concat(JSON.stringify(e)));this._compareWith=e}}]),e}(),function(){function e(t,n,r,i){_classCallCheck(this,e),this._renderer=t,this._elementRef=n,this._registry=r,this._injector=i,this.onChange=function(){},this.onTouched=function(){}}return _createClass(e,[{key:"ngOnInit",value:function(){this._control=this._injector.get(Xf),this._checkName(),this._registry.add(this._control,this)}},{key:"ngOnDestroy",value:function(){this._registry.remove(this)}},{key:"writeValue",value:function(e){this._state=e===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}},{key:"registerOnChange",value:function(e){var t=this;this._fn=e,this.onChange=function(){e(t.value),t._registry.select(t)}}},{key:"fireUncheck",value:function(e){this.writeValue(e)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_checkName",value:function(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}},{key:"_throwNameError",value:function(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}]),e}()];function wd(e){var t=kd(e)?e.validators:e;return Array.isArray(t)?gd(t):t||null}function Cd(e,t){var n=kd(t)?t.asyncValidators:e;return Array.isArray(n)?_d(n):n||null}function kd(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var Sd=function(){function e(t,n){_classCallCheck(this,e),this.validator=t,this.asyncValidator=n,this._onCollectionChange=function(){},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}return _createClass(e,[{key:"setValidators",value:function(e){this.validator=wd(e)}},{key:"setAsyncValidators",value:function(e){this.asyncValidator=Cd(e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status="PENDING",!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(function(t){t.disable(Object.assign({},e,{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign({},e,{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="VALID",this._forEachChild(function(t){t.enable(Object.assign({},e,{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign({},e,{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status="PENDING";var n=od(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){return t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){return null==t?null:(t instanceof Array||(t=t.split(".")),t instanceof Array&&0===t.length?null:t.reduce(function(e,t){return e instanceof Td?e.controls.hasOwnProperty(t)?e.controls[t]:null:e instanceof Id&&e.at(t)||null},e))}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new Ii,this.statusChanges=new Ii}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){kd(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return"VALID"===this.status}},{key:"invalid",get:function(){return"INVALID"===this.status}},{key:"pending",get:function(){return"PENDING"==this.status}},{key:"disabled",get:function(){return"DISABLED"===this.status}},{key:"enabled",get:function(){return"DISABLED"!==this.status}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}}]),e}(),Ed=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,wd(r),Cd(i,r))))._onChange=[],e._applyFormState(n),e._setUpdateStrategy(r),e.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),e._initObservables(),e}return _inherits(t,Sd),_createClass(t,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_clearChangeFns",value:function(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=function(){}}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),t}(),Td=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,wd(n),Cd(r,n)))).controls=e,i._initObservables(),i._setUpdateStrategy(n),i._setUpControls(),i.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),i}return _inherits(t,Sd),_createClass(t,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"removeControl",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(e).forEach(function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof Ed?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){return e(t.controls[n],n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){var t=this,n=!1;return this._forEachChild(function(r,i){n=n||t.contains(i)&&e(r)}),n}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),t}(),Id=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,wd(n),Cd(r,n)))).controls=e,i._initObservables(),i._setUpdateStrategy(n),i._setUpControls(),i.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),i}return _inherits(t,Sd),_createClass(t,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"insert",value:function(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity()}},{key:"removeAt",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach(function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof Ed?e.value:e.getRawValue()})}},{key:"clear",value:function(){this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity())}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.controls[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){if(r.value.enabled)return!1}}catch(o){t=!0,n=o}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}},{key:"length",get:function(){return this.controls.length}}]),t}(),Ad=Promise.resolve(null),Dd=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).submitted=!1,r._directives=[],r.ngSubmit=new Ii,r.form=new Td({},gd(e),_d(n)),r}return _inherits(t,Zf),_createClass(t,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"addControl",value:function(e){var t=this;Ad.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),yd(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;Ad.then(function(){var n,r,i=t._findContainer(e.path);i&&i.removeControl(e.name),n=t._directives,(r=n.indexOf(e))>-1&&n.splice(r,1)})}},{key:"addFormGroup",value:function(e){var t=this;Ad.then(function(){var n=t._findContainer(e.path),r=new Td({});(function(e,t){null==e&&md(t,"Cannot find control with"),e.validator=rd.compose([e.validator,t.validator]),e.asyncValidator=rd.composeAsync([e.asyncValidator,t.asyncValidator])})(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;Ad.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;Ad.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,t=this._directives,this.form._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)}),this.ngSubmit.emit(e),!1;var t}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}}]),t}(),Nd=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"modelParentException",value:function(){throw new Error('\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup\'s partner directive "formControlName" instead.  Example:\n\n      '.concat(ld,"\n\n      Or, if you'd like to avoid registering this form control, indicate that it's standalone in ngModelOptions:\n\n      Example:\n\n      ").concat(dd))}},{key:"formGroupNameException",value:function(){throw new Error("\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      ".concat(hd,"\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      ").concat(fd))}},{key:"missingNameException",value:function(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')}},{key:"modelGroupParentException",value:function(){throw new Error("\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      ".concat(hd,"\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      ").concat(fd))}},{key:"ngFormWarning",value:function(){console.warn("\n    It looks like you're using 'ngForm'.\n\n    Support for using the 'ngForm' element selector has been deprecated in Angular v6 and will be removed\n    in Angular v9.\n\n    Use 'ng-form' instead.\n\n    Before:\n    <ngForm #myForm=\"ngForm\">\n\n    After:\n    <ng-form #myForm=\"ngForm\">\n    ")}}]),e}(),Rd=new De("NgFormSelectorWarning"),xd=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,Zf),_createClass(t,[{key:"ngOnInit",value:function(){this._checkParentType(),this.formDirective.addFormGroup(this)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeFormGroup(this)}},{key:"_checkParentType",value:function(){}},{key:"control",get:function(){return this.formDirective.getFormGroup(this)}},{key:"path",get:function(){return pd(this.name,this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return gd(this._validators)}},{key:"asyncValidator",get:function(){return _d(this._asyncValidators)}}]),t}(),Od=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._parent=e,i._validators=n,i._asyncValidators=r,i}return _inherits(t,xd),_createClass(t,[{key:"_checkParentType",value:function(){this._parent instanceof t||this._parent instanceof Dd||Nd.modelGroupParentException()}}]),t}(),Pd=Promise.resolve(null),Md=function(e){function t(e,n,r,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).control=new Ed,o._registered=!1,o.update=new Ii,o._parent=e,o._rawValidators=n||[],o._rawAsyncValidators=r||[],o.valueAccessor=function(e,t){if(!t)return null;Array.isArray(t)||md(e,"Value accessor was not provided as an array for form control with");var n=void 0,r=void 0,i=void 0;return t.forEach(function(t){var o;t.constructor===Kf?n=t:(o=t,bd.some(function(e){return o.constructor===e})?(r&&md(e,"More than one built-in value accessor matches form control with"),r=t):(i&&md(e,"More than one custom value accessor matches form control with"),i=t))}),i||r||n||(md(e,"No valid value accessor for form control with"),null)}(_assertThisInitialized(o),i),o}return _inherits(t,Xf),_createClass(t,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),function(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Ht(t,n.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){yd(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){!(this._parent instanceof Od)&&this._parent instanceof xd?Nd.formGroupNameException():this._parent instanceof Od||this._parent instanceof Dd||Nd.modelParentException()}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||Nd.missingNameException()}},{key:"_updateValue",value:function(e){var t=this;Pd.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;Pd.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})}},{key:"path",get:function(){return this._parent?pd(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return gd(this._rawValidators)}},{key:"asyncValidator",get:function(){return _d(this._rawAsyncValidators)}}]),t}(),Ld=function e(){_classCallCheck(this,e)},Vd=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:Rd,useValue:t.warnOnDeprecatedNgFormSelector}]}}}]),e}(),Fd=function(){function e(t){_classCallCheck(this,e),this.dataService=t}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"updateToDo",value:function(){this.dataService.updateToDo(this.toDoItem)}},{key:"deleteToDo",value:function(){this.dataService.deleteToDo(this.toDoItem)}}]),e}(),Ud=function(e){return e.ToDo="todo",e}({});function qd(e){return function(e){return new k(function(t){return{unsubscribe:e.onSnapshot(t)}})}(e).pipe(se())}function Bd(e){return qd(e).pipe(Q(function(e){return{payload:e,type:"query"}}))}function jd(e){return Bd(e).pipe(Q(function(e){return e.payload.docChanges().map(function(e){return{type:e.type,payload:e}})}))}function zd(e,t){return Bd(e).pipe(Q(function(e){return e.payload.docChanges()}),Eu(function(e,n){return function(e,t,n){return t.forEach(function(t){n.indexOf(t.type)>-1&&(e=function(e,t){switch(t.type){case"added":e[t.newIndex]&&e[t.newIndex].doc.ref.isEqual(t.doc.ref)||e.splice(t.newIndex,0,t);break;case"modified":(null==e[t.oldIndex]||e[t.oldIndex].doc.ref.isEqual(t.doc.ref))&&(t.oldIndex!==t.newIndex?(e.splice(t.oldIndex,1),e.splice(t.newIndex,0,t)):e.splice(t.newIndex,1,t));break;case"removed":e[t.oldIndex]&&e[t.oldIndex].doc.ref.isEqual(t.doc.ref)&&e.splice(t.oldIndex,1)}return e}(e,t))}),e}(e,n,t)},[]),Q(function(e){return e.map(function(e){return{type:e.type,payload:e}})}))}n("mrSG");var Qd=function(e){function t(e,n){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,d),_createClass(t,[{key:"schedule",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this}}]),t}(),Hd=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).scheduler=e,r.work=n,r.pending=!1,r}return _inherits(t,Qd),_createClass(t,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(i){n=!0,r=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),r}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}]),t}(),Wd=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).scheduler=e,r.work=n,r}return _inherits(t,Hd),_createClass(t,[{key:"schedule",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n>0?_get(_getPrototypeOf(t.prototype),"schedule",this).call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,n){return n>0||this.closed?_get(_getPrototypeOf(t.prototype),"execute",this).call(this,e,n):this._execute(e,n)}},{key:"requestAsyncId",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==r&&r>0||null===r&&this.delay>0?_get(_getPrototypeOf(t.prototype),"requestAsyncId",this).call(this,e,n,r):e.flush(this)}}]),t}(),Gd=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;_classCallCheck(this,e),this.SchedulerAction=t,this.now=n}return _createClass(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,e).schedule(n,t)}}]),e}();return e.now=function(){return Date.now()},e}(),Kd=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gd.now;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,function(){return t.delegate&&t.delegate!==_assertThisInitialized(n)?t.delegate.now():r()}))).actions=[],n.active=!1,n.scheduled=void 0,n}return _inherits(t,Gd),_createClass(t,[{key:"schedule",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;return t.delegate&&t.delegate!==this?t.delegate.schedule(e,n,r):_get(_getPrototypeOf(t.prototype),"schedule",this).call(this,e,n,r)}},{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),t}(),Yd=new(function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,Kd),t}())(Wd),Zd=function(){function e(t,n){_classCallCheck(this,e),this.zone=t,this.platformId=n}return _createClass(e,[{key:"schedule",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.zone.runGuarded(function(){return Yd.schedule.apply(Yd,t)})}},{key:"keepUnstableUntilFirst",value:function(e){return Ms(this.platformId)?new k(function(t){var n=function(){},r=Zone.current.scheduleMacroTask("firebaseZoneBlock",n,{},n,n);e.subscribe(function(e){"scheduled"===r.state&&r.invoke(),t.next(e)},function(e){"scheduled"===r.state&&r.invoke(),t.error(e)},function(){"scheduled"===r.state&&r.invoke(),t.complete()})}):e}},{key:"runOutsideAngular",value:function(e){var t=this;return new k(function(n){return t.zone.runOutsideAngular(function(){return e.subscribe(function(e){return t.zone.run(function(){return n.next(e)})},function(e){return t.zone.run(function(){return n.error(e)})},function(){return t.zone.run(function(){return n.complete()})})})})}}]),e}(),Jd=function(e){return function(t){return new k(function(n){return t.subscribe(function(t){return e.run(function(){return n.next(t)})},function(t){return e.run(function(){return n.error(t)})},function(){return e.run(function(){return n.complete()})})})}};function Xd(e){return e&&0!==e.length||(e=["added","removed","modified"]),e}var $d,ep=function(){function e(t,n,r){_classCallCheck(this,e),this.ref=t,this.query=n,this.afs=r}return _createClass(e,[{key:"stateChanges",value:function(e){return e&&0!==e.length?this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(jd(this.query))).pipe(Q(function(t){return t.filter(function(t){return e.indexOf(t.type)>-1})}),Js(function(e){return e.length>0})):this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(jd(this.query)))}},{key:"auditTrail",value:function(e){return this.stateChanges(e).pipe(Eu(function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(t))},[]))}},{key:"snapshotChanges",value:function(e){var t=Xd(e),n=zd(this.query,t),r=this.afs.scheduler.runOutsideAngular(n);return this.afs.scheduler.keepUnstableUntilFirst(r)}},{key:"valueChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Bd(this.query),n=this.afs.scheduler.runOutsideAngular(t);return this.afs.scheduler.keepUnstableUntilFirst(n).pipe(Q(function(t){return t.payload.docs.map(function(t){return e.idField?Object.assign({},t.data(),_defineProperty({},e.idField,t.id)):t.data()})}))}},{key:"get",value:function(e){return K(this.query.get(e)).pipe(Jd(this.afs.scheduler.zone))}},{key:"add",value:function(e){return this.ref.add(e)}},{key:"doc",value:function(e){return new tp(this.ref.doc(e),this.afs)}}]),e}(),tp=function(){function e(t,n){_classCallCheck(this,e),this.ref=t,this.afs=n}return _createClass(e,[{key:"set",value:function(e,t){return this.ref.set(e,t)}},{key:"update",value:function(e){return this.ref.update(e)}},{key:"delete",value:function(){return this.ref.delete()}},{key:"collection",value:function(e,t){var n=yp(this.ref.collection(e),t),r=n.ref,i=n.query;return new ep(r,i,this.afs)}},{key:"snapshotChanges",value:function(){var e=qd(this.ref).pipe(Q(function(e){return{payload:e,type:"value"}})),t=this.afs.scheduler.runOutsideAngular(e);return this.afs.scheduler.keepUnstableUntilFirst(t)}},{key:"valueChanges",value:function(){return this.snapshotChanges().pipe(Q(function(e){return e.payload.data()}))}},{key:"get",value:function(e){return K(this.ref.get(e)).pipe(Jd(this.afs.scheduler.zone))}}]),e}(),np=function(){function e(t,n){_classCallCheck(this,e),this.query=t,this.afs=n}return _createClass(e,[{key:"stateChanges",value:function(e){return e&&0!==e.length?this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(jd(this.query))).pipe(Q(function(t){return t.filter(function(t){return e.indexOf(t.type)>-1})}),Js(function(e){return e.length>0})):this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(jd(this.query)))}},{key:"auditTrail",value:function(e){return this.stateChanges(e).pipe(Eu(function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(t))},[]))}},{key:"snapshotChanges",value:function(e){var t=Xd(e),n=zd(this.query,t),r=this.afs.scheduler.runOutsideAngular(n);return this.afs.scheduler.keepUnstableUntilFirst(r)}},{key:"valueChanges",value:function(){var e=Bd(this.query),t=this.afs.scheduler.runOutsideAngular(e);return this.afs.scheduler.keepUnstableUntilFirst(t).pipe(Q(function(e){return e.payload.docs.map(function(e){return e.data()})}))}},{key:"get",value:function(e){return K(this.query.get(e)).pipe(Jd(this.afs.scheduler.zone))}}]),e}(),rp=n("Wcq6"),ip=n.n(rp),op=new De("angularfire2.app.options"),ap=new De("angularfire2.app.nameOrConfig"),sp=function e(){_classCallCheck(this,e)};function up(e,t){var n="object"==typeof t&&t||{};return n.name=n.name||"string"==typeof t&&t||"[DEFAULT]",ip.a.apps.filter(function(e){return e&&e.name===n.name})[0]||ip.a.initializeApp(e,n)}var cp=$d=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"initializeApp",value:function(e,t){return{ngModule:$d,providers:[{provide:op,useValue:e},{provide:ap,useValue:t}]}}}]),e}(),lp=new De("angularfire2.enableFirestorePersistence"),hp=new De("angularfire2.firestore.persistenceSettings"),fp=new De("angularfire2.firestore.settings"),dp=parseInt(ip.a.SDK_VERSION.split(".")[0]),pp=dp<5||5==dp&&parseInt(ip.a.SDK_VERSION.split(".")[1])<8?{timestampsInSnapshots:!0}:{};function yp(e){return{query:(arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e})(e),ref:e}}var vp,mp=function(){function e(t,n,r,i,o,a,s){var u=this;_classCallCheck(this,e),this.scheduler=new Zd(a,o),this.firestore=a.runOutsideAngular(function(){var e=up(t,n).firestore();return e.settings(i||pp),e}),this.persistenceEnabled$=r&&!Ms(o)?a.runOutsideAngular(function(){try{return K(u.firestore.enablePersistence(s||void 0).then(function(){return!0},function(){return!1}))}catch(e){return js(!1)}}):js(!1)}return _createClass(e,[{key:"collection",value:function(e,t){var n=yp("string"==typeof e?this.firestore.collection(e):e,t),r=n.ref,i=n.query;return new ep(r,i,this)}},{key:"collectionGroup",value:function(e,t){if(dp<6)throw"collection group queries require Firebase JS SDK >= 6.0";var n=t||function(e){return e},r=this.firestore.collectionGroup(e);return new np(n(r),this)}},{key:"doc",value:function(e){var t;return t="string"==typeof e?this.firestore.doc(e):e,new tp(t,this)}},{key:"createId",value:function(){return this.firestore.collection("_").doc().id}}]),e}(),gp=((vp=function(){function e(t){_classCallCheck(this,e),this.firestore=t}return _createClass(e,[{key:"getToDoList",value:function(){return this.firestore.collection(Ud.ToDo).valueChanges()}},{key:"createToDo",value:function(e){return this.firestore.collection(Ud.ToDo).doc(e.id).set(e.asObject())}},{key:"updateToDo",value:function(e){return this.firestore.collection(Ud.ToDo).doc(e.id).set(e)}},{key:"deleteToDo",value:function(e){return this.firestore.collection(Ud.ToDo).doc(e.id).delete()}}]),e}()).ngInjectableDef=ve({factory:function(){return new vp(Fe(mp))},token:vp,providedIn:"root"}),vp),_p=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.isDone=!1,this.id=t,this.description=n,this.isDone=r,this.dueDate=i?new Date(i):null,this.completionDate=o?new Date(o):null}return _createClass(e,[{key:"asObject",value:function(){return{id:this.id,description:this.description,isDone:this.isDone,dueDate:this.dueDate,completionDate:this.completionDate}}}]),e}(),bp=Jn({encapsulation:0,styles:[[".todo-item[_ngcontent-%COMP%]{padding:10px 0}"]],data:{}});function wp(e){return na(0,[(e()(),jo(0,0,null,null,18,"div",[["class","input-group todo-item"]],null,null,null,null,null)),(e()(),jo(1,0,null,null,7,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(e()(),jo(2,0,null,null,6,"div",[["class","input-group-text bg-light"]],null,null,null,null,null)),(e()(),jo(3,0,null,null,5,"input",[["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],function(e,t,n){var r=!0,i=e.component;return"change"===t&&(r=!1!==Hr(e,4).onChange(n.target.checked)&&r),"blur"===t&&(r=!1!==Hr(e,4).onTouched()&&r),"ngModelChange"===t&&(r=!1!==(i.toDoItem.isDone=n)&&r),r},null,null)),ii(4,16384,null,0,Wf,[dn,cn],null,null),oi(1024,null,Hf,function(e){return[e]},[Wf]),ii(6,671744,null,0,Md,[[8,null],[8,null],[8,null],[6,Hf]],{model:[0,"model"]},{update:"ngModelChange"}),oi(2048,null,Xf,null,[Md]),ii(8,16384,null,0,ed,[[4,Xf]],null,null),(e()(),jo(9,0,null,null,6,"input",[["class","form-control"],["placeholder",""],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(e,t,n){var r=!0,i=e.component;return"input"===t&&(r=!1!==Hr(e,10)._handleInput(n.target.value)&&r),"blur"===t&&(r=!1!==Hr(e,10).onTouched()&&r),"compositionstart"===t&&(r=!1!==Hr(e,10)._compositionStart()&&r),"compositionend"===t&&(r=!1!==Hr(e,10)._compositionEnd(n.target.value)&&r),"ngModelChange"===t&&(r=!1!==(i.toDoItem.description=n)&&r),"ngModelChange"===t&&(r=!1!==i.updateToDo()&&r),r},null,null)),ii(10,16384,null,0,Kf,[dn,cn,[2,Gf]],null,null),oi(1024,null,Hf,function(e){return[e]},[Kf]),ii(12,671744,null,0,Md,[[8,null],[8,null],[8,null],[6,Hf]],{model:[0,"model"],options:[1,"options"]},{update:"ngModelChange"}),Xo(13,{updateOn:0}),oi(2048,null,Xf,null,[Md]),ii(15,16384,null,0,ed,[[4,Xf]],null,null),(e()(),jo(16,0,null,null,2,"div",[["class","input-group-append"]],null,null,null,null,null)),(e()(),jo(17,0,null,null,1,"button",[["class","btn bg-danger"],["type","button"]],null,[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.deleteToDo()&&r),r},null,null)),(e()(),jo(18,0,null,null,0,"i",[["class","text-white fa fa-trash-alt"]],null,null,null,null,null))],function(e,t){var n=t.component;e(t,6,0,n.toDoItem.isDone);var r=n.toDoItem.description,i=e(t,13,0,"blur");e(t,12,0,r,i)},function(e,t){e(t,3,0,Hr(t,8).ngClassUntouched,Hr(t,8).ngClassTouched,Hr(t,8).ngClassPristine,Hr(t,8).ngClassDirty,Hr(t,8).ngClassValid,Hr(t,8).ngClassInvalid,Hr(t,8).ngClassPending),e(t,9,0,Hr(t,15).ngClassUntouched,Hr(t,15).ngClassTouched,Hr(t,15).ngClassPristine,Hr(t,15).ngClassDirty,Hr(t,15).ngClassValid,Hr(t,15).ngClassInvalid,Hr(t,15).ngClassPending)})}var Cp=function(){function e(t){_classCallCheck(this,e),this.dataService=t,this.todoList=[]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.dataService.getToDoList().subscribe(function(t){return e.todoList=t})}},{key:"addNewItem",value:function(){var e=this.todoList.reduce(function(e,t){return t.id>=e.id?t:e}),t=parseInt(e.id)+1,n=new _p(t.toString(),"",!1,null,null);this.dataService.createToDo(n)}}]),e}(),kp=Jn({encapsulation:0,styles:[[".todo-container[_ngcontent-%COMP%]{width:100%;background-color:#666;border:1px solid #222}"]],data:{}});function Sp(e){return na(0,[(e()(),jo(0,0,null,null,1,"app-todo-item",[["class","col-sm-12"]],null,null,null,wp,bp)),ii(1,114688,null,0,Fd,[gp],{toDoItem:[0,"toDoItem"]},null)],function(e,t){e(t,1,0,t.context.$implicit)},null)}function Ep(e){return na(0,[(e()(),jo(0,0,null,null,6,"div",[["class","container"]],null,null,null,null,null)),(e()(),jo(1,0,null,null,2,"div",[["class","row form-group"]],null,null,null,null,null)),(e()(),jo(2,0,null,null,1,"button",[["class","btn-primary pull-right"]],null,[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.addNewItem()&&r),r},null,null)),(e()(),$o(-1,null,["Create Task"])),(e()(),jo(4,0,null,null,2,"div",[["class","row todo-container"]],null,null,null,null,null)),(e()(),Bo(16777216,null,null,1,null,Sp)),ii(6,278528,null,0,Is,[On,Rn,Tn],{ngForOf:[0,"ngForOf"]},null)],function(e,t){e(t,6,0,t.component.todoList)},null)}var Tp=Pr("app-todo",Cp,function(e){return na(0,[(e()(),jo(0,0,null,null,1,"app-todo",[],null,null,null,Ep,kp)),ii(1,114688,null,0,Cp,[gp],null,null)],function(e,t){e(t,1,0)},null)},{},{},[]),Ip=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}(),Ap=Jn({encapsulation:0,styles:[[""]],data:{}});function Dp(e){return na(0,[(e()(),jo(0,0,null,null,14,"nav",[["class","navbar navbar-expand-md bg-dark navbar-dark"]],null,null,null,null,null)),(e()(),jo(1,0,null,null,1,"a",[["class","navbar-brand"],["href","#"]],null,null,null,null,null)),(e()(),$o(-1,null,["Angular Toolkit"])),(e()(),jo(3,0,null,null,1,"button",[["aria-controls","navbarCollapse"],["aria-expanded","false"],["aria-label","Toggle navigation"],["class","navbar-toggler"],["data-target","#navbarCollapse"],["data-toggle","collapse"],["type","button"]],null,null,null,null,null)),(e()(),jo(4,0,null,null,0,"span",[["class","navbar-toggler-icon"]],null,null,null,null,null)),(e()(),jo(5,0,null,null,9,"div",[["class","collapse navbar-collapse"],["id","navbarCollapse"]],null,null,null,null,null)),(e()(),jo(6,0,null,null,8,"ul",[["class","navbar-nav mr-auto"]],null,null,null,null,null)),(e()(),jo(7,0,null,null,3,"li",[["class","nav-item"]],null,null,null,null,null)),(e()(),jo(8,0,null,null,2,"a",[["class","nav-link"],["routerLink","/home"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==Hr(e,9).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r},null,null)),ii(9,671744,null,0,of,[rf,Kl,fs],{routerLink:[0,"routerLink"]},null),(e()(),$o(-1,null,["Home"])),(e()(),jo(11,0,null,null,3,"li",[["class","nav-item"]],null,null,null,null,null)),(e()(),jo(12,0,null,null,2,"a",[["class","nav-link"],["routerLink","/todo"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==Hr(e,13).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r},null,null)),ii(13,671744,null,0,of,[rf,Kl,fs],{routerLink:[0,"routerLink"]},null),(e()(),$o(-1,null,["To Do List"]))],function(e,t){e(t,9,0,"/home"),e(t,13,0,"/todo")},function(e,t){e(t,8,0,Hr(t,9).target,Hr(t,9).href),e(t,12,0,Hr(t,13).target,Hr(t,13).href)})}var Np=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}(),Rp=Jn({encapsulation:0,styles:[[""]],data:{}});function xp(e){return na(0,[(e()(),jo(0,0,null,null,4,"div",[["class","footer"]],null,null,null,null,null)),(e()(),jo(1,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),$o(-1,null,[" Created by Lazaro Padron "])),(e()(),jo(3,0,null,null,1,"span",[["class","align-right"]],null,null,null,null,null)),(e()(),$o(-1,null,[" \xa9 Copyright 2019. All rights reserved. "]))],null,null)}var Op=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}(),Pp=Jn({encapsulation:0,styles:[[".shell-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;background:#e8e8e8}"]],data:{}});function Mp(e){return na(0,[(e()(),jo(0,0,null,null,7,"div",[["class","shell-container"]],null,null,null,null,null)),(e()(),jo(1,0,null,null,1,"app-header",[],null,null,null,Dp,Ap)),ii(2,114688,null,0,Ip,[],null,null),(e()(),jo(3,0,null,null,2,"div",[["class","body"]],null,null,null,null,null)),(e()(),jo(4,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),ii(5,212992,null,0,cf,[uf,On,on,[8,null],Nt],null,null),(e()(),jo(6,0,null,null,1,"app-footer",[],null,null,null,xp,Rp)),ii(7,114688,null,0,Np,[],null,null)],function(e,t){e(t,2,0),e(t,5,0),e(t,7,0)},null)}var Lp=Jn({encapsulation:0,styles:[[""]],data:{}});function Vp(e){return na(0,[(e()(),jo(0,0,null,null,1,"app-toolkit-shell",[],null,null,null,Mp,Pp)),ii(1,114688,null,0,Op,[],null,null)],function(e,t){e(t,1,0)},null)}var Fp,Up=Pr("app-root",cs,function(e){return na(0,[(e()(),jo(0,0,null,null,1,"app-root",[],null,null,null,Vp,Lp)),ii(1,49152,null,0,cs,[],null,null)],null,null)},{},{},[]);n("6Joi");var qp=Fp=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"enablePersistence",value:function(e){return{ngModule:Fp,providers:[{provide:lp,useValue:!0},{provide:hp,useValue:e}]}}}]),e}(),Bp=function e(){_classCallCheck(this,e)},jp=new ss(us,[cs],function(e){return function(e){for(var t={},n=[],r=!1,i=0;i<e.length;i++){var o=e[i];o.token===xt&&!0===o.value&&(r=!0),1073741824&o.flags&&n.push(o.token),o.index=i,t[Kn(o.token)]=o}return{factory:null,providersByKey:t,providers:e,modules:n,isRoot:r}}([Ir(512,on,an,[[8,[Of,zf,Tp,Up]],[3,on],Be]),Ir(5120,Ui,Fo,[[3,Ui]]),Ir(4608,bs,ws,[Ui,[2,_s]]),Ir(5120,bi,Uo,[no]),Ir(5120,xi,Oi,[]),Ir(5120,Tn,Lo,[]),Ir(5120,In,Vo,[]),Ir(4608,Dc,Nc,[Os]),Ir(6144,Et,null,[Dc]),Ir(4608,Cc,Sc,[]),Ir(5120,Yu,function(e,t,n,r,i,o,a,s){return[new bc(e,t,n),new Ac(r),new Ec(i,o,a,s)]},[Os,no,Li,Os,Os,Cc,Fi,[2,kc]]),Ir(4608,Zu,Zu,[Yu,no]),Ir(135680,$u,$u,[Os]),Ir(4608,ac,ac,[Zu,$u,xi]),Ir(6144,hn,null,[ac]),Ir(6144,Xu,null,[$u]),Ir(4608,lo,lo,[no]),Ir(5120,sp,up,[op,[2,ap]]),Ir(4608,mp,mp,[op,[2,ap],[2,lp],[2,fp],Li,no,[2,hp]]),Ir(5120,Kl,Tf,[rf]),Ir(4608,df,df,[]),Ir(6144,hf,null,[df]),Ir(135680,pf,pf,[rf,So,Ki,Pt,hf]),Ir(4608,ff,ff,[]),Ir(5120,yf,wf,[rf,Vs,vf]),Ir(5120,Nf,Df,[If]),Ir(5120,Vi,function(e){return[e]},[Nf]),Ir(4608,cd,cd,[]),Ir(1073742336,xs,xs,[]),Ir(1024,$e,Fc,[]),Ir(1024,vo,function(){return[_f()]},[]),Ir(512,If,If,[Pt]),Ir(1024,Ni,function(e,t){return[(n=e,Wu("probe",Ku),Wu("coreTokens",Object.assign({},Gu,(n||[]).reduce(function(e,t){return e[t.name]=t.token,e},{}))),function(){return Ku}),Af(t)];var n},[[2,vo],If]),Ir(512,Ri,Ri,[[2,Ni]]),Ir(131584,Co,Co,[no,Fi,Pt,$e,on,Ri]),Ir(1073742336,qo,qo,[Co]),Ir(1073742336,Uc,Uc,[[3,Uc]]),Ir(1073742336,cp,cp,[]),Ir(1073742336,qp,qp,[]),Ir(1024,mf,kf,[[3,rf]]),Ir(512,Tl,Il,[]),Ir(512,uf,uf,[]),Ir(256,vf,{},[]),Ir(1024,fs,Cf,[ls,[2,ds],vf]),Ir(512,ps,ps,[fs,ls]),Ir(512,Ki,Ki,[]),Ir(512,So,Io,[Ki,[2,Eo]]),Ir(1024,Zh,function(){return[[{path:"",component:Ff},{path:"todo",component:Cp},{path:"**",component:Ff}]]},[]),Ir(1024,rf,Ef,[Co,Tl,uf,ps,Pt,So,Ki,Zh,vf,[2,Xh],[2,Kh]]),Ir(1073742336,bf,bf,[[2,mf],[2,rf]]),Ir(1073742336,Bp,Bp,[]),Ir(1073742336,Ld,Ld,[]),Ir(1073742336,Vd,Vd,[]),Ir(1073742336,us,us,[]),Ir(256,xt,!0,[]),Ir(256,op,{apiKey:"AIzaSyBak8BI4afKQGEYHHsaxXOECsUwSI2pWrs",authDomain:"angularhomepage.firebaseapp.com",databaseURL:"https://angularhomepage.firebaseio.com",projectId:"angularhomepage",storageBucket:"angularhomepage.appspot.com",messagingSenderId:"592612527532",appId:"1:592612527532:web:018ade32062b1099447e09",measurementId:"G-FCFVZ8HFD1"},[]),Ir(256,ap,void 0,[])])});(function(){if(tt)throw new Error("Cannot enable prod mode after platform setup.");et=!1})(),Vc().bootstrapModuleFactory(jp).catch(function(e){return console.error(e)})},zVF4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("mrSG"),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(e,t){if(!e)throw a(t)},a=function(e){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},s=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=(15&s)<<2|c>>6,h=63&c;u||(h=64,a||(l=64)),r.push(n[o>>2],n[(3&o)<<4|s>>4],n[l],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{o=e[n++];var s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();r.push(o<<2|a>>4),64!==s&&(r.push(a<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},c=function(e){try{return u.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function l(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=l(e[n],t[n]));return e}var h=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}},e}();function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d="FirebaseError",p=function(e){function t(n,r){var i=e.call(this,r)||this;return i.code=n,i.name=d,Object.setPrototypeOf(i,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,y.prototype.create),i}return r.__extends(t,e),t}(Error),y=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],a=o?v(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new p(i,s),c=0,l=Object.keys(r);c<l.length;c++){var h=l[c];"_"!==h.slice(-1)&&(h in u&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),u[h]=r[h])}return u},e}();function v(e,t){return e.replace(m,function(e,n){var r=t[n];return null!=r?r.toString():"<"+n+"?>"})}var m=/\{\$([^}]+)}/g;function g(e){return JSON.parse(e)}var _=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=g(c(o[0])||""),n=g(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(a){}return{header:t,claims:n,data:r,signature:i}},b=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++)n[r]=4294967295&((h=n[r-3]^n[r-8]^n[r-14]^n[r-16])<<1|h>>>31);var i,o,a=this.chain_[0],s=this.chain_[1],u=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(i=c^s&(u^c),o=1518500249):(i=s^u^c,o=1859775393):r<60?(i=s&u|c&(s|u),o=2400959708):(i=s^u^c,o=3395469782);var h=(a<<5|a>>>27)+i+l+o+n[r]&4294967295;l=c,c=u,u=4294967295&(s<<30|s>>>2),s=a,a=h}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}(),w=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=C),void 0===r.error&&(r.error=C),void 0===r.complete&&(r.complete=C);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},e}();function C(){}function k(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return e+" failed: "+r+" argument "}t.CONSTANTS=i,t.Deferred=h,t.ErrorFactory=y,t.FirebaseError=p,t.Sha1=b,t.assert=o,t.assertionError=a,t.async=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){e.apply(void 0,n)}).catch(function(e){t&&t(e)})}},t.base64=u,t.base64Decode=c,t.base64Encode=function(e){var t=s(e);return u.encodeByteArray(t,!0)},t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createSubscribe=function(e,t){var n=new w(e,t);return n.subscribe.bind(n)},t.decode=_,t.deepCopy=function(e){return l(void 0,e)},t.deepExtend=l,t.errorPrefix=k,t.getUA=f,t.isAdmin=function(e){var t=_(e).claims;return"object"==typeof t&&!0===t.admin},t.isBrowser=function(){return"object"==typeof self&&self.self===self},t.isEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())},t.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}},t.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},t.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},t.isValidFormat=function(e){var t=_(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){var t=_(e).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),i=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},t.issuedAtTime=function(e){var t=_(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=g,t.map=function(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r},t.querystring=function(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach(function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];n(o[0],o[1])}return t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=e.split("=");t[n[0]]=n[1]}}),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},t.stringToByteArray=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;o(++r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.validateArgCount=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},t.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(k(e,t,r)+"must be a valid function.")},t.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(k(e,t,r)+"must be a valid context object.")},t.validateNamespace=function(e,t,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(k(e,t,r)+"must be a valid firebase namespace.")}},zn8P:function(e,t){function n(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"}},[[0,0]]]);